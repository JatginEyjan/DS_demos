<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DS10 v0.3 - æ·±æ¸Šç¼–å¹´å²</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0a0f; color: #e0e0e0; font-family: 'Courier New', monospace; font-size: 14px; min-height: 100vh; overflow: hidden; }
        .hidden { display: none !important; }
        
        /* çŠ¶æ€æ  v0.3 */
        .team-status-bar { background: #1a1a2e; padding: 8px 12px; display: grid; grid-template-columns: 1fr 1fr; gap: 12px; border-bottom: 2px solid #0f0f1a; }
        .turn-display { position: absolute; top: 8px; right: 12px; font-size: 11px; color: #888; background: #0f0f1a; padding: 2px 8px; border-radius: 4px; }
        .investigator-status { background: #0f0f1a; border: 2px solid #2a2a3a; border-radius: 6px; padding: 8px; }
        .inv-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
        .inv-name { font-size: 12px; font-weight: bold; }
        .status-label { font-size: 10px; padding: 2px 6px; border-radius: 3px; }
        .status-label.calm { background: #27ae60; }
        .status-label.uneasy { background: #f39c12; color: #000; }
        .status-label.nervous { background: #e67e22; }
        .status-label.fearful { background: #e94560; }
        .bar-row { display: flex; align-items: center; gap: 6px; }
        .bar-label { font-size: 10px; color: #888; width: 24px; }
        .bar-container { flex: 1; height: 10px; background: #0a0a0f; border: 1px solid #2a2a3a; overflow: hidden; }
        .bar-fill { height: 100%; background: #e94560; }
        .bar-fill.sanity { background: #7c3aed; }
        .bar-value { font-size: 10px; color: #888; width: 40px; text-align: right; }
        
        /* v0.3 å¯¹è±¡è§£å†³çŠ¶æ€ */
        .object-item.solved { opacity: 0.6; border-color: #27ae60; }
        .object-item.type-exit { border-left: 4px solid #e94560; }
        
        /* æ¸¸æˆå¸ƒå±€ */
        .game-layout { display: flex; height: calc(100vh - 70px); }
        .main-panel { flex: 1; display: flex; flex-direction: column; padding: 10px; gap: 8px; overflow: hidden; }
        .scene-header { text-align: center; padding: 10px; background: #1a1a2e; border: 2px solid #2a2a3a; }
        .scene-title { color: #e94560; font-size: 16px; font-weight: bold; }
        .scene-subtitle { color: #666; font-size: 11px; margin-top: 4px; }
        .main-content { flex: 1; background: #0f0f1a; border: 3px solid #2a2a3a; overflow-y: auto; padding: 15px; }
        .log-panel { background: #0a0a0f; border: 2px solid #1a1a2e; padding: 8px; height: 100px; overflow-y: auto; font-size: 11px; }
        .log-entry { margin-bottom: 4px; padding: 3px 8px; border-left: 3px solid #3a3a4a; }
        .log-entry.system { border-left-color: #3498db; color: #5dade2; }
        
        /* èŒä¸šé€‰æ‹© */
        .profession-select { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(180deg, #0a0a0f 0%, #1a1a2e 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; z-index: 1000; }
        .profession-title { color: #e94560; font-size: 20px; margin-bottom: 20px; text-align: center; }
        .profession-card { background: #1a1a2e; border: 3px solid #2a2a3a; padding: 16px; margin: 8px; width: 100%; max-width: 300px; cursor: pointer; }
        .profession-card.selected { border-color: #27ae60; box-shadow: 0 0 15px rgba(39,174,96,0.5); }
        .profession-name { color: #e94560; font-size: 16px; font-weight: bold; margin-bottom: 8px; }
        .profession-stats { font-size: 11px; color: #888; }
        .hint { color: #666; text-align: center; margin-top: 20px; }
        
        /* æˆ¿é—´æ ·å¼ */
        .room-container { max-width: 600px; margin: 0 auto; }
        .room-desc { color: #ccc; line-height: 1.8; margin-bottom: 20px; font-size: 14px; }
        .discoveries { background: #1a1a2e; border: 2px solid #3a3a4a; border-radius: 8px; padding: 15px; margin-bottom: 20px; }
        .discoveries-title { color: #888; font-size: 12px; margin-bottom: 10px; }
        .discovery-item { display: flex; align-items: center; gap: 10px; padding: 10px; background: #0f0f1a; border: 1px solid #2a2a3a; margin-bottom: 8px; cursor: pointer; }
        .discovery-item:hover { border-color: #e94560; }
        .discovery-icon { font-size: 20px; }
        .discovery-name { font-size: 13px; }
        .room-choices { display: flex; flex-direction: column; gap: 10px; }
        .choice-btn { background: #1a1a2e; border: 2px solid #3a3a4a; color: #e0e0e0; padding: 15px; cursor: pointer; text-align: left; }
        .choice-btn:hover { border-color: #e94560; background: #2a1a2e; }
        .choice-title { font-size: 14px; font-weight: bold; display: block; margin-bottom: 5px; }
        .choice-desc { font-size: 11px; color: #888; }
        
        /* v0.3 ç®€åŒ–ç³»ç»Ÿ - ç§»é™¤è§£å†³åº¦/æ¶åŒ–åº¦/APæ ·å¼ */
        .narrative-text { background: #0f0f1a; border-left: 3px solid #e94560; padding: 12px; margin: 15px 0; color: #ccc; font-size: 13px; line-height: 1.6; }
        
        /* å¯¹è±¡ç³»ç»Ÿæ ·å¼ */
        .object-panel { background: #1a1a2e; border: 2px solid #3a3a4a; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .object-title { color: #e94560; font-size: 12px; margin-bottom: 10px; font-weight: bold; display: flex; align-items: center; gap: 8px; }
        .object-list { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px; }
        .object-item { 
            display: flex; align-items: center; gap: 6px; padding: 8px 12px; 
            background: #0f0f1a; border: 2px solid #2a2a3a; border-radius: 6px; 
            cursor: pointer; transition: all 0.2s;
        }
        .object-item:hover { border-color: #e94560; background: #1a1a2e; }
        .object-item.selected { border-color: #27ae60; background: #1a3a2e; }
        .object-item.type-obstacle { border-left: 4px solid #e94560; }
        .object-item.type-info { border-left: 4px solid #3498db; }
        .object-item.type-story { border-left: 4px solid #f39c12; }
        .object-item.type-exit { border-left: 4px solid #27ae60; }
        .object-icon { font-size: 18px; }
        .object-name { font-size: 12px; }
        .object-type { font-size: 9px; color: #666; margin-left: 4px; }
        
        .action-panel { background: #0f0f1a; border: 2px solid #2a2a3a; border-radius: 6px; padding: 12px; }
        .action-title { color: #888; font-size: 11px; margin-bottom: 8px; }
        .action-list { display: flex; flex-direction: column; gap: 8px; }
        .action-btn { 
            display: flex; justify-content: space-between; align-items: center;
            padding: 10px 12px; background: #1a1a2e; border: 2px solid #3a3a4a; 
            color: #e0e0e0; cursor: pointer; text-align: left; border-radius: 4px;
        }
        .action-btn:hover:not(:disabled) { border-color: #e94560; background: #2a1a2e; }
        .action-btn:disabled { opacity: 0.4; cursor: not-allowed; }
        
        /* UI Polish - å¾®åŠ¨ç”» */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .fade-in { animation: fadeIn 0.2s ease-out; }
        .slide-in { animation: slideIn 0.2s ease-out; }
        
        .profession-card {
            transition: transform 0.15s ease-out, border-color 0.15s ease-out, box-shadow 0.15s ease-out;
        }
        .profession-card:hover {
            transform: translateY(-2px);
        }
        .profession-card:active {
            transform: scale(0.98);
        }
        
        .object-item {
            transition: transform 0.15s ease-out, border-color 0.15s ease-out, background 0.15s ease-out;
        }
        .object-item:hover {
            transform: translateY(-1px);
        }
        .object-item:active {
            transform: scale(0.97);
        }
        
        .action-btn, .choice-btn {
            transition: transform 0.15s ease-out, border-color 0.15s ease-out, background 0.15s ease-out;
            min-height: 44px;
        }
        .action-btn:active:not(:disabled), .choice-btn:active {
            transform: scale(0.98);
        }
        
        /* æ’ç‰ˆä¼˜åŒ– */
        .room-desc, .narrative-text {
            text-wrap: pretty;
            line-height: 1.75;
        }
        .scene-title, .profession-title {
            text-wrap: balance;
        }
        .bar-value, .action-rate {
            font-variant-numeric: tabular-nums;
        }
        
        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @supports (height: 100dvh) {
            .game-layout { height: calc(100dvh - 70px); }
            .profession-select { height: 100dvh; }
        }
        
        @supports (padding: max(0px)) {
            .team-status-bar {
                padding-top: max(8px, env(safe-area-inset-top));
                padding-left: max(12px, env(safe-area-inset-left));
                padding-right: max(12px, env(safe-area-inset-right));
            }
        }
        
        /* ç©ºçŠ¶æ€å¼•å¯¼ */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }
        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }
        .empty-state-text {
            font-size: 14px;
            margin-bottom: 20px;
        }
        .empty-state-action {
            display: inline-block;
            padding: 10px 20px;
            background: #1a1a2e;
            border: 2px solid #3a3a4a;
            color: #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            transition: border-color 0.15s ease-out;
        }
        .empty-state-action:hover {
            border-color: #e94560;
        }
        .action-info { display: flex; flex-direction: column; }
        .action-name { font-size: 13px; font-weight: bold; }
        .action-desc { font-size: 10px; color: #888; }
        .action-meta { display: flex; gap: 8px; font-size: 10px; }
        .action-rate { color: #27ae60; }
        .turn-counter { font-size: 11px; color: #888; text-align: center; padding: 5px; }
        
        /* åˆ¤å®šåŠ¨ç”»æ ·å¼ */
        .roll-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.95); display: none; align-items: center; justify-content: center; 
            z-index: 3000; flex-direction: column;
        }
        .roll-overlay.show { display: flex; }
        .roll-display { 
            font-size: 80px; font-weight: bold; color: #e94560; 
            font-family: 'Courier New', monospace; text-shadow: 0 0 20px rgba(233,69,96,0.5);
        }
        .roll-result { 
            margin-top: 20px; font-size: 24px; font-weight: bold; 
            padding: 10px 30px; border-radius: 4px;
        }
        .roll-result.fumble { background: #7c1a1a; color: #fff; }
        .roll-result.fail { background: #3a3a4a; color: #aaa; }
        .roll-result.success { background: #1a5a3a; color: #2ecc71; }
        .roll-result.crit { background: linear-gradient(90deg, #f1c40f, #e67e22); color: #000; }
        .roll-detail { margin-top: 15px; font-size: 14px; color: #888; }
        .roll-close { 
            margin-top: 30px; padding: 12px 30px; background: #e94560; 
            color: white; border: none; cursor: pointer; font-size: 14px;
        }
        
        /* ç»“æœåé¦ˆåŒºåŸŸ */
        .result-feedback { 
            background: #0f0f1a; border-left: 3px solid #3498db; 
            padding: 15px; margin: 10px 0; border-radius: 0 4px 4px 0;
        }
        .result-layer { margin-bottom: 8px; }
        .result-layer:last-child { margin-bottom: 0; }
        .layer-action { color: #888; font-size: 12px; }
        .layer-roll { color: #f39c12; font-size: 13px; font-weight: bold; }
        .layer-narrative { color: #ccc; font-size: 14px; line-height: 1.6; margin-top: 8px; padding-top: 8px; border-top: 1px solid #2a2a3a; }
        
        /* å¼¹çª— */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 2000; }
        .modal-overlay.show { display: flex; }
        .modal-content { background: #1a1a2e; border: 4px solid #e94560; padding: 24px; max-width: 300px; text-align: center; }
        .modal-title { color: #e94560; font-size: 18px; margin-bottom: 12px; }
        .modal-text { color: #aaa; font-size: 13px; margin-bottom: 20px; }
        .modal-btn { background: #e94560; border: none; color: white; padding: 12px 24px; cursor: pointer; }
    </style>
</head>
<body>
    <!-- èŒä¸šé€‰æ‹© -->
    <div id="professionSelect" class="profession-select fade-in">
        <h1 class="profession-title">DS10 v0.3 - æ·±æ¸Šç¼–å¹´å²<br><span style="font-size:14px;color:#666;">é€‰æ‹©2åè°ƒæŸ¥å‘˜ç»„æˆå°é˜Ÿ</span></h1>
        <div class="profession-card" id="card1" onclick="selectProf('archaeologist')">
            <div class="profession-name">ğŸ” è€ƒå¤å­¦å®¶</div>
            <div class="profession-stats">HP:70 SAN:100 | ä¾¦æŸ¥50 åŠ›é‡30 ç¥ç§˜å­¦35<br><span style="color:#27ae60;">ç²¾é€šå¤ä»£æ–‡çŒ®ï¼Œèƒ½ä»ç¬¦å·ä¸­å‘ç°éšè—ä¿¡æ¯</span></div>
        </div>
        <div class="profession-card" id="card2" onclick="selectProf('soldier')">
            <div class="profession-name">âš”ï¸ å‰å†›äºº</div>
            <div class="profession-stats">HP:90 SAN:100 | ä¾¦æŸ¥35 åŠ›é‡55 ç¥ç§˜å­¦20<br><span style="color:#27ae60;">å®æˆ˜ç»éªŒä¸°å¯Œï¼Œå±æœºæ—¶åˆ»ä¿æŒå†·é™</span></div>
        </div>
        <div class="profession-card" id="card3" onclick="selectProf('occultist')">
            <div class="profession-name">âœ¦ ç¥ç§˜å­¦è€…</div>
            <div class="profession-stats">HP:50 SAN:100 | ä¾¦æŸ¥40 åŠ›é‡20 ç¥ç§˜å­¦55<br><span style="color:#27ae60;">èƒ½æ„ŸçŸ¥æ·±æ¸Šèƒ½é‡ï¼Œç†è§£è¶…è‡ªç„¶ç°è±¡</span></div>
        </div>
        <div class="hint" id="selectHint">ç‚¹å‡»å¡ç‰‡é€‰æ‹© (0/2)</div>
    </div>

    <!-- æ¸¸æˆä¸»ç•Œé¢ -->
    <div id="gameUI" class="hidden fade-in" style="display: flex; flex-direction: column; height: 100vh;">
        <div class="team-status-bar" style="position:relative;">
            <div class="turn-display" id="turnDisplay">å›åˆ: 0</div>
            <div class="investigator-status">
                <div class="inv-header">
                    <span class="inv-name" id="name0">è°ƒæŸ¥å‘˜A</span>
                    <span class="status-label calm" id="status0">å†·é™</span>
                </div>
                <div class="bar-row">
                    <span class="bar-label">HP</span>
                    <div class="bar-container"><div class="bar-fill" id="hpBar0" style="width:100%"></div></div>
                    <span class="bar-value" id="hp0">70/70</span>
                </div>
                <div class="bar-row">
                    <span class="bar-label">SAN</span>
                    <div class="bar-container"><div class="bar-fill sanity" id="sanBar0" style="width:0%"></div></div>
                    <span class="bar-value" id="san0">0</span>
                </div>
            </div>
            <div class="investigator-status">
                <div class="inv-header">
                    <span class="inv-name" id="name1">è°ƒæŸ¥å‘˜B</span>
                    <span class="status-label calm" id="status1">å†·é™</span>
                </div>
                <div class="bar-row">
                    <span class="bar-label">HP</span>
                    <div class="bar-container"><div class="bar-fill" id="hpBar1" style="width:100%"></div></div>
                    <span class="bar-value" id="hp1">70/70</span>
                </div>
                <div class="bar-row">
                    <span class="bar-label">SAN</span>
                    <div class="bar-container"><div class="bar-fill sanity" id="sanBar1" style="width:0%"></div></div>
                    <span class="bar-value" id="san1">0</span>
                </div>
            </div>
        </div>
        <div class="game-layout">
            <div class="main-panel">
                <div class="scene-header">
                    <div class="scene-title" id="roomTitle">å‡†å¤‡</div>
                    <div class="scene-subtitle" id="roomSub">é€‰æ‹©è°ƒæŸ¥å‘˜</div>
                </div>
                <div class="main-content" id="mainContent"></div>
                <div class="log-panel" id="logPanel">
                    <div class="log-entry system">DS10 v0.3 - ç®€åŒ–ç‰ˆï¼ˆå›åˆåˆ¶+å¯¹è±¡è§£å†³è§£é”å‡ºå£ï¼‰</div>
                </div>
            </div>
        </div>
    </div>

    <!-- åˆ¤å®šåŠ¨ç”»è¦†ç›–å±‚ -->
    <div class="roll-overlay" id="rollOverlay">
        <div class="roll-display" id="rollDisplay">00</div>
        <div class="roll-result" id="rollResult"></div>
        <div class="roll-detail" id="rollDetail"></div>
        <button class="roll-close" id="rollClose" onclick="closeRoll()">ç¡®å®š</button>
    </div>

    <!-- å¼¹çª— -->
    <div class="modal-overlay" id="modal">
        <div class="modal-content">
            <div class="modal-title" id="modalTitle">æ ‡é¢˜</div>
            <div class="modal-text" id="modalText">å†…å®¹</div>
            <button class="modal-btn" onclick="closeModal()">ç¡®å®š</button>
        </div>
    </div>

<script>
// ========== æ¸¸æˆæ•°æ® ==========
var selectedProfs = [];
var team = [];
var currentRoomIdx = 0;
var clues = [];
var turnCount = 0;  // å›åˆè®¡æ•°
var currentRoomState = {};  // å½“å‰æˆ¿é—´çŠ¶æ€ï¼ˆå¯¹è±¡è§£å†³çŠ¶æ€ç­‰ï¼‰

// v0.3 ç®€åŒ–ç³»ç»Ÿ - ç§»é™¤è¡ŒåŠ¨å¡ç‰Œå’Œè§£å†³åº¦/æ¶åŒ–åº¦ç³»ç»Ÿ

var professions = {
    archaeologist: { name: 'è€ƒå¤å­¦å®¶', hp: 70, maxHp: 70, san: 0, skills: {ä¾¦æŸ¥:50,åŠ›é‡:30,ç¥ç§˜å­¦:35} },
    soldier: { name: 'å‰å†›äºº', hp: 90, maxHp: 90, san: 0, skills: {ä¾¦æŸ¥:35,åŠ›é‡:55,ç¥ç§˜å­¦:20} },
    occultist: { name: 'ç¥ç§˜å­¦è€…', hp: 50, maxHp: 50, san: 0, skills: {ä¾¦æŸ¥:40,åŠ›é‡:20,ç¥ç§˜å­¦:55} }
};

// ========== å¯¹è±¡ç³»ç»Ÿ ==========
// v0.3 å¯¹è±¡ç±»å‹: 'obstacle'(éšœç¢) / 'info'(æƒ…æŠ¥) / 'story'(å‰§æƒ…) / 'exit'(å‡ºå£)
// åˆ¤å®šæ–¹å¼: 'auto'(è‡ªåŠ¨) / 'skill:æŠ€èƒ½å'(æŠ€èƒ½åˆ¤å®š) / 'item:é“å…·å'(éœ€è¦é“å…·)
// ç»“æœåº“æ ¼å¼: { 'fumble':å¤§å¤±è´¥æ–‡æœ¬, 'fail':å¤±è´¥æ–‡æœ¬, 'success':æˆåŠŸæ–‡æœ¬, 'crit':å¤§æˆåŠŸæ–‡æœ¬ }
// å‡ºå£å¯¹è±¡æ·»åŠ  unlockConditions å­—æ®µï¼ŒæŒ‡å®šéœ€è¦è§£å†³çš„å¯¹è±¡IDæ•°ç»„

// ========== 13æˆ¿é—´å®Œæ•´å¯¹è±¡æ¨¡æ¿ ==========
var objectTemplates = {
    // ========== 1. çŸ¿å‘å…¥å£ (entrance) ==========
    'entrance_debris': {
        id: 'entrance_debris',
        name: 'ç¢çŸ³å †',
        type: 'obstacle',
        icon: 'ğŸª¨',
        desc: 'é€šé“å…¥å£è¢«éƒ¨åˆ†ç¢çŸ³å µå¡ï¼Œä½†å¹¶ä¸å®Œå…¨é˜»éš”é€šè¡Œã€‚',
        visible: 'always',
        actions: [
            {
                id: 'push_debris',
                name: 'æ¨å¼€ç¢çŸ³',
                desc: 'ç”¨è›®åŠ›æ¸…ç†é€šé“',
                cost: 1,
                roll: { type: 'skill', skill: 'åŠ›é‡', base: 30 },
                results: {
                    fumble: { text: 'ä½ è¢«ç¢çŸ³ç ¸ä¸­æ‰‹è‡‚ï¼Œé²œè¡€ç›´æµï¼Œç¢çŸ³åè€Œæ»‘è½å µä½æ›´å¤šç©ºé—´ã€‚', san: 5 },
                    fail: { text: 'ç¢çŸ³å¤ªé‡äº†ï¼Œä½ åªèƒ½å‹‰å¼ºæ¸…å‡ºä¸€æ¡çª„ç¼ï¼ŒèŠ±è´¹äº†å¤§é‡ä½“åŠ›ã€‚', san: 2 },
                    success: { text: 'ä½ ç”¨å°½å…¨åŠ›æ¨å¼€ç¢çŸ³ï¼Œæ¸…ç†å‡ºä¸€æ¡å¯å®¹äººé€šè¿‡çš„é€šé“ã€‚', bonus: 'é€šé“å·²æ¸…ç†' },
                    crit: { text: 'ä½ å·§å¦™åœ°åˆ©ç”¨æ æ†åŸç†ï¼Œç¢çŸ³è½°ç„¶å€’å¡Œï¼Œéœ²å‡ºä¸€ä¸ªéšè—çš„ä¾§æ´ï¼é‡Œé¢ä¼¼ä¹æœ‰å‰äººç•™ä¸‹çš„ä¸œè¥¿ã€‚', item: 'å‰äººé—ç‰©', bonus: 'å‘ç°ä¾§æ´' }
                }
            },
            {
                id: 'bypass_debris',
                name: 'ç»•è¿‡ç¢çŸ³',
                desc: 'ä»ç¼éš™ä¸­æŒ¤è¿‡å»ï¼ˆæ— éœ€åˆ¤å®šï¼‰',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ ä»ç¢çŸ³é—´çš„çª„ç¼ä¸­æŒ¤äº†è¿‡å»ï¼Œè™½ç„¶ç‹¼ç‹ˆä½†å®‰å…¨é€šè¿‡ã€‚', san: 0, resolve: 10 }
                }
            }
        ]
    },
    'rail_tracks': {
        id: 'rail_tracks',
        name: 'åºŸå¼ƒé“è½¨',
        type: 'info',
        icon: 'ğŸ›¤ï¸',
        desc: 'é”ˆè¿¹æ–‘æ–‘çš„é“è½¨å»¶ä¼¸è‡³é»‘æš—æ·±å¤„ï¼Œä¸Šé¢ä¼¼ä¹æœ‰æ–°é²œçš„ç—•è¿¹ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'track_footprints',
                name: 'è¿½è¸ªè„šå°',
                desc: 'ä¾¦æŸ¥åˆ¤å®šå¯»æ‰¾è¸ªè¿¹',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 35 },
                results: {
                    fumble: { text: 'ä½ ä¸“æ³¨äºè„šå°ï¼Œæ²¡æ³¨æ„åˆ°è„šä¸‹çš„é“è½¨å‡¸èµ·ï¼Œé‡é‡æ‘”äº†ä¸€è·¤ã€‚', san: 8 },
                    fail: { text: 'é“è½¨ä¸Šçš„ç—•è¿¹å¤ªæ··ä¹±äº†ï¼Œä½ æ— æ³•ç¡®å®šè„šå°çš„æ–¹å‘ã€‚' },
                    success: { text: 'ä½ å‘ç°äº†æ–°é²œçš„è„šå°ï¼Œè‡³å°‘æœ‰3-4äººä¸ä¹…å‰ç»è¿‡è¿™é‡Œï¼Œæ–¹å‘æ˜¯æ·±å…¥çŸ¿å‘ã€‚', san: 3, clue: 'ç¬¬7å°é˜Ÿè¸ªè¿¹' },
                    crit: { text: 'ä½ ä¸ä»…å‘ç°äº†è„šå°ï¼Œè¿˜è¾¨è®¤å‡ºå…¶ä¸­ä¸€äººè„šæ­¥è¸‰è·„ï¼Œä¼¼ä¹æ˜¯å—ä¼¤æˆ–ç–²æƒ«ä¹‹äººã€‚å¢™è¾¹è¿˜æœ‰ç”¨åŒ•é¦–åŒ†å¿™åˆ»ä¸‹çš„è®°å·ã€‚', clue: 'é©¬åº“æ–¯è®°å·' }
                }
            },
            {
                id: 'check_rust',
                name: 'æ£€æŸ¥é”ˆè¿¹',
                desc: 'è§‚å¯Ÿé“è½¨çš„è…èš€ç¨‹åº¦',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'é“è½¨é”ˆè¿¹æ·±åšï¼Œè‡³å°‘æœ‰åå¹´ä»¥ä¸Šçš„å†å²ã€‚ä½†æœ‰äº›åœ°æ–¹çš„é”ˆè¿¹è¢«è¹­æ‰äº†ï¼Œè¯´æ˜è¿‘æœŸæœ‰äººä½¿ç”¨è¿‡ã€‚', san: 0, resolve: 10 }
                }
            }
        ]
    },
    'entrance_symbol': {
        id: 'entrance_symbol',
        name: 'å…¥å£ç¬¦å·',
        type: 'info',
        icon: 'âœï¸',
        desc: 'å²©å£ä¸Šåˆ»ç€å¤è€çš„ç¬¦å·ï¼Œä¼¼ä¹æ˜¯æŸç§è­¦å‘Šæˆ–æ ‡è®°ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'interpret_symbol',
                name: 'è§£è¯»ç¬¦å·',
                desc: 'è€ƒå¤å­¦å®¶æˆ–ç¥ç§˜å­¦åˆ¤å®š',
                cost: 1,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 35 },
                results: {
                    fumble: { text: 'ä½ è¯¯è§£äº†ç¬¦å·çš„å«ä¹‰ï¼Œæ„Ÿåˆ°ä¸€é˜µè«åçš„ææƒ§ç¬¼ç½©å¿ƒå¤´ã€‚é‚£ç¬¦å·ä¼¼ä¹åœ¨"çœ‹ç€"ä½ ã€‚', san: 10 },
                    fail: { text: 'ç¬¦å·çš„é£æ ¼å¾ˆå¤è€ï¼Œä½†ä½ æ— æ³•ç¡®å®šå…¶ç¡®åˆ‡å«ä¹‰ã€‚åªèƒ½è¾¨è®¤å‡ºè¿™æ˜¯æŸç§è­¦å‘Šã€‚', san: 3 },
                    success: { text: 'ä½ è®¤å‡ºè¿™æ˜¯å¤æ‹‰ä¸è¯­çš„å˜ä½“ï¼š"æ·±å…¥è€…å°†ä»˜å‡ºä»£ä»·"ã€‚è¿™æ˜¯ä¸€ä¸ªå¤è€çš„è­¦å‘Šã€‚', san: 5, clue: 'å¤è€è­¦å‘Š' },
                    crit: { text: 'ä½ ä¸ä»…è¯»æ‡‚äº†ç¬¦å·ï¼Œè¿˜å‘ç°éšè—çš„ç¬¬äºŒå±‚ä¿¡æ¯â€”â€”é‚£æ˜¯åæ¥çš„åˆ»ç—•ï¼š"ä¸»æ•™å·²ä¸å†æ˜¯ä»–è‡ªå·±ï¼Œä¸è¦ç›¸ä¿¡ä»–è¯´çš„è¯ã€‚â€”â€”é©¬åº“æ–¯"', clue: 'é©¬åº“æ–¯è­¦å‘Š' }
                }
            },
            {
                id: 'archaeologist_read',
                name: 'è€ƒå¤å­¦è§£è¯»',
                desc: 'è€ƒå¤å­¦å®¶ä¸“é•¿ï¼ˆè‹¥æœ‰è€ƒå¤å­¦å®¶åˆ™å¿…æˆåŠŸï¼‰',
                cost: 1,
                roll: { type: 'auto', condition: 'archaeologist' },
                results: {
                    success: { text: 'ä½œä¸ºè€ƒå¤å­¦å®¶ï¼Œä½ ç†Ÿæ‚‰è¿™ç§å¤ç½—é©¬çŸ¿äº•çš„æ ‡è®°ç³»ç»Ÿã€‚ç¬¦å·æ„æ€æ˜¯"å‰æ–¹å±é™©ï¼Œç¦æ­¢æ·±å…¥"ï¼Œä½†è¢«äººä¸ºä¿®æ”¹è¿‡ã€‚', san: 0, resolve: 25, clue: 'è€ƒå¤å‘ç°' },
                    fail: { text: 'é˜Ÿä¼ä¸­æ²¡æœ‰è€ƒå¤å­¦å®¶ï¼Œä½ æ— æ³•ç¡®å®šç¬¦å·çš„å¹´ä»£å’Œå«ä¹‰ã€‚', san: 0, resolve: 5 }
                }
            }
        ]
    },

    // ========== 2. å¡Œé™·é€šé“ (collapse) - æ•™å­¦å…³å¡ ==========
    'debris': {
        id: 'debris',
        name: 'å µå¡é€šé“çš„ç¢çŸ³å †',
        type: 'obstacle',
        icon: 'ğŸª¨',
        desc: 'é€šé“è¢«ç¢çŸ³éƒ¨åˆ†å µå¡ï¼Œä½†è¿˜æœ‰ä¸€æ¡çª„ç¼å¯ä»¥é€šè¿‡ã€‚ç¢çŸ³å †ä¸Šè¦†ç›–ç€æ–°é²œçš„ç°å°˜å’ŒæŠ“ç—•ï¼Œçœ‹èµ·æ¥æ˜¯è¿‘æœŸå½¢æˆçš„åå¡Œã€‚',
        visible: 'always',
        actions: [
            {
                id: 'force_push',
                name: 'å¼ºè¡Œæ¨å¼€',
                desc: 'ç”¨è›®åŠ›æ¸…ç†é€šé“ï¼ˆåŠ›é‡åˆ¤å®šï¼‰',
                cost: 1,
                roll: { type: 'skill', skill: 'åŠ›é‡', base: 30 },
                results: {
                    fumble: { text: 'ä½ è¢«ç¢çŸ³ç ¸ä¸­æ‰‹è‡‚ï¼Œé²œè¡€ç›´æµã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œä½ è§¦åŠ¨äº†ä¸ç¨³å®šçš„ç»“æ„ï¼Œç¢çŸ³åè€Œæ»‘è½å µä½æ›´å¤šç©ºé—´ã€‚ç–¼ç—›å’ŒæŒ«è´¥æ„ŸåŒæ—¶è¢­æ¥ã€‚', san: 5, hp: -10 },
                    fail: { text: 'ç¢çŸ³å¤ªé‡äº†ï¼Œä½ çš„åŠªåŠ›æ”¶æ•ˆç”šå¾®ã€‚æœ€åä½ åªèƒ½å‹‰å¼ºæ¸…å‡ºä¸€æ¡çª„ç¼ï¼Œç‹¼ç‹ˆåœ°æŒ¤äº†è¿‡å»ï¼Œè¡£æœè¢«åˆ’ç ´äº†å¥½å‡ å¤„ã€‚', san: 2 },
                    success: { text: 'ä½ ç”¨å°½å…¨åŠ›æ¨å¼€ç¢çŸ³ï¼Œæ‰‹è‡‚è‚Œè‚‰å› ç”¨åŠ›è€Œé¢¤æŠ–ã€‚éšç€æœ€åä¸€å—å¤§çŸ³å¤´è¢«ç§»å¼€ï¼Œä¸€æ¡å¯å®¹äººé€šè¿‡çš„é€šé“ç»ˆäºæ˜¾éœ²å‡ºæ¥ã€‚ç¢çŸ³å †çš„çŠ¶æ€å·²è¢«æ›´æ–°ã€‚', solveObject: 'debris' },
                    crit: { text: 'ä½ æ‰¾åˆ°å®Œç¾çš„å‘åŠ›ç‚¹ï¼Œåˆ©ç”¨æ æ†åŸç†å·§å¦™æ–½åŠ›ã€‚ç¢çŸ³è½°ç„¶å€’å¡Œï¼Œä¸ä»…éœ²å‡ºå®Œæ•´çš„é€šé“ï¼Œä½ è¿˜å‘ç°çŸ³å—åé¢è—ç€ä¸€ä¸ªå°ç©ºé—´â€”â€”é‡Œé¢æœ‰ä¸€æŠŠç”Ÿé”ˆçš„åŒ•é¦–å’ŒåŠåŒ…å‹ç¼©é¥¼å¹²ï¼å‰äººç•™ä¸‹çš„ç‰©èµ„ä¹Ÿè®¸èƒ½æ´¾ä¸Šç”¨åœºã€‚', solveObject: 'debris', item: 'ç”Ÿé”ˆåŒ•é¦–' }
                }
            },
            {
                id: 'find_weakpoint',
                name: 'å¯»æ‰¾ç¨³å›ºç‚¹',
                desc: 'ä¾¦æŸ¥ç»“æ„å¼±ç‚¹ï¼ˆä¾¦æŸ¥åˆ¤å®šï¼Œå†›äºº/è€ƒå¤å­¦å®¶ä¼˜åŠ¿ï¼‰',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 35 },
                results: {
                    fumble: { text: 'ä½ çš„è§‚å¯Ÿè®©ä½ è¿‡äºä¸“æ³¨ï¼Œæ²¡æ³¨æ„åˆ°å¤´é¡¶çš„ç¢çŸ³æ­£åœ¨æ¾åŠ¨ã€‚ä¸€å—çŸ³å¤´ç ¸åœ¨ä½ çš„è‚©è†€ä¸Šï¼Œç–¼ç—›è®©ä½ å€’å¸ä¸€å£å†·æ°”ã€‚', san: 5, hp: -5 },
                    fail: { text: 'ä½ è§‚å¯Ÿäº†åŠå¤©ä¹Ÿæ²¡æ‰¾åˆ°å¥½åŠæ³•ã€‚ç¢çŸ³çš„å †ç§¯æ–¹å¼çœ‹èµ·æ¥æ‚ä¹±æ— ç« ï¼Œä½ æ— æ³•åˆ¤æ–­å“ªé‡Œæ˜¯å®‰å…¨çš„ç€åŠ›ç‚¹ã€‚çœ‹æ¥åªèƒ½å°è¯•è›®åŠ›äº†ã€‚', redirect: 'force_push' },
                    success: { text: 'ä½ è¹²ä¸‹èº«ä»”ç»†è§‚å¯Ÿç¢çŸ³å †çš„é‡å¿ƒä½ç½®ï¼Œå‘ç°å‡ å—å…³é”®çŸ³å¤´æ”¯æ’‘ç€æ•´ä¸ªç»“æ„ã€‚ä½ å·§å¦™åœ°æ’¬åŠ¨è¿™äº›æ”¯ç‚¹ï¼Œç¢çŸ³å †åƒ puzzle ä¸€æ ·å±‚å±‚å€’å¡Œï¼Œé€šé“é¡ºåˆ©æ‰“å¼€äº†ã€‚', solveObject: 'debris' },
                    crit: { text: 'ä½ çš„ä¸“ä¸šçœ¼å…‰ç«‹åˆ»é”å®šäº†å‡ å¤„å…³é”®æ”¯ç‚¹ã€‚åœ¨æ’¬åŠ¨çŸ³å—çš„è¿‡ç¨‹ä¸­ï¼Œä½ æ³¨æ„åˆ°ç¢çŸ³å †åé¢è—ç€ä¸€ä¸ªå°ç©ºé—´â€”â€”é‡Œé¢æœ‰ä¸€æŠŠç”Ÿé”ˆçš„åŒ•é¦–ï¼è¿™æ˜¾ç„¶æ˜¯å‰äººç•™ä¸‹çš„ï¼ŒåŒ•é¦–æŸ„ä¸Šåˆ»ç€"DIA-7"çš„å­—æ ·ã€‚', solveObject: 'debris', item: 'ç”Ÿé”ˆåŒ•é¦–' }
                }
            }
        ]
    },
    'symbols': {
        id: 'symbols',
        name: 'å¢™ä¸Šçš„åˆ»ç—•',
        type: 'info',
        icon: 'âœï¸',
        desc: 'å¢™ä¸Šæœ‰æ–°é²œçš„åˆ’ç—•â€”â€”æœ‰äººç”¨åŒ•é¦–åˆ»ä¸‹äº†ç¬¦å·ã€‚åˆ»ç—•å¾ˆæ·±ï¼ŒåŠ›åº¦ä¸å‡ï¼Œæ˜¾ç¤ºå‡ºåˆ»å†™è€…å½“æ—¶æƒ…ç»ªæ¿€åŠ¨æˆ–æ—¶é—´ç´§è¿«ã€‚ç¬¦å·å‘¨å›´è¿˜æœ‰ä¸€äº›è¤è‰²çš„æ±¡æ¸ï¼Œå¯èƒ½æ˜¯è¡€è¿¹ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'interpret_symbols',
                name: 'è§£è¯»ç¬¦å·',
                desc: 'å°è¯•ç†è§£è¿™äº›æ ‡è®°ï¼ˆç¥ç§˜å­¦åˆ¤å®šï¼‰',
                cost: 1,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 35 },
                results: {
                    fumble: { text: 'ä½ ç›¯ç€ç¬¦å·çœ‹å¾—å¤ªä¹…ï¼Œçªç„¶æ„Ÿåˆ°ä¸€é˜µçœ©æ™•...é‚£äº›çº¿æ¡ä¼¼ä¹åœ¨è •åŠ¨ï¼Œåƒæ˜¯æœ‰ç”Ÿå‘½çš„è§¦é¡»ã€‚å½“ä½ å›è¿‡ç¥æ¥ï¼Œå‘ç°æ‰‹æŒ‡ä¸è‡ªè§‰åœ°åœ¨è‡ªå·±çš„æ‰‹è‡‚ä¸Šåˆ’åŠ¨ï¼Œç•™ä¸‹æµ…æµ…çš„è¡€ç—•ã€‚æŸç§ä¸œè¥¿é€è¿‡ç¬¦å·è§¦ç¢°äº†ä½ ã€‚', san: 10 },
                    fail: { text: 'ç¬¦å·çš„é£æ ¼å¾ˆå¤è€ï¼Œå¸¦æœ‰æ‹‰ä¸è¯­çš„ç‰¹å¾ï¼Œä½†ä½ æ— æ³•ç¡®å®šå…¶ç¡®åˆ‡å«ä¹‰ã€‚ä½ ä¾ç¨€è¾¨è®¤å‡ºå‡ ä¸ªå­—æ¯ï¼Œä½†ç»„åˆåœ¨ä¸€èµ·å´ä¸æ„æˆæœ‰æ„ä¹‰çš„è¯æ±‡ã€‚ä½ å†³å®šè®°å½•ä¸‹æ¥ï¼Œä¹Ÿè®¸åé¢ä¼šæœ‰ç”¨ã€‚', clue: 'æœªçŸ¥ç¬¦å·' },
                    success: { text: 'ä½ è¾¨è®¤å‡ºè¿™æ˜¯æ‹‰ä¸è¯­çš„å˜ä½“ï¼ŒåŸæœ¬çš„æ„æ€æ˜¯"å±é™©"ï¼Œä½†è¢«äººåˆ»æ„ä¿®æ”¹æˆäº†"é‚€è¯·"ã€‚åˆ»ç—•çš„æ·±æµ…å’Œè§’åº¦æ˜¾ç¤ºè¿™æ˜¯åŒä¸€æŠŠåŒ•é¦–æ‰€ä¸ºâ€”â€”æœ‰äººè¯±å¯¼åæ¥è€…æ·±å…¥ã€‚è¿™ä¸ªå‘ç°è®©ä½ æ„Ÿåˆ°ä¸€é˜µå¯’æ„ã€‚', clue: 'è¯±å¯¼æ ‡è®°' },
                    crit: { text: 'ä½ ä¸ä»…è¯»æ‡‚äº†ç¬¦å·çš„è¡¨é¢å«ä¹‰ï¼Œè¿˜å‘ç°äº†éšè—çš„å¯†ç è§„å¾‹ã€‚ç¬¬7ä¸ªå­—æ¯è¢«äººä¸ºæ›¿æ¢ï¼ŒæŒ‡å‘"ç¬¬7å°é˜Ÿ"ã€‚è¿™æ˜¯é©¬åº“æ–¯ç•™ä¸‹çš„è­¦å‘Šï¼ä»–è¯•å›¾ç”¨åªæœ‰DIAå†…éƒ¨äººå‘˜èƒ½çœ‹æ‡‚çš„æ–¹å¼ä¼ é€’ä¿¡æ¯ï¼šå‰æ–¹æ˜¯é™·é˜±ï¼Œä¸è¦ç›¸ä¿¡ä»»ä½•"é‚€è¯·"ã€‚', clue: 'é©¬åº“æ–¯å¯†ç ' }
                }
            }
        ]
    },
    'diary': {
        id: 'diary',
        name: 'å¢™è§’çš„æ—¥è®°',
        type: 'story',
        icon: 'ğŸ“–',
        desc: 'ä¸€æœ¬ç ´æ—§çš„æ—¥è®°ï¼Œè¢«éšæ„ä¸¢åœ¨å¢™è§’ã€‚å°é¢å·²ç»è¢«è¡€æµ¸é€äº†ä¸€åŠï¼Œçº¸é¡µåœ¨æ½®æ¹¿çš„ç¯å¢ƒä¸­å¾®å¾®å·æ›²ã€‚æ—¥è®°çš„ä¸»äººæ˜¾ç„¶èµ°å¾—éå¸¸åŒ†å¿™ï¼Œæœ€åå‡ é¡µå‡ ä¹æ˜¯æ’•æ‰¯ä¸‹æ¥çš„ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'read_diary',
                name: 'é˜…è¯»æ—¥è®°',
                desc: 'äº†è§£ä¹‹å‰å‘ç”Ÿäº†ä»€ä¹ˆ',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ å°å¿ƒç¿¼ç¿¼åœ°ç¿»å¼€æ—¥è®°ï¼š"11æœˆ14æ—¥ï¼šæ‰¾åˆ°æ·±æ¸Šå…¥å£ï¼Œä¸€åˆ‡æ­£å¸¸ã€‚11æœˆ15æ—¥ï¼šé©¬åº“æ–¯é˜Ÿé•¿è¯´è¿™é‡Œä¸å¯¹åŠ²ï¼ŒåŸƒå¾·è’™ä¸»æ•™çš„è¡Œä¸ºå¾ˆå¥‡æ€ªã€‚11æœˆ16æ—¥ï¼šæˆ‘å¿…é¡»è—èµ·æ¥ï¼Œä»–ä»¬å·²ç»ä¸å†æ˜¯æˆ‘è®¤è¯†çš„é˜Ÿå‹äº†ã€‚æˆ‘å¬åˆ°ä»–ä»¬åœ¨è®¨è®ºã€ŒçŒ®ç¥­ã€å’Œã€Œä»ªå¼ã€ã€‚å¦‚æœæœ‰äººçœ‹åˆ°è¿™æœ¬æ—¥è®°ï¼Œè¯·å‘Šè¯‰è‰¾æ‹‰â€”â€”æˆ‘çˆ±å¥¹ã€‚â€”â€”ç§‘æ—ï¼ŒDIAç¬¬7å°é˜Ÿè€ƒå¤å­¦å®¶" æ—¥è®°åˆ°è¿™é‡Œæˆ›ç„¶è€Œæ­¢ï¼Œæœ€åå‡ é¡µè¢«æ’•æ‰äº†ã€‚', san: 5, clue: 'ç§‘æ—çš„æ—¥è®°' }
                }
            },
            {
                id: 'take_diary',
                name: 'å¸¦èµ°æ—¥è®°',
                desc: 'ä½œä¸ºè¯æ®ä¿å­˜',
                cost: 0,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ å°†æ—¥è®°å°å¿ƒåœ°æ”¶å¥½ï¼Œç”¨é˜²æ°´è¢‹åŒ…è£¹èµ·æ¥ã€‚è¿™æœ¬æ—¥è®°æ˜¯ç¬¬7å°é˜Ÿé­é‡çš„é‡è¦è¯æ®ï¼Œä¹Ÿè®¸èƒ½åœ¨åç»­çš„è°ƒæŸ¥ä¸­æ´¾ä¸Šç”¨åœºã€‚ç§‘æ—æåˆ°çš„"è‰¾æ‹‰"å¯èƒ½æ˜¯å…³é”®äººç‰©ã€‚', item: 'ç§‘æ—çš„æ—¥è®°' }
                }
            }
        ]
    },
    'exit_narrow': {
        id: 'exit_narrow',
        name: 'ç‹­çª„çš„é€šé“',
        type: 'exit',
        icon: 'ğŸšª',
        desc: 'é€šå¾€æ·±å¤„çš„é€šé“ï¼Œé»‘æš—ä¸­ä¼ æ¥å¾®å¼±çš„æ°”æµã€‚é€šé“çš„å²©å£ä¸Šæœ‰æ–°é²œçš„åˆ®æ“¦ç—•è¿¹ï¼Œæ˜¾ç¤ºè¿‘æœŸæœ‰äººç»è¿‡ã€‚',
        visible: 'conditional',
        unlockConditions: [{ type: 'object_solved', target: 'debris' }],
        lockedText: 'ğŸ”’ ç¢çŸ³å †æŒ¡ä½äº†å»è·¯',
        unlockedText: 'âœ“ é€šé“å·²æ¸…ç†',
        actions: [
            {
                id: 'go_equipment',
                name: 'å‰å¾€é—å¼ƒè£…å¤‡å®¤',
                desc: 'ç»§ç»­æ¢ç´¢',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ å°å¿ƒåœ°ç©¿è¿‡æ¸…ç†åçš„é€šé“ï¼Œè„šæ­¥å£°åœ¨ç‹­çª„çš„å²©å£é—´å›è¡ã€‚å‰æ–¹éšçº¦ä¼ æ¥å¾®å¼±çš„å…‰äº®...', next: 2 }
                }
            }
        ]
    },

    // ========== 3. é—å¼ƒè£…å¤‡å®¤ (equipment) ==========
    'supply_box': {
        id: 'supply_box',
        name: 'è£…å¤‡ç®±',
        type: 'info',
        icon: 'ğŸ“¦',
        desc: 'DIAæ ‡å‡†çš„è£…å¤‡è¡¥ç»™ç®±ï¼Œé”æ‰£å·²ç»æŸåï¼Œå¯ä»¥è½»æ¾æ‰“å¼€ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'open_box',
                name: 'æ‰“å¼€è£…å¤‡ç®±',
                desc: 'è·å–é‡Œé¢çš„è¡¥ç»™å“',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ æ‰“å¼€è£…å¤‡ç®±ï¼Œå‘ç°2æ”¯é•‡é™å‰‚ã€1ä¸ªæ€¥æ•‘åŒ…å’Œä¸€æŠŠæ‰‹ç”µç­’ã€‚ç¬¬7å°é˜Ÿæ˜¾ç„¶èµ°å¾—åŒ†å¿™ï¼Œè¿™äº›ç‰©èµ„éƒ½æ²¡å¸¦èµ°ã€‚', item: 'é•‡é™å‰‚x2' }
                }
            },
            {
                id: 'check_trap',
                name: 'æ£€æŸ¥é™·é˜±',
                desc: 'ä¾¦æŸ¥åˆ¤å®šç¡®è®¤æ˜¯å¦å®‰å…¨',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 40 },
                results: {
                    fumble: { text: 'ä½ æ£€æŸ¥æ—¶è§¦å‘äº†éšè—çš„ç»Šçº¿ï¼Œä¸€é˜µåˆºè€³çš„è­¦æŠ¥å£°åœ¨æ´å®¤ä¸­å›è¡ï¼éšåæ˜¯æ­»å¯‚...', san: 10 },
                    fail: { text: 'ä½ ä»”ç»†æ£€æŸ¥åè®¤ä¸ºå®‰å…¨ï¼Œä½†æ‰“å¼€æ—¶è¿˜æ˜¯æœ‰è½»å¾®çš„å¼‚å¸¸â€”â€”ç®±åº•æœ‰äº›é»ç¨ çš„æ¶²ä½“ã€‚', san: 5, item: 'é•‡é™å‰‚x1' },
                    success: { text: 'ä½ å‘ç°ç®±ç›–ä¸Šè¿ç€ä¸€æ ¹ç»†çº¿ï¼Œå°å¿ƒè§£é™¤åæ‰æ‰“å¼€ã€‚é‡Œé¢ç‰©èµ„å®Œå¥½ã€‚', item: 'é•‡é™å‰‚x2' },
                    crit: { text: 'ä½ ä¸ä»…å‘ç°äº†é™·é˜±ï¼Œè¿˜çœ‹å‡ºè¿™æ˜¯é©¬åº“æ–¯è®¾ç½®çš„é¢„è­¦è£…ç½®ã€‚è§£é™¤åï¼Œä½ åœ¨ç®±åº•æš—æ ¼å‘ç°é¢å¤–çš„å¼¹è¯å’Œä¸€å¼ æ‰‹å†™ä¾¿æ¡ã€‚', item: 'é•‡é™å‰‚x2+ä¾¿æ¡', clue: 'é©¬åº“æ–¯ä¾¿æ¡' }
                }
            }
        ]
    },
    'oil_lamp': {
        id: 'oil_lamp',
        name: 'ç…¤æ²¹ç¯',
        type: 'story',
        icon: 'ğŸª”',
        desc: 'ä¸€ç›ä»åœ¨å¾®å¾®ç‡ƒçƒ§çš„ç…¤æ²¹ç¯ï¼Œä»¿ä½›ä¸»äººåªæ˜¯æš‚æ—¶ç¦»å¼€...',
        visible: 'always',
        actions: [
            {
                id: 'check_lamp',
                name: 'æ£€æŸ¥ç¯èŠ¯',
                desc: 'è§‚å¯Ÿç«ç„°çš„å¼‚å¸¸',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ é è¿‘ç…¤æ²¹ç¯ï¼Œå‘ç°ç«ç„°çš„é¢œè‰²ä¸å¤ªå¯¹â€”â€”å®ƒæ³›ç€æ·¡æ·¡çš„è“è‰²ï¼Œåƒæ˜¯è¢«ä»€ä¹ˆä¸œè¥¿å½±å“ç€ã€‚ç¯åº§ä¸‹å‹ç€ä¸€å¼ çº¸æ¡ã€‚', san: 3, clue: 'ç¯åº§ä¾¿æ¡' }
                }
            },
            {
                id: 'extinguish',
                name: 'ç†„ç­æ²¹ç¯',
                desc: 'å¹ç­è¿™è¯¡å¼‚çš„ç«ç„°',
                cost: 0,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ å¹ç­äº†æ²¹ç¯ï¼Œé»‘æš—ç¬é—´åå™¬äº†æ´å®¤ã€‚ä½†åœ¨ç¯èŠ¯ç†„ç­å‰çš„æœ€åä¸€åˆ»ï¼Œä½ ä¼¼ä¹çœ‹åˆ°äº†...ä»€ä¹ˆå½±å­åœ¨å¢™è§’ç§»åŠ¨ï¼Ÿ', san: 10 }
                }
            },
            {
                id: 'take_lamp',
                name: 'å¸¦èµ°æ²¹ç¯',
                desc: 'è¿™å¯èƒ½åœ¨åé¢æœ‰ç”¨',
                cost: 0,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ å°å¿ƒåœ°æèµ·ç…¤æ²¹ç¯ï¼Œå‘ç°å®ƒæ¯”çœ‹èµ·æ¥è¦å†·å¾—å¤šï¼Œä»¿ä½›ç«ç„°çš„çƒ­é‡è¢«ä»€ä¹ˆä¸œè¥¿å¸èµ°äº†ã€‚', san: 5, item: 'è¯¡å¼‚æ²¹ç¯' }
                }
            }
        ]
    },
    'marcus_note': {
        id: 'marcus_note',
        name: 'é©¬åº“æ–¯çš„ä¾¿æ¡',
        type: 'info',
        icon: 'ğŸ“„',
        desc: 'ä¸€å¼ ä»“ä¿ƒå†™ä¸‹çš„ä¾¿æ¡ï¼Œå­—è¿¹æ½¦è‰ä½†è¿˜èƒ½è¾¨è®¤ã€‚',
        visible: 'item:oil_lamp',
        actions: [
            {
                id: 'read_note',
                name: 'é˜…è¯»ä¾¿æ¡',
                desc: 'äº†è§£é©¬åº“æ–¯çš„è­¦å‘Š',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: '"å¦‚æœæˆ‘ä»¬æ²¡å›æ¥ï¼Œä¸è¦æ·±å…¥ã€‚ä¸»æ•™å·²ç»ä¸æ˜¯äººäº†ã€‚ä¸è¦ç›¸ä¿¡ä»–çš„è¯ï¼Œä¸è¦ç›´è§†ä»–çš„çœ¼ç›ã€‚â€”â€”é©¬åº“æ–¯"', san: 8, clue: 'ä¸»æ•™çœŸç›¸' }
                }
            },
            {
                id: 'burn_note',
                name: 'çƒ§æ¯ä¾¿æ¡',
                desc: 'é”€æ¯è¿™ä¸ç¥¥çš„è®°å½•',
                cost: 0,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ç«ç„°åå™¬äº†ä¾¿æ¡ï¼Œä½†é‚£äº›å­—è¿¹å·²ç»åˆ»åœ¨ä½ çš„è„‘æµ·é‡Œã€‚ä¸»æ•™...å·²ç»ä¸æ˜¯äººäº†...', san: 12, resolve: 10 }
                }
            }
        ]
    },
    'exit_equipment': {
        id: 'exit_equipment',
        name: 'ç¦»å¼€è£…å¤‡å®¤',
        type: 'exit',
        icon: 'ğŸšª',
        desc: 'è£…å¤‡å®¤çš„é—¨æ•å¼€ç€ï¼Œå‰æ–¹é€šé“é€šå‘æ›´æ·±çš„çŸ¿å‘ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'go_camp',
                name: 'å‰å¾€ç¬¬7å°é˜Ÿè¥åœ°',
                desc: 'ç»§ç»­å‰è¿›',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ æ•´ç†å¥½è£…å¤‡ï¼Œç¦»å¼€è¡¥ç»™ç‚¹ï¼Œæ²¿ç€é€šé“å‘è¥åœ°èµ°å»...', next: 4 }
                }
            }
        ]
    },
    'exit_camp': {
        id: 'exit_camp',
        name: 'ç¦»å¼€è¥åœ°',
        type: 'exit',
        icon: 'ğŸšª',
        desc: 'è¥åœ°çš„å‡ºå£é€šå‘æ›´æ·±å¤„çš„çŸ¿é“ï¼Œä½è¯­å£°ä»é»‘æš—ä¸­ä¼ æ¥ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'go_whisper',
                name: 'å‰å¾€ä½è¯­å›å»Š',
                desc: 'ç»§ç»­å‰è¿›',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ ç¦»å¼€è¥åœ°ï¼Œæ²¿ç€ç‹­çª„çš„é€šé“æ·±å…¥ã€‚ç©ºæ°”è¶Šæ¥è¶Šæ½®æ¹¿ï¼Œå¢™å£å¼€å§‹æ¸—å‡ºæ°´ç ...', next: 5 }
                }
            }
        ]
    },

    // ========== 4. è¯¡å¼‚å£ç”»å… (mural) ==========
    'mural_left': {
        id: 'mural_left',
        name: 'å·¦ä¾§å£ç”»',
        type: 'info',
        icon: 'ğŸ¨',
        desc: 'æç»˜ç€ä¸€ç¾¤äººè·ªæ‹œåœ¨æ·±æ¸Šè£‚éš™å‰çš„åœºæ™¯ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'examine_left',
                name: 'ä»”ç»†è§‚å¯Ÿ',
                desc: 'è€ƒå¤å­¦æˆ–ç¥ç§˜å­¦åˆ¤å®š',
                cost: 1,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 35 },
                results: {
                    fumble: { text: 'ä½ ç›¯ç€å£ç”»çœ‹å¾—å¤ªä¹…ï¼Œé‚£äº›è·ªæ‹œçš„äººä¼¼ä¹åœ¨åŠ¨...ä»–ä»¬çš„å¤´...è½¬å‘äº†...ä½ ...', san: 15 },
                    fail: { text: 'å£ç”»çš„é£æ ¼å¾ˆå¤è€ï¼Œé¢œæ–™ä¸­æ··æ‚ç€æŸç§å‘å…‰çš„çŸ¿ç‰©è´¨ï¼Œä½†ä½ æ— æ³•ç†è§£å…¶å«ä¹‰ã€‚', san: 5 },
                    success: { text: 'ä½ è®¤å‡ºè¿™æ˜¯æŸç§ä»ªå¼åœºæ™¯ã€‚è·ªæ‹œè€…ä¸æ˜¯è¢«è¿«çš„â€”â€”ä»–ä»¬æ˜¯è‡ªæ„¿çš„ï¼Œç”šè‡³æ˜¯ç‹‚çƒ­çš„ã€‚', san: 5, clue: 'ç‹‚çƒ­ä¿¡å¾’' },
                    crit: { text: 'ä½ ä¸ä»…çœ‹æ‡‚äº†ç”»é¢ï¼Œè¿˜è¾¨è®¤å‡ºè·ªæ‹œè€…ç©¿ç€çš„æœé¥°â€”â€”é‚£æ˜¯DIAæ—©æœŸæ¢é™©é˜Ÿçš„åˆ¶æœï¼ä»–ä»¬åœ¨...å´‡æ‹œæ·±æ¸Šï¼Ÿ', clue: 'DIAå›å¾’' }
                }
            }
        ]
    },
    'mural_center': {
        id: 'mural_center',
        name: 'ä¸­å¤®å£ç”»',
        type: 'info',
        icon: 'ğŸ¨',
        desc: 'æç»˜ç€ä¸€ä¸ªå·¨å¤§çš„é»‘è‰²è£‚éš™ï¼Œåƒæ˜¯ç©ºé—´çš„ä¼¤å£ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'examine_center',
                name: 'ç›´è§†æ·±æ¸Š',
                desc: 'ç¥ç§˜å­¦åˆ¤å®šï¼Œé«˜é£é™©é«˜å›æŠ¥',
                cost: 1,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 40 },
                results: {
                    fumble: { text: 'ä½ å‡è§†ç€ä¸­å¤®çš„é»‘è‰²è£‚éš™ï¼Œçªç„¶æ„è¯†åˆ°å®ƒä¹Ÿåœ¨å‡è§†ç€ä½ ã€‚ä¸€ç§æ— æ³•åçŠ¶çš„ææƒ§æ”«ä½äº†ä½ çš„å¿ƒè„ã€‚ä½ è·ªå€’åœ¨åœ°ï¼Œå‘•åèµ·æ¥ã€‚', san: 20 },
                    fail: { text: 'ä½ ç›¯ç€å£ç”»ä¸­å¤®çš„é»‘æš—çœ‹äº†ä¸€ä¼šå„¿ï¼Œæ„Ÿåˆ°ä¸€é˜µçœ©æ™•ã€‚é‚£é»‘æš—...ä¼¼ä¹åœ¨æ‰©æ•£ï¼Ÿ', san: 10 },
                    success: { text: 'ä½ å¼ºè¿«è‡ªå·±åˆ†æå£ç”»çš„æ„å›¾ã€‚é‚£è£‚éš™ä¸æ˜¯è¢«ç”»å‡ºæ¥çš„â€”â€”å®ƒæ˜¯è¢«"å°å°"åœ¨å£ç”»ä¸­çš„ã€‚å¤äººç”¨æŸç§æ–¹æ³•æŠŠæ·±æ¸Šçš„ä¸€éƒ¨åˆ†å›°åœ¨äº†è¿™é‡Œã€‚', san: 8, clue: 'å°å°å£ç”»' },
                    crit: { text: 'ä½ çªç„¶ç†è§£äº†è¿™å¹…å£ç”»çš„çœŸæ­£ç›®çš„â€”â€”å®ƒä¸æ˜¯è®°å½•ï¼Œæ˜¯è­¦å‘Šï¼Œä¹Ÿæ˜¯æ•™ç¨‹ã€‚å¤äººç•™ä¸‹äº†å¯¹æŠ—æ·±æ¸Šçš„æ–¹æ³•ï¼šå®ˆé—¨äººä»ªå¼ã€‚', clue: 'å®ˆé—¨äººç§˜å¯†' }
                }
            }
        ]
    },
    'mural_right': {
        id: 'mural_right',
        name: 'å³ä¾§å£ç”»',
        type: 'story',
        icon: 'ğŸ¨',
        desc: 'è¿™éƒ¨åˆ†å£ç”»è¢«åˆ»æ„ç ´åäº†ï¼Œåªå‰©ä¸‹ç¢ç‰‡ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'examine_right',
                name: 'æ‹¼å‡‘ç¢ç‰‡',
                desc: 'ä¾¦æŸ¥åˆ¤å®šè¿˜åŸå†…å®¹',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 40 },
                results: {
                    fumble: { text: 'ä½ è¯•å›¾ç§»åŠ¨å£ç”»ç¢ç‰‡ï¼Œä½†ç¢ç‰‡çªç„¶è„±è½ï¼Œåœ¨ä½ æ‰‹ä¸Šåˆ’å‡ºä¸€é“ä¼¤å£ã€‚è¡€æ»´è½åœ¨å£ç”»ä¸Šï¼Œè¯¡å¼‚çš„æ˜¯ï¼Œé‚£è¡€è¿¹...æ¶ˆå¤±äº†ã€‚', san: 10 },
                    fail: { text: 'ç ´åå¤ªä¸¥é‡äº†ï¼Œä½ åªèƒ½è¾¨è®¤å‡ºä¸€äº›é›¶æ•£çš„ç¬¦å·ï¼Œæ— æ³•ç†è§£æ•´ä½“å†…å®¹ã€‚' },
                    success: { text: 'ä½ å°å¿ƒåœ°æ‹¼å‡‘ç¢ç‰‡ï¼Œè¾¨è®¤å‡ºä¸€å¥è¯ï¼š"å®ˆé—¨äººå¿…é¡»æ˜¯è‡ªæ„¿çš„ï¼Œå¦åˆ™å°å°å°†æˆä¸ºå¬å”¤ã€‚"', san: 5, clue: 'è‡ªæ„¿åŸåˆ™' },
                    crit: { text: 'ä½ ä¸ä»…æ‹¼å‡‘å‡ºæ–‡å­—ï¼Œè¿˜å‘ç°è¢«ç ´åçš„ç—•è¿¹å¾ˆæ–°â€”â€”ä¸åˆ°ä¸€å‘¨ã€‚æœ‰äººä¸æƒ³è®©åæ¥è€…çœ‹åˆ°è¿™éƒ¨åˆ†ã€‚é©¬åº“æ–¯ï¼Ÿè¿˜æ˜¯...åŸƒå¾·è’™ï¼Ÿ', clue: 'ç ´åè€…èº«ä»½' }
                }
            }
        ]
    },
    'exit_mural': {
        id: 'exit_mural',
        name: 'ç¦»å¼€å£ç”»å…',
        type: 'exit',
        icon: 'ğŸšª',
        desc: 'å‰æ–¹çš„é€šé“é€šå‘æ›´æ·±çš„çŸ¿å‘ï¼Œç©ºæ°”ä¸­å¼¥æ¼«ç€æŸç§å¤è€çš„æ°”æ¯ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'go_camp_from_mural',
                name: 'å‰å¾€ç¬¬7å°é˜Ÿè¥åœ°',
                desc: 'ç»§ç»­å‰è¿›',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ è®°ä¸‹å£ç”»çš„å…³é”®ä¿¡æ¯ï¼Œç¦»å¼€å£ç”»å…ï¼Œæ²¿ç€é€šé“å‘è¥åœ°èµ°å»...', next: 4 }
                }
            }
        ]
    },

    // ========== 5. ç¬¬7å°é˜Ÿè¥åœ° (camp) ==========
    'camp_bed': {
        id: 'camp_bed',
        name: 'åºŠé“º',
        type: 'info',
        icon: 'ğŸ›ï¸',
        desc: 'ç®€é™‹çš„è¡Œå†›åºŠï¼Œè¢«å­å å¾—æ•´æ•´é½é½ï¼Œåƒæ˜¯ä¸»äººåˆšç¦»å¼€ä¸ä¹…ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'check_bed',
                name: 'æ£€æŸ¥åºŠé“º',
                desc: 'å¯»æ‰¾éšè—ç‰©å“',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 35 },
                results: {
                    fumble: { text: 'ä½ æ€èµ·åºŠå«æ—¶ï¼Œä¸€åªç¡•å¤§çš„é»‘è‰²ç”²è™«çªœäº†å‡ºæ¥ï¼Œç›´å†²ä½ çš„è„¸ï¼ä½ æƒŠå«ä¸€å£°åé€€ï¼Œæ’ç¿»äº†ç…¤æ²¹ç¯ã€‚', san: 10 },
                    fail: { text: 'åºŠé“ºå¾ˆæ•´æ´ï¼Œä½†æ²¡æœ‰å‘ç°ä»€ä¹ˆç‰¹åˆ«çš„ä¸œè¥¿ã€‚' },
                    success: { text: 'ä½ åœ¨æ•å¤´ä¸‹å‘ç°äº†ä¸€å¼ ç…§ç‰‡â€”â€”å¹´è½»çš„é©¬åº“æ–¯å’Œä¸€ä¸ªå¥³å­©ï¼ŒèƒŒæ™¯æ˜¯DIAæ€»éƒ¨ã€‚èƒŒé¢å†™ç€ï¼š"è‰¾æ‹‰ï¼Œç­‰æˆ‘å›æ¥ã€‚"', clue: 'é©¬åº“æ–¯çš„è‰¾æ‹‰' },
                    crit: { text: 'ä½ ä»”ç»†æ£€æŸ¥åºŠé“ºçš„æ¯ä¸ªè§’è½ï¼Œåœ¨åºŠå«çš„ç ´æ´ä¸­å‘ç°äº†ä¸€ä¸ªé˜²æ°´è¢‹ï¼Œé‡Œé¢æ˜¯ä¸€æœ¬ä¸ªäººæ—¥è®°å’Œä¸€æŠŠå†›ç”¨åŒ•é¦–ã€‚', item: 'å†›ç”¨åŒ•é¦–', clue: 'ä¸ªäººæ—¥è®°' }
                }
            },
            {
                id: 'rest',
                name: 'çŸ­æš‚ä¼‘æ¯',
                desc: 'æ¢å¤ä¸€äº›çŠ¶æ€',
                cost: 2,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ ååœ¨è¡Œå†›åºŠä¸ŠçŸ­æš‚ä¼‘æ¯ï¼Œè™½ç„¶ç¯å¢ƒé˜´æ£®ï¼Œä½†è‡³å°‘æ¯”ç«™ç€å¼ºã€‚ä½ æ„Ÿè§‰ç¨å¾®æ¢å¤äº†ä¸€äº›ä½“åŠ›ã€‚', san: -5, hp: 10 }
                }
            }
        ]
    },
    'camp_case': {
        id: 'camp_case',
        name: 'è£…å¤‡ç®±',
        type: 'obstacle',
        icon: 'ğŸ’¼',
        desc: 'ä¸€ä¸ªä¸Šé”çš„é‡‘å±ç®±å­ï¼Œä¸Šé¢è´´ç€"æœºå¯†"çš„æ ‡ç­¾ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'force_case',
                name: 'å¼ºè¡Œæ’¬å¼€',
                desc: 'åŠ›é‡åˆ¤å®šï¼Œå¯èƒ½æŸåå†…å®¹',
                cost: 1,
                roll: { type: 'skill', skill: 'åŠ›é‡', base: 40 },
                results: {
                    fumble: { text: 'ä½ ç”¨åŒ•é¦–æ’¬é”æ—¶ï¼Œç®±å­çªç„¶å¼¹å¼€ï¼Œä¸€è‚¡åˆºé¼»çš„åŒ–å­¦çƒŸé›¾å–·æ¶Œè€Œå‡ºï¼ä½ çš„çœ¼ç›ç«è¾£è¾£åœ°ç–¼ã€‚', san: 15 },
                    fail: { text: 'é”å¤ªåšå›ºäº†ï¼Œä½ åªèƒ½æ’¬å¼€ä¸€æ¡ç¼éš™ï¼Œé‡Œé¢çš„ä¸œè¥¿ä¼¼ä¹è¢«å›°ä½äº†ã€‚' },
                    success: { text: 'ä½ æˆåŠŸæ’¬å¼€äº†é”ï¼Œå‘ç°é‡Œé¢æ˜¯DIAçš„æœºå¯†æ–‡ä»¶å’Œä¸€å°æŸåçš„å½•éŸ³æœºã€‚', item: 'æœºå¯†æ–‡ä»¶', clue: 'DIAæœºå¯†' },
                    crit: { text: 'ä½ å®Œç¾åœ°æ’¬å¼€äº†é”ï¼Œç®±å­é‡Œçš„ä¸œè¥¿å®Œå¥½æ— æŸã€‚æœºå¯†æ–‡ä»¶ã€å½•éŸ³æœºï¼Œè¿˜æœ‰ä¸€å¼ æ‰‹ç»˜åœ°å›¾â€”â€”æ ‡è®°ç€"ä»ªå¼åœ°ç‚¹"ã€‚', item: 'æœºå¯†æ–‡ä»¶+åœ°å›¾', clue: 'ä»ªå¼åœ°ç‚¹' }
                }
            },
            {
                id: 'unlock_case',
                name: 'å¯»æ‰¾é’¥åŒ™',
                desc: 'ä¾¦æŸ¥åˆ¤å®šæ‰¾é’¥åŒ™',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 40 },
                results: {
                    success: { text: 'ä½ åœ¨åºŠé“ºçš„é‡‘å±æ¡†æ¶ä¸Šå‘ç°äº†ç”¨èƒ¶å¸¦ç²˜ç€çš„é’¥åŒ™ã€‚é©¬åº“æ–¯æ˜¾ç„¶ä¸æƒ³è®©åˆ«äººè½»æ˜“æ‰“å¼€è¿™ä¸ªç®±å­ã€‚', item: 'æœºå¯†æ–‡ä»¶+å½•éŸ³æœº' },
                    fail: { text: 'ä½ æ‰¾äº†åŠå¤©ä¹Ÿæ²¡æ‰¾åˆ°é’¥åŒ™ã€‚' }
                }
            }
        ]
    },
    'marcus_diary': {
        id: 'marcus_diary',
        name: 'é©¬åº“æ–¯æ—¥è®°',
        type: 'story',
        icon: 'ğŸ“–',
        desc: 'æ‘Šå¼€åœ¨æ¡Œä¸Šçš„æ—¥è®°ï¼Œå­—è¿¹ä»å·¥æ•´å˜å¾—æ½¦è‰ï¼Œæœ€åå‡ é¡µå‡ ä¹æ˜¯åœ¨é¢¤æŠ–ä¸­å†™ä¸‹çš„ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'read_diary',
                name: 'é˜…è¯»æ—¥è®°',
                desc: 'äº†è§£ç¬¬7å°é˜Ÿçš„é­é‡',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'æ—¥è®°è®°è½½ï¼š"11æœˆ14æ—¥ï¼šæ‰¾åˆ°æ·±æ¸Šå…¥å£ã€‚11æœˆ15æ—¥ï¼šæ‰¾åˆ°åŸƒå¾·è’™ä¸»æ•™ï¼Œä»–è¯´æ·±æ¸Šæ˜¯å±éšœè€Œéå¨èƒã€‚11æœˆ16æ—¥ï¼šä»–è¯´éœ€è¦3ä¸ªåª’ä»‹å®Œæˆå®ˆé—¨äººä»ªå¼ã€‚æˆ‘ä»¬å¿…é¡»é˜»æ­¢ä»–ï¼Œå³ä½¿...ä»£ä»·æ˜¯æˆ‘æ— æ³•æ‰¿å—çš„ã€‚"', san: 10, clue: 'å®ˆé—¨äººä»ªå¼' }
                }
            },
            {
                id: 'take_diary',
                name: 'å¸¦èµ°æ—¥è®°',
                desc: 'ä½œä¸ºè¯æ®',
                cost: 0,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ åˆä¸Šæ—¥è®°ï¼Œå°å¿ƒåœ°æ”¶å¥½ã€‚è¿™æ˜¯é©¬åº“æ–¯ç•™ä¸‹çš„æœ€åè®°å½•ã€‚', item: 'é©¬åº“æ–¯æ—¥è®°' }
                }
            },
            {
                id: 'burn_diary',
                name: 'çƒ§æ¯æ—¥è®°',
                desc: 'è®©ç§˜å¯†éšç«ç„°æ¶ˆé€',
                cost: 0,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ ç‚¹ç‡ƒæ—¥è®°ï¼Œçœ‹ç€ç«ç„°åå™¬é©¬åº“æ–¯çš„å­—è¿¹ã€‚ä½†åœ¨æœ€åä¸€é¡µçƒ§æ¯å‰ï¼Œä½ ç¥è§ä¸€å¥è¯ï¼š"å¦‚æœçœ‹åˆ°è¿™æœ¬æ—¥è®°ï¼Œå»æ•‘è‰¾ç³å¨œâ€”â€”å¥¹åœ¨æ·±æ¸Šè¾¹ç¼˜ã€‚"', san: 15, clue: 'è‰¾ç³å¨œå­˜æ´»' }
                }
            }
        ]
    },
    'camp_lamp': {
        id: 'camp_lamp',
        name: 'ç‡ƒçƒ§çš„ç¯',
        type: 'story',
        icon: 'ğŸª”',
        desc: 'ä¸€ç›ä»åœ¨ç‡ƒçƒ§çš„ç…¤æ²¹ç¯ï¼Œåœ¨æ­»å¯‚çš„æ´å®¤ä¸­å‘å‡ºè¯¡å¼‚çš„å¾®å…‰ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'investigate_lamp',
                name: 'æ£€æŸ¥å¼‚å¸¸',
                desc: 'ç¥ç§˜å­¦åˆ¤å®š',
                cost: 1,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 35 },
                results: {
                    fumble: { text: 'ä½ é è¿‘æ²¹ç¯æ—¶ï¼Œç«ç„°çªç„¶å˜æˆç»¿è‰²ï¼Œä¸€ä¸ªå£°éŸ³åœ¨ä½ è„‘æµ·ä¸­ä½è¯­ï¼š"ç•™ä¸‹...æˆä¸ºä¸€éƒ¨åˆ†..."ä½ å°–å«ç€åé€€ã€‚', san: 20 },
                    fail: { text: 'æ²¹ç¯çœ‹èµ·æ¥å¾ˆæ­£å¸¸ï¼Œåªæ˜¯ç‡ƒçƒ§çš„æ—¶é—´é•¿å¾—ä¸æ­£å¸¸ã€‚', san: 5 },
                    success: { text: 'ä½ æ³¨æ„åˆ°æ²¹ç¯çš„ç‡ƒæ–™ä¸æ˜¯æ™®é€šçš„ç…¤æ²¹â€”â€”å®ƒæ··åˆäº†æŸç§...è¡€æ¶²ï¼Ÿè¿™æ˜¯æŸç§"é•¿æ˜ç¯"ä»ªå¼ã€‚', san: 8, clue: 'è¡€ç¥­ç‡ƒæ–™' },
                    crit: { text: 'ä½ ä¸ä»…å‘ç°äº†è¡€ç¥­ç‡ƒæ–™ï¼Œè¿˜çœ‹å‡ºç¯èŠ¯çš„ç¼–ç»‡æ–¹å¼â€”â€”é‚£æ˜¯ç”¨äººçš„å¤´å‘ç¼–æˆçš„ã€‚è¿™æ˜¯å›šç¦çµé­‚çš„å¤è€ä»ªå¼ï¼Œç¯é‡Œå›°ç€ä¸€ä¸ªäººã€‚', clue: 'çµé­‚å›šç¦' }
                }
            }
        ]
    },
    
    // ========== 5.5 ä½è¯­å›å»Š (whisper) ==========
    'wall_whisper': {
        id: 'wall_whisper',
        name: 'å¢™ä¸­ä½è¯­',
        type: 'info',
        icon: 'ğŸ‘‚',
        desc: 'å¢™å£ä¼¼ä¹åœ¨...è¯´è¯ï¼Ÿä½ å¬åˆ°æ¨¡ç³Šçš„å£°éŸ³ä»å²©çŸ³ä¸­ä¼ å‡ºï¼Œåƒæ˜¯åœ¨è¯±å¯¼ä½ â€”â€”"æ¥å§...çœ‹çœ‹çœŸç›¸..."',
        visible: 'always',
        actions: [
            {
                id: 'listen_whisper',
                name: 'è†å¬ä½è¯­',
                desc: 'ç¥ç§˜å­¦åˆ¤å®šç†è§£å†…å®¹',
                cost: 1,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 30 },
                results: {
                    fumble: { text: 'ä½ ä¸“æ³¨äºä½è¯­ï¼Œå´å¬åˆ°å®ƒç›´æ¥åœ¨ä½ è„‘æµ·ä¸­å“èµ·ã€‚é‚£äº›å£°éŸ³åœ¨è¯´ä½ çš„åå­—...å®ƒä»¬çŸ¥é“ä½ æ˜¯è°...', san: 15 },
                    fail: { text: 'ä½è¯­å¤ªæ¨¡ç³Šäº†ï¼Œä½ åªèƒ½æ•æ‰åˆ°ä¸€äº›é›¶ç¢çš„è¯è¯­ï¼Œæ— æ³•ç†è§£å®Œæ•´çš„æ„æ€ã€‚', san: 5 },
                    success: { text: 'ä½ å‹‰å¼ºå¬æ¸…äº†ä½è¯­çš„å†…å®¹ï¼š"å®ˆé—¨äººå¿…é¡»è‡ªæ„¿...è‰¾ç³å¨œ...å›°åœ¨è¾¹ç¼˜..."è¿™æ˜¯æŸç§è­¦å‘Šï¼Ÿ', clue: 'ä½è¯­è­¦å‘Š' },
                    crit: { text: 'ä½ ä¸ä»…å¬æ¸…äº†ä½è¯­ï¼Œè¿˜è¾¨è®¤å‡ºå£°éŸ³çš„æ¥æºâ€”â€”é‚£æ˜¯é©¬åº“æ–¯çš„å£°éŸ³ï¼ä»–åœ¨é‡å¤ï¼š"ä¸è¦ç›¸ä¿¡ä¸»æ•™...å»æ·±æ¸Šè¾¹ç¼˜...æ•‘å¥¹..."', clue: 'é©¬åº“æ–¯æ±‚æ•‘' }
                }
            },
            {
                id: 'ignore_whisper',
                name: 'æ‚ä½è€³æœµ',
                desc: 'æ‹’ç»è†å¬',
                cost: 0,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ æ‚ä½è€³æœµï¼Œå¿«æ­¥é€šè¿‡è¿™æ®µé€šé“ã€‚ä½è¯­æ¸æ¸æ¶ˆå¤±ï¼Œä½†ä½ çš„å¿ƒè·³ä»ç„¶å¾ˆå¿«ã€‚', san: 0 }
                }
            }
        ]
    },
    'water_drops': {
        id: 'water_drops',
        name: 'æ¸—æ°´çš„å¢™å£',
        type: 'info',
        icon: 'ğŸ’§',
        desc: 'å²©å£ä¸Šä¸æ–­æ¸—å‡ºæ°´ç ï¼Œåœ¨åœ°é¢å½¢æˆä¸€æ»©ç§¯æ°´ã€‚æ°´å¾ˆæ¸…æ¾ˆï¼Œä½†å¸¦ç€ä¸€è‚¡é“é”ˆå‘³ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'check_water',
                name: 'æ£€æŸ¥ç§¯æ°´',
                desc: 'ä¾¦æŸ¥åˆ¤å®šå¯»æ‰¾å¼‚å¸¸',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 35 },
                results: {
                    fumble: { text: 'ä½ è¹²ä¸‹æ£€æŸ¥æ—¶ï¼Œæ°´é¢çªç„¶æ³›èµ·æ¶Ÿæ¼ª...ä½ çœ‹åˆ°äº†è‡ªå·±çš„å€’å½±ï¼Œä½†é‚£å€’å½±åœ¨ç¬‘...è€Œä½ å¹¶æ²¡æœ‰ç¬‘...', san: 12 },
                    fail: { text: 'æ°´çœ‹èµ·æ¥å¾ˆæ­£å¸¸ï¼Œåªæ˜¯å¸¦ç€çŸ¿äº•å¸¸è§çš„é“é”ˆå‘³ã€‚' },
                    success: { text: 'ä½ å‘ç°æ°´ä¸­æ··æ‚ç€å¾®é‡çš„é»‘è‰²é¢—ç²’ï¼Œé‚£æ˜¯æ·±æ¸Šèƒ½é‡çš„æ®‹ç•™ã€‚è¿™é‡Œç¦»è£‚éš™ä¸è¿œäº†ã€‚', clue: 'æ·±æ¸Šæ¥è¿‘' },
                    crit: { text: 'ä½ æ³¨æ„åˆ°æ°´é¢çš„å€’å½±æœ‰äº›å»¶è¿Ÿâ€”â€”å½“ä½ çš„æ‰‹å·²ç»æ”¶å›æ—¶ï¼Œå€’å½±çš„æ‰‹è¿˜åœç•™åœ¨æ°´é¢ä¸Šã€‚è¿™é‡Œçš„ç°å®æ­£åœ¨æ‰­æ›²ã€‚', clue: 'ç°å®æ‰­æ›²' }
                }
            }
        ]
    },
    'shadow_corner': {
        id: 'shadow_corner',
        name: 'è§’è½çš„é˜´å½±',
        type: 'story',
        icon: 'ğŸ‘¤',
        desc: 'é€šé“æ‹è§’å¤„çš„é˜´å½±æ¯”å‘¨å›´æ›´æµ“ï¼Œä»¿ä½›æœ‰ä»€ä¹ˆä¸œè¥¿è—åœ¨é‚£é‡Œã€‚',
        visible: 'always',
        actions: [
            {
                id: 'approach_shadow',
                name: 'é è¿‘æŸ¥çœ‹',
                desc: 'å‹‡æ°”è€ƒéªŒï¼ˆè‡ªåŠ¨ï¼‰',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ é¼“èµ·å‹‡æ°”èµ°è¿‘é˜´å½±...å´å‘ç°é‚£åªæ˜¯ä¸€å—å½¢çŠ¶å¥‡ç‰¹çš„å²©çŸ³ã€‚ä½†å½“ä½ è½¬èº«ç¦»å¼€æ—¶ï¼Œä½ ç¡®ä¿¡å¬åˆ°äº†ä¸€å£°å¹æ¯ã€‚', san: 5 }
                }
            }
        ]
    },
    'exit_whisper': {
        id: 'exit_whisper',
        name: 'ç¦»å¼€å›å»Š',
        type: 'exit',
        icon: 'ğŸšª',
        desc: 'é€šé“ç»§ç»­å»¶ä¼¸ï¼Œå‰æ–¹æœ‰ä¸€ä¸ªå²”è·¯å£ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'go_fork',
                name: 'å‰å¾€çŸ¿é“åˆ†å‰',
                desc: 'ç»§ç»­å‰è¿›',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ å¿«æ­¥ç¦»å¼€è¿™æ®µè¯¡å¼‚çš„é€šé“ï¼Œä½è¯­æ¸æ¸æ¶ˆå¤±ã€‚å‰æ–¹å‡ºç°äº†ä¸€ä¸ªå²”è·¯å£...', next: 6 }
                }
            }
        ]
    },

    // v0.3 ç¤ºä¾‹å‡ºå£å¯¹è±¡
    'collapse_exit': {
        id: 'collapse_exit',
        name: 'é€šé“å‡ºå£',
        type: 'exit',
        icon: 'ğŸšª',
        desc: 'é€šå¾€ä¸‹ä¸€ä¸ªåŒºåŸŸçš„é€šé“ï¼Œä½†è¢«ç¢çŸ³éƒ¨åˆ†é˜»æŒ¡ã€‚',
        visible: 'always',
        unlockConditions: ['debris'], // éœ€è¦è§£å†³ç¢çŸ³å †éšœç¢
        actions: [
            {
                id: 'exit_room',
                name: 'é€šè¿‡é€šé“',
                desc: 'ç¦»å¼€è¿™ä¸ªåŒºåŸŸ',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ å°å¿ƒåœ°é€šè¿‡é€šé“ï¼Œå‰å¾€ä¸‹ä¸€ä¸ªåŒºåŸŸã€‚' }
                }
            }
        ]
    },

    // ========== 6. çŸ¿é“åˆ†å‰ (fork) - åˆ†æ”¯é€‰æ‹© ==========
    'upper_path': {
        id: 'upper_path',
        name: 'ä¸Šè·¯ç«å…‰',
        type: 'info',
        icon: 'ğŸ”¥',
        desc: 'å·¦è¾¹çš„é€šé“å°½å¤´æœ‰å¾®å¼±çš„ç«å…‰é—ªçƒï¼Œåœ¨æ½®æ¹¿çš„å²©å£ä¸ŠæŠ•ä¸‹è¯¡å¼‚çš„å½±å­ã€‚éšçº¦èƒ½å¬åˆ°ä½æ²‰çš„äººå£°ï¼Œåƒæ˜¯æŸç§è¯µç»æˆ–ä»ªå¼ã€‚ç«å…‰çš„é¢œè‰²ä¸å¤ªæ­£å¸¸ï¼Œå¸¦ç€æ·¡æ·¡çš„ç»¿è‰²è°ƒï¼Œè¿™å¯èƒ½æ˜¯æŸç§ç‰¹æ®Šçš„ç‡ƒæ–™ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'scout_upper',
                name: 'ä¾¦æŸ¥ä¸Šè·¯',
                desc: 'ä¾¦æŸ¥åˆ¤å®šè§‚å¯Ÿæƒ…å†µï¼ˆè€ƒå¤å­¦å®¶ä¼˜åŠ¿+10%ï¼‰',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 40 },
                results: {
                    fumble: { text: 'ä½ æ¢å¤´æŸ¥çœ‹æ—¶ï¼Œè„šä¸‹çš„çŸ³å¤´æ»šè½ï¼Œå‘å‡ºæ¸…è„†çš„å“å£°ã€‚ç«å…‰å¤„çš„äººå£°çªç„¶åœæ­¢äº†ï¼Œç´§æ¥ç€æ˜¯æ­»ä¸€èˆ¬çš„å¯‚é™ã€‚ä½ æ„Ÿåˆ°å¤šåŒçœ¼ç›æ­£åœ¨é»‘æš—ä¸­æ³¨è§†ç€ä½ ï¼ŒæŸç§è¢«çŒé£Ÿè€…ç›¯ä¸Šçš„æœ¬èƒ½ææƒ§æ¶Œä¸Šå¿ƒå¤´ã€‚', san: 10 },
                    fail: { text: 'è·ç¦»å¤ªè¿œï¼Œç«å…‰æ‘‡æ›³ä¸å®šï¼Œä½ åªèƒ½çœ‹åˆ°æ¨¡ç³Šçš„äººå½±è½®å»“ï¼Œæ— æ³•ç¡®å®šå…·ä½“äººæ•°ã€‚äººå£°æ–­æ–­ç»­ç»­ï¼Œä½ å¬ä¸æ¸…ä»–ä»¬åœ¨è¯´ä»€ä¹ˆï¼Œä½†èƒ½æ„Ÿå—åˆ°é‚£ç§ç‹‚çƒ­çš„è¯­è°ƒã€‚æƒ…æŠ¥ä¸è¶³ï¼Œä½ æ— æ³•åˆ¤æ–­ä¸Šè·¯æ˜¯å¦å®‰å…¨ã€‚' },
                    success: { text: 'ä½ ä»”ç»†è§‚å¯Ÿï¼Œè¾¨è®¤å‡ºé‚£æ˜¯æ•™å¯¼å…çš„æ–¹å‘ã€‚è‡³å°‘æœ‰5-6ä¸ªæ‘æ°‘å›´ååœ¨ä¸€èµ·ï¼Œä»–ä»¬çš„å§¿æ€åƒµç¡¬è€Œç»Ÿä¸€ï¼Œä¼¼ä¹åœ¨åå¤èƒŒè¯µæŸç§ç¥·è¯æˆ–å’’è¯­ã€‚ç©ºæ°”ä¸­å¼¥æ¼«ç€ä¸€ç§ç‹‚çƒ­è€Œå‹æŠ‘çš„æ°›å›´ã€‚å¦‚æœé€‰æ‹©è¿™æ¡è·¯ï¼Œä½ å¯èƒ½ä¼šè·å¾—æ›´å¤šå…³äºåŸƒå¾·è’™è®¡åˆ’çš„çŸ¥è¯†ï¼Œä½†ä¹Ÿæ„å‘³ç€æ›´å¤§çš„ç†æ™ºé£é™©ã€‚', clue: 'æ•™å¯¼å…æƒ…æŠ¥' },
                    crit: { text: 'ä½ ä¸ä»…çœ‹åˆ°äº†æ‘æ°‘ï¼Œè¿˜å‘ç°äº†ä¸€ä¸ªç©¿é»‘è¢çš„èº«å½±â€”â€”åŸƒå¾·è’™ä¸»æ•™ï¼ä»–æ­£åœ¨å‘æ‘æ°‘ä»¬è®²è§£ä»€ä¹ˆï¼Œæ‰‹åŠ¿æ¿€çƒˆï¼Œç¥æƒ…ç™«ç‹‚ã€‚æ‘æ°‘ä»¬è™”è¯šåœ°ä»°æœ›ç€ä»–ï¼Œçœ¼ä¸­é—ªçƒç€éäººçš„å…‰èŠ’ã€‚ä½ æ³¨æ„åˆ°ä»–ä»¬æ‰‹ä¸­éƒ½æ‹¿ç€æŸç§å‘å…‰çš„ç‰©ä½“ï¼Œå¯èƒ½æ˜¯æ·±æ¸Šçš„ç¢ç‰‡ã€‚å¦‚æœé€‰æ‹©ä¸Šè·¯ï¼Œä½ å°†ç›´æ¥é¢å¯¹åŸƒå¾·è’™çš„æ•™åŒ–ï¼Œè·å¾—æ›´å¤šçŸ¥è¯†ï¼Œä½†ä¹Ÿæ„å‘³ç€ç›´é¢æ·±æ¸Šçš„çœŸç›¸ã€‚', clue: 'åŸƒå¾·è’™ä½ç½®' }
                }
            }
        ]
    },
    'lower_path': {
        id: 'lower_path',
        name: 'ä¸‹è·¯èƒ½é‡',
        type: 'info',
        icon: 'âš¡',
        desc: 'å³è¾¹çš„é€šé“ä¼ æ¥ä¸ç¥¥çš„èƒ½é‡æ³¢åŠ¨ï¼Œç©ºæ°”éƒ½åœ¨å¾®å¾®éœ‡é¢¤ã€‚è¶Šé è¿‘è¿™ä¸ªæ–¹å‘ï¼Œæ¸©åº¦å°±è¶Šä½ï¼Œå‘¼å‡ºçš„æ°”æ¯å‡ç»“æˆç™½è‰²çš„é›¾æ°”ã€‚å²©å£ä¸Šå‡ºç°äº†å¥‡æ€ªçš„ç»“æ™¶ï¼Œåœ¨é»‘æš—ä¸­å‘å‡ºå¾®å¼±çš„è§å…‰ï¼Œåƒæ˜¯è¢«æŸç§åŠ›é‡ä¾µèš€çš„ç—•è¿¹ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'sense_energy',
                name: 'æ„ŸçŸ¥èƒ½é‡',
                desc: 'ç¥ç§˜å­¦åˆ¤å®šç†è§£æ³¢åŠ¨ï¼ˆç¥ç§˜å­¦è€…ä¼˜åŠ¿+10%ï¼‰',
                cost: 1,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 40 },
                results: {
                    fumble: { text: 'ä½ è¯•å›¾æ„ŸçŸ¥èƒ½é‡ï¼Œå´è¢«ä¸€è‚¡æ— å½¢çš„åŠ›é‡çŒ›çƒˆå†²å‡»ã€‚è„‘æµ·ä¸­å“èµ·åˆºè€³çš„å°–å•¸ï¼Œåƒæ˜¯åƒä¸‡ä¸ªå£°éŸ³åŒæ—¶åœ¨å°–å«ã€‚ä½ çš„è§†é‡è¾¹ç¼˜å¼€å§‹å‡ºç°é»‘è‰²çš„è£‚çº¹ï¼Œä»¿ä½›ç°å®æœ¬èº«æ­£åœ¨å´©è§£ã€‚å½“ä½ å›è¿‡ç¥æ¥ï¼Œå‘ç°è‡ªå·±å·²ç»è·ªå€’åœ¨åœ°ï¼Œé¼»è…”æµå‡ºæ¸©çƒ­çš„è¡€æ¶²ã€‚', san: 15 },
                    fail: { text: 'èƒ½é‡æ³¢åŠ¨å¾ˆå¼ºçƒˆï¼Œåƒæ˜¯ä¸€é˜µé˜µæ— å½¢çš„çƒ­æµªæ‹æ‰“åœ¨ä½ çš„çš®è‚¤ä¸Šï¼Œä½†é‚£ç§"çƒ­"æ˜¯å†°å†·çš„ã€‚ä½ åŠªåŠ›å°è¯•ç†è§£è¿™ç§èƒ½é‡çš„æ€§è´¨ï¼Œä½†å®ƒè¶…å‡ºäº†ä½ çš„è®¤çŸ¥èŒƒå›´ã€‚ä½ åªèƒ½ç¡®å®šè¿™è‚¡èƒ½é‡çš„æºå¤´å°±åœ¨é€šé“æ·±å¤„ï¼Œè€Œä¸”å®ƒæ­£åœ¨é€æ¸å¢å¼ºã€‚', san: 5 },
                    success: { text: 'ä½ æ„Ÿå—åˆ°é‚£æ˜¯æ·±æ¸Šè£‚éš™çš„è¾¹ç¼˜ï¼Œèƒ½é‡ä¸ç¨³å®šä½†å¯ä»¥è¢«åˆ©ç”¨ã€‚è¿™è‚¡èƒ½é‡å¸¦ç€æŸç§"é¥¥é¥¿"çš„ç‰¹è´¨ï¼Œåƒæ˜¯æ´»ç‰©åœ¨å‘¼å¸ã€‚ä½ æ„è¯†åˆ°é‚£é‡Œå¯èƒ½ä¿å­˜ç€ç¬¬7å°é˜Ÿç•™ä¸‹çš„çº¿ç´¢ï¼Œç”šè‡³æ˜¯å¹¸å­˜è€…çš„è¸ªè¿¹ã€‚ä½†åŒæ—¶ï¼Œè¿™ç§æ¥è¿‘æ·±æ¸Šçš„è¡Œä¸ºæ„å‘³ç€æ›´å¤§çš„èº«ä½“é£é™©ã€‚é€‰æ‹©ä¸‹è·¯ï¼Œä½ å¯èƒ½ä¼šæ‰¾åˆ°é©¬åº“æ–¯æˆ–å…¶ä»–é˜Ÿå‘˜ï¼Œä½†è¦åšå¥½æˆ˜æ–—å‡†å¤‡ã€‚', clue: 'æ·±æ¸Šè¾¹ç¼˜æƒ…æŠ¥' },
                    crit: { text: 'ä½ ä¸ä»…æ„ŸçŸ¥åˆ°èƒ½é‡ï¼Œè¿˜å¯Ÿè§‰åˆ°å…¶ä¸­å¤¹æ‚ç€...äººç±»çš„æ„è¯†ï¼Ÿé‚£æ˜¯ä¸€ä¸ªç—›è‹¦è€ŒåšéŸ§çš„çµé­‚ï¼Œåœ¨æ·±æ¸Šè¾¹ç¼˜æŒ£æ‰ç€ä¿æŒæ¸…é†’ã€‚æœ‰äººåœ¨æ·±æ¸Šè¾¹ç¼˜ï¼Œè€Œä¸”è¿˜æ´»ç€ï¼ä½ æ„Ÿå—åˆ°é‚£ä¸ªå­˜åœ¨æ­£åœ¨è¯•å›¾ä¸ä½ å»ºç«‹è”ç³»ï¼Œä¼ é€’æŸç§ä¿¡æ¯ã€‚è¿™æ˜¯ä¸€ä¸ªæƒŠäººçš„å‘ç°â€”â€”ç¬¬7å°é˜Ÿå¯èƒ½è¿˜æœ‰å¹¸å­˜è€…ï¼å¦‚æœé€‰æ‹©ä¸‹è·¯ï¼Œä½ å°†æœ‰æœºä¼šæ‰¾åˆ°å¹¶æ‹¯æ•‘è¿™ä¸ªäººï¼Œä½†æ·±æ¸Šçš„åŠ›é‡ä¼šå¯¹ä½ çš„èº«ä½“é€ æˆç›´æ¥å¨èƒã€‚', clue: 'æ·±æ¸Šå¹¸å­˜è€…' }
                }
            }
        ]
    },
    'middle_sign': {
        id: 'middle_sign',
        name: 'ä¸­é—´æ ‡è®°',
        type: 'info',
        icon: 'ğŸ—ºï¸',
        desc: 'å²”è·¯å£ä¸­å¤®çš„çŸ³æŸ±ä¸Šåˆ»ç€å¤è€çš„æ ‡è®°ï¼Œä¼¼ä¹æ˜¯æŸç§æŒ‡ç¤ºç‰Œã€‚çŸ³æŸ±è¡¨é¢é£åŒ–ä¸¥é‡ï¼Œä½†æ ¸å¿ƒçš„ç¬¦å·ä»ç„¶æ¸…æ™°å¯è¾¨ã€‚æ ‡è®°ä½¿ç”¨çš„é¢œæ–™ä¸­æ··æ‚ç€æŸç§å‘å…‰çš„çŸ¿ç‰©è´¨ï¼Œåœ¨æ‰‹ç”µç­’çš„å…‰ç…§ä¸‹å¾®å¾®é—ªçƒã€‚',
        visible: 'always',
        actions: [
            {
                id: 'read_sign',
                name: 'è§£è¯»æ ‡è®°',
                desc: 'è€ƒå¤å­¦ä¸“é•¿åˆ¤å®šï¼ˆè€ƒå¤å­¦å®¶å¿…æˆåŠŸï¼‰',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 30 },
                results: {
                    fumble: { text: 'ä½ è¯•å›¾è§£è¯»æ ‡è®°æ—¶ï¼Œæ‰‹æŒ‡ä¸å°å¿ƒåˆ’è¿‡ä¸€é“æ·±æ·±çš„åˆ»ç—•ã€‚çªç„¶ï¼Œä½ çš„è„‘æµ·ä¸­å“èµ·äº†ä¸€ä¸ªå¤è€çš„å£°éŸ³ï¼Œç”¨ä¸€ç§ä½ æ— æ³•ç†è§£çš„è¯­è¨€ä½è¯­ç€ä»€ä¹ˆã€‚ä½ æ„Ÿåˆ°å¤´æ™•ç›®çœ©ï¼ŒæŸç§çŸ¥è¯†æ­£åœ¨å¼ºè¡Œæ¶Œå…¥ä½ çš„å¤§è„‘ï¼Œä½†ä½ çš„æ„è¯†æ— æ³•æ‰¿å—ã€‚', san: 12 },
                    fail: { text: 'æ ‡è®°å·²ç»é£åŒ–ä¸¥é‡ï¼ŒåŠ ä¸Šä½ ä¸ç†Ÿæ‚‰å¤ä»£ç¬¦å·ç³»ç»Ÿï¼Œåªèƒ½è¾¨è®¤å‡ºä¸€äº›é›¶æ•£çš„å›¾æ¡ˆã€‚ä½ çœ‹åˆ°å·¦è¾¹ä¼¼ä¹ä»£è¡¨ç€æŸç§"èšé›†"æˆ–"å­¦ä¹ "çš„æ¦‚å¿µï¼Œå³è¾¹åˆ™ä¸"æ·±æ¸Š"æˆ–"å‡è§†"æœ‰å…³ã€‚ä½†å…·ä½“å«ä¹‰ä»ç„¶æ¨¡ç³Šä¸æ¸…ï¼Œæ— æ³•ä¸ºä½ æä¾›æ˜ç¡®çš„é€‰æ‹©ä¾æ®ã€‚' },
                    success: { text: 'ä½ è®¤å‡ºè¿™æ˜¯å¤ç½—é©¬çŸ¿äº•çš„æ ‡è®°ç³»ç»Ÿï¼Œç»“åˆä½ åœ¨è€ƒå¤å­¦æ–¹é¢çš„çŸ¥è¯†ï¼ŒæˆåŠŸè§£è¯»äº†ä¸»è¦å†…å®¹ã€‚å·¦è¾¹é€šå‘"æ•™å¯¼ä¹‹æ‰€"ï¼Œé‚£æ˜¯åŸƒå¾·è’™å‘ä¿¡å¾’ä¼ æˆæ·±æ¸ŠçŸ¥è¯†çš„åœ°æ–¹ï¼›å³è¾¹é€šå‘"æ·±æ¸Šå‡è§†"ï¼Œæ˜¯çŸ¿å‘æœ€æ·±å¤„çš„è£‚éš™è¾¹ç¼˜ã€‚æ ‡è®°åº•éƒ¨è¿˜æœ‰ä¸€å¥è­¦å‘Šï¼š"çŸ¥è¯†å¸¦æ¥ç–¯ç‹‚ï¼Œå‡è§†å¸¦æ¥æ¹®ç­ã€‚"è¿™å¥è¯è®©ä½ æ„è¯†åˆ°ä¸¤æ¡è·¯éƒ½æœ‰å…¶å±é™©ï¼Œä½†æ€§è´¨ä¸åŒã€‚', clue: 'è·¯å¾„è­¦å‘Š' },
                    crit: { text: 'ä½œä¸ºè€ƒå¤å­¦å®¶ï¼Œä½ ä¸ä»…èƒ½è¯»æ‡‚æ ‡è®°çš„å­—é¢æ„æ€ï¼Œè¿˜çœ‹å‡ºäº†ç¬¦å·ä¹‹é—´çš„éšå«å…³è”ã€‚å·¦è¾¹ä»£è¡¨"æ•™å¯¼å…"ï¼Œæ˜¯åŸƒå¾·è’™è¿›è¡Œæ´—è„‘ä»ªå¼çš„åœ°æ–¹ï¼Œå»é‚£é‡Œå¯ä»¥äº†è§£æ›´å¤šå…³äºå®ˆé—¨äººä»ªå¼çš„çŸ¥è¯†ï¼Œä½†ä¼šé¢ä¸´æ›´å¤§çš„ç†æ™ºè€ƒéªŒï¼›å³è¾¹ä»£è¡¨"æ·±æ¸Šè¾¹ç¼˜"ï¼Œæ˜¯ç‰©ç†ä¸Šæœ€æ¥è¿‘æ·±æ¸Šçš„åœ°æ–¹ï¼Œå»é‚£é‡Œå¯èƒ½æ‰¾åˆ°ç¬¬7å°é˜Ÿçš„å¹¸å­˜è€…æˆ–é—ç‰©ï¼Œä½†ä¼šå¯¹èº«ä½“é€ æˆç›´æ¥ä¼¤å®³ã€‚æ ‡è®°çš„æœ€ä¸‹æ–¹ï¼Œä½ å‘ç°äº†åæ¥æ·»åŠ çš„åˆ»ç—•â€”â€”æ˜¯é©¬åº“æ–¯çš„ç¬”è¿¹ï¼š"ä¸Šè·¯å¯»çœŸç›¸ï¼Œä¸‹è·¯æ•‘ç”Ÿå‘½ã€‚â€”â€”M"', clue: 'é©¬åº“æ–¯æŒ‡å¼•' }
                }
            }
        ]
    },
    'exit_upper': {
        id: 'exit_upper',
        name: 'ä¸Šè·¯å‡ºå£',
        type: 'exit',
        icon: 'â¬†ï¸',
        desc: 'é€šå¾€æ•™å¯¼å…çš„é€šé“ï¼Œç«å…‰åœ¨å°½å¤´æ‘‡æ›³ã€‚ç©ºæ°”ä¸­é£˜è¡ç€æŸç§ incense çš„æ°”å‘³ï¼Œè®©äººæ„Ÿåˆ°æ˜æ˜æ¬²ç¡ã€‚',
        visible: 'conditional',
        unlockConditions: [{ type: 'clue', target: 'æ•™å¯¼å…æƒ…æŠ¥' }],
        lockedText: 'ğŸ”’ éœ€è¦å…ˆä¾¦æŸ¥ä¸Šè·¯æƒ…å†µ',
        unlockedText: 'âœ“ å·²äº†è§£ä¸Šè·¯æƒ…å†µ',
        actions: [
            {
                id: 'go_teaching',
                name: 'å‰å¾€æ•™å¯¼å…',
                desc: 'æ¢ç´¢ä¸Šåˆ†æ”¯',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ æ²¿ç€é€šé“å‘ç«å…‰å¤„èµ°å»ï¼Œè¯µç»å£°è¶Šæ¥è¶Šæ¸…æ™°ã€‚ç©ºæ°”ä¸­å¼¥æ¼«ç€æŸç§ incense çš„å‘³é“ï¼Œè®©ä½ çš„å¤´è„‘æœ‰äº›æ˜æ²‰ã€‚æ•™å¯¼å…å°±åœ¨å‰æ–¹...', next: 7 }
                }
            }
        ]
    },
    'exit_lower': {
        id: 'exit_lower',
        name: 'ä¸‹è·¯å‡ºå£',
        type: 'exit',
        icon: 'â¬‡ï¸',
        desc: 'é€šå¾€æ·±æ¸Šè¾¹ç¼˜çš„é€šé“ï¼Œèƒ½é‡æ³¢åŠ¨è®©äººä¸å®‰ã€‚è¶Šå¾€é‡Œèµ°ï¼Œæ¸©åº¦è¶Šä½ï¼Œå²©å£ä¸Šçš„ç»“æ™¶å‘å‡ºè¯¡å¼‚çš„è§å…‰ã€‚',
        visible: 'conditional',
        unlockConditions: [{ type: 'clue', target: 'æ·±æ¸Šè¾¹ç¼˜æƒ…æŠ¥' }],
        lockedText: 'ğŸ”’ éœ€è¦å…ˆæ„ŸçŸ¥ä¸‹è·¯èƒ½é‡',
        unlockedText: 'âœ“ å·²äº†è§£ä¸‹æƒ…æƒ…å†µ',
        actions: [
            {
                id: 'go_pit',
                name: 'å‰å¾€ç‰ºç‰²å‘é“',
                desc: 'æ¢ç´¢ä¸‹åˆ†æ”¯',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ æ²¿ç€é€šé“å‘ä¸‹èµ°å»ï¼Œæ¸©åº¦è¶Šæ¥è¶Šä½ï¼Œå²©å£ä¸Šçš„ç»“æ™¶å‘å‡ºè¯¡å¼‚çš„è§å…‰ã€‚æ·±æ¸Šçš„åŠ›é‡åœ¨å¬å”¤ç€ä½ ...', next: 9 }
                }
            }
        ]
    },

    // ========== 7. æ•™å¯¼å… (teaching) ==========
    'villagers': {
        id: 'villagers',
        name: 'ç‹‚çƒ­çš„æ‘æ°‘',
        type: 'info',
        icon: 'ğŸ‘¥',
        desc: 'å‡ ä¸ªæ‘æ°‘ååœ¨åœ°ä¸Šï¼Œçœ¼ç¥ç©ºæ´ï¼Œä¼¼ä¹åœ¨åå¤èƒŒè¯µç€ä»€ä¹ˆã€‚ä»–ä»¬çš„å§¿æ€åƒµç¡¬è€Œç»Ÿä¸€ï¼ŒåŠ¨ä½œå®Œå…¨åŒæ­¥ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'observe_villagers',
                name: 'è§‚å¯Ÿæ‘æ°‘',
                desc: 'ä¾¦æŸ¥åˆ¤å®šåˆ†æçŠ¶æ€',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 40 },
                results: {
                    fumble: { text: 'ä½ è§‚å¯Ÿæ—¶ï¼Œä¸€ä¸ªæ‘æ°‘çªç„¶è½¬å¤´çœ‹å‘ä½ ã€‚ä»–çš„çœ¼ç›å…¨æ˜¯é»‘è‰²çš„ï¼Œæ²¡æœ‰çœ¼ç™½ã€‚"ä½ ä¹Ÿæƒ³å­¦ä¹ å—ï¼Ÿ"ä»–é—®ã€‚', san: 12 },
                    fail: { text: 'æ‘æ°‘ä»¬ä¼¼ä¹åœ¨èƒŒè¯µæŸç§ç¥·è¯ï¼Œä½†ä½ å¬ä¸æ¸…å…·ä½“å†…å®¹ã€‚ä»–ä»¬å®Œå…¨æ— è§†ä½ çš„å­˜åœ¨ã€‚' },
                    success: { text: 'ä½ è§‚å¯Ÿåˆ°æ‘æ°‘ä»¬çš„å˜´å”‡åŒæ­¥å¼€åˆï¼ŒèƒŒè¯µçš„å†…å®¹æ˜¯ï¼š"æ·±æ¸Šæ˜¯é—¨ï¼Œå®ˆé—¨äººæ˜¯é’¥åŒ™ï¼Œè‡ªæ„¿è€…å°†æ°¸ç”Ÿã€‚"è¿™æ˜¯å®ˆé—¨äººä»ªå¼çš„å’’è¯­ï¼', clue: 'å®ˆé—¨äººå’’è¯­' },
                    crit: { text: 'ä½ ä¸ä»…å¬æ¸…äº†å’’è¯­ï¼Œè¿˜å‘ç°æ‘æ°‘ä»¬çš„æ‰‹è…•ä¸Šéƒ½æœ‰ç›¸åŒçš„ä¼¤ç—•â€”â€”é‚£æ˜¯è‡ªæ„¿çŒ®è¡€çš„æ ‡è®°ã€‚åŸƒå¾·è’™åœ¨ç”¨ä»–ä»¬çš„ç”Ÿå‘½åŠ›ç»´æŒæŸç§ä¸œè¥¿ã€‚', clue: 'çŒ®è¡€æ ‡è®°' }
                }
            }
        ]
    },
    'podium_notes': {
        id: 'podium_notes',
        name: 'è®²å°ä¸Šçš„ç¬”è®°',
        type: 'info',
        icon: 'ğŸ“‹',
        desc: 'è®²å°ä¸Šæ•£è½ç€ä¸€äº›æ‰‹å†™ç¬”è®°ï¼Œå­—è¿¹æ½¦è‰ä½†è¿˜èƒ½è¾¨è®¤ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'read_notes',
                name: 'é˜…è¯»ç¬”è®°',
                desc: 'è‡ªåŠ¨é˜…è¯»',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ç¬”è®°ä¸Šå†™ç€åŸƒå¾·è’™çš„æ•™å¯¼ï¼š"æ·±æ¸Šä¸æ˜¯é‚ªæ¶ï¼Œå®ƒæ˜¯å±éšœã€‚å®ˆé—¨äººçš„èŒè´£æ˜¯ç»´æŒå¹³è¡¡ï¼Œè€Œéæ¶ˆç­æ·±æ¸Šã€‚è‰¾ç³å¨œé€‰æ‹©äº†è¿™æ¡è·¯ï¼Œæˆ‘å¿…é¡»å°Šé‡å¥¹çš„é€‰æ‹©...ä½†æˆ‘å¿…é¡»æ‰¾åˆ°æ–¹æ³•å‡è½»å¥¹çš„ç—›è‹¦ã€‚"', clue: 'åŸƒå¾·è’™åŠ¨æœº' }
                }
            }
        ]
    },
    'wall_symbols': {
        id: 'wall_symbols',
        name: 'å¢™ä¸Šçš„ç¬¦å·',
        type: 'info',
        icon: 'âœï¸',
        desc: 'å¢™ä¸Šåˆ»æ»¡äº†ä½ ä¸è®¤è¯†çš„ç¬¦å·ï¼Œä½†ç¥ç§˜å­¦è€…å¯èƒ½èƒ½ç†è§£å®ƒä»¬ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'interpret_symbols',
                name: 'è§£è¯»ç¬¦å·',
                desc: 'ç¥ç§˜å­¦åˆ¤å®š',
                cost: 1,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 40 },
                results: {
                    fumble: { text: 'ä½ è¯•å›¾ç†è§£ç¬¦å·æ—¶ï¼Œå®ƒä»¬å¼€å§‹æ—‹è½¬ã€è •åŠ¨ï¼Œåƒæ˜¯æœ‰ç”Ÿå‘½çš„è§¦é¡»ã€‚ä½ æ„Ÿåˆ°ä¸€é˜µå¼ºçƒˆçš„çœ©æ™•ã€‚', san: 15 },
                    fail: { text: 'è¿™äº›ç¬¦å·å¤ªå¤è€äº†ï¼Œä½ æ— æ³•ç†è§£å®ƒä»¬çš„å«ä¹‰ã€‚' },
                    success: { text: 'ä½ è®¤å‡ºè¿™æ˜¯æè¿°å®ˆé—¨äººä»ªå¼çš„å¤è€ç¬¦æ–‡ã€‚å®ƒè¯´å®ˆé—¨äººå¿…é¡»è‡ªæ„¿ï¼Œå¦åˆ™ä»ªå¼ä¼šåå™¬æ–½æœ¯è€…ã€‚', clue: 'è‡ªæ„¿åŸåˆ™' },
                    crit: { text: 'ä½ è¯»å‡ºäº†å®Œæ•´çš„ä»ªå¼æµç¨‹ï¼šè‡ªæ„¿è€…ç«™åœ¨æ·±æ¸Šè¾¹ç¼˜ï¼Œç”¨æ„è¯†ä½œä¸ºå±éšœã€‚ä½†ç¬¦æ–‡è¿˜æåˆ°äº†ä¸€ç§"è½®æ¢"æ–¹æ³•â€”â€”ä¸¤åå®ˆé—¨äººå¯ä»¥åˆ†æ‹…è´Ÿæ‹…ï¼', clue: 'è½®æ¢æ–¹æ³•' }
                }
            }
        ]
    },
    'exit_teaching': {
        id: 'exit_teaching',
        name: 'å‰å¾€è—ä¹¦å®¤',
        type: 'exit',
        icon: 'ğŸ“š',
        desc: 'æ•™å¯¼å…æ·±å¤„æœ‰ä¸€æ‰‡é—¨ï¼Œé€šå¾€åŸƒå¾·è’™çš„ç§äººè—ä¹¦å®¤ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'go_library',
                name: 'è¿›å…¥è—ä¹¦å®¤',
                desc: 'ç»§ç»­æ¢ç´¢ä¸Šåˆ†æ”¯',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ é¿å¼€ç‹‚çƒ­çš„æ‘æ°‘ï¼Œæ‚„æ‚„æ¨å¼€äº†è—ä¹¦å®¤çš„é—¨ã€‚é‡Œé¢å †æ»¡äº†ä¹¦ç±å’Œ...ç…§ç‰‡ï¼Ÿ', next: 8 }
                }
            }
        ]
    },

    // ========== 8. è—ä¹¦å®¤ (library) ==========
    'research_papers': {
        id: 'research_papers',
        name: 'ç ”ç©¶æŠ¥å‘Š',
        type: 'info',
        icon: 'ğŸ“„',
        desc: 'å¢™ä¸Šè´´æ»¡äº†å…³äºæ·±æ¸Šèƒ½é‡çš„ç ”ç©¶æŠ¥å‘Šï¼Œè®°å½•ç€å¤§é‡çš„æ•°æ®å’Œå®éªŒç»“æœã€‚',
        visible: 'always',
        actions: [
            {
                id: 'read_papers',
                name: 'é˜…è¯»æŠ¥å‘Š',
                desc: 'è‡ªåŠ¨é˜…è¯»',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'æŠ¥å‘Šæ˜¾ç¤ºåŸƒå¾·è’™æœ€åˆæ˜¯DIAæœ€åšå®šçš„æ·±æ¸Šå°å°æ”¯æŒè€…ã€‚ä½†2å¹´å‰ç¬¬3è£‚éš™äº‹ä»¶åï¼Œä»–çš„è§‚ç‚¹å‘ç”Ÿäº†æ ¹æœ¬è½¬å˜â€”â€”ä»–å¼€å§‹ç›¸ä¿¡æ·±æ¸Šå¯ä»¥è¢«åˆ©ç”¨è€Œéå•çº¯å°å°ã€‚', clue: 'åŸƒå¾·è’™è½¬å˜' }
                }
            }
        ]
    },
    'group_photo': {
        id: 'group_photo',
        name: 'DIAåˆå½±',
        type: 'info',
        icon: 'ğŸ–¼ï¸',
        desc: 'DIAæˆç«‹åˆæœŸçš„åˆå½±ï¼Œå¹´è½»çš„åŸƒå¾·è’™ç«™åœ¨ä¸­å¤®ï¼Œç¬‘å®¹è‡ªä¿¡ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'examine_photo',
                name: 'ä»”ç»†è§‚å¯Ÿ',
                desc: 'ä¾¦æŸ¥åˆ¤å®šæ‰¾ç»†èŠ‚',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 35 },
                results: {
                    fail: { text: 'è¿™æ˜¯ä¸€å¼ æ™®é€šçš„å›¢é˜Ÿåˆå½±ï¼Œçœ‹èµ·æ¥å¤§å®¶éƒ½å¾ˆå¼€å¿ƒã€‚' },
                    success: { text: 'ä½ æ³¨æ„åˆ°ç…§ç‰‡è§’è½é‡Œæœ‰ä¸€ä¸ªå¹´è½»å¥³å­ï¼Œå¥¹å’ŒåŸƒå¾·è’™ç«™å¾—å¾ˆè¿‘ï¼Œä¸¤äººæ‰‹ç‰µç€æ‰‹ã€‚é‚£åº”è¯¥æ˜¯è‰¾ç³å¨œã€‚', clue: 'ç…§ç‰‡çº¿ç´¢' },
                    crit: { text: 'ä½ ä¸ä»…çœ‹åˆ°äº†è‰¾ç³å¨œï¼Œè¿˜å‘ç°ç…§ç‰‡èƒŒé¢å†™ç€ä¸€è¡Œå­—ï¼š"åŸƒå¾·è’™ä¸è‰¾ç³å¨œï¼Œæ·±æ¸Šç ”ç©¶ç»„ã€‚æ„¿çŸ¥è¯†ç…§äº®é»‘æš—ï¼Œæ„¿çˆ±æƒ…è¶…è¶Šææƒ§ã€‚"', clue: 'ç…§ç‰‡çº¿ç´¢' }
                }
            }
        ]
    },
    'elena_photo': {
        id: 'elena_photo',
        name: 'åŸƒå¾·è’™ä¸è‰¾ç³å¨œ',
        type: 'story',
        icon: 'ğŸ’‘',
        desc: 'åŸƒå¾·è’™å’Œä¸€ä¸ªå¹´è½»å¥³å­çš„åˆå½±ï¼ŒèƒŒæ™¯æ˜¯æŸä¸ªæ·±æ¸Šè£‚éš™ã€‚ç…§ç‰‡èƒŒé¢å†™ç€ï¼š"è‰¾ç³å¨œï¼Œæ„¿æ·±æ¸Šæ°¸è¿œå°å°ã€‚"æ—¥æœŸæ˜¯...2å¹´å‰ï¼Ÿ',
        visible: 'always',
        actions: [
            {
                id: 'check_date',
                name: 'æŸ¥çœ‹æ—¥æœŸ',
                desc: 'è‡ªåŠ¨',
                cost: 0,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ç…§ç‰‡èƒŒé¢çš„æ—¥æœŸæ˜¾ç¤ºè¿™æ˜¯2å¹´å‰æ‹æ‘„çš„â€”â€”æ­£æ˜¯è‰¾ç³å¨œ"é˜µäº¡"ä¹‹åï¼è¿™è¯´æ˜è‰¾ç³å¨œå¹¶æ²¡æœ‰æ­»ï¼Œè€Œæ˜¯è¢«å›°åœ¨äº†æ·±æ¸Šè¾¹ç¼˜ã€‚', clue: 'è‰¾ç³å¨œçœŸç›¸' }
                }
            },
            {
                id: 'take_photo',
                name: 'å¸¦èµ°ç…§ç‰‡',
                desc: 'ä½œä¸ºè¯æ®',
                cost: 0,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ å°†ç…§ç‰‡å°å¿ƒåœ°æ”¶å¥½ã€‚è¿™å¯èƒ½æ˜¯è¯´æœåŸƒå¾·è’™çš„å…³é”®è¯æ®ã€‚', item: 'ç…§ç‰‡çº¿ç´¢' }
                }
            }
        ]
    },
    'edmund_desk': {
        id: 'edmund_desk',
        name: 'åŸƒå¾·è’™çš„ä¹¦æ¡Œ',
        type: 'info',
        icon: 'ğŸ“š',
        desc: 'ä¹¦æ¡Œä¸Šå †æ»¡äº†ä¹¦ç±å’Œç¬”è®°ï¼Œè¿˜æœ‰ä¸€æ¯å·²ç»å¹²æ¶¸çš„å’–å•¡ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'search_desk',
                name: 'æœæŸ¥ä¹¦æ¡Œ',
                desc: 'ä¾¦æŸ¥åˆ¤å®š',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 40 },
                results: {
                    fumble: { text: 'ä½ ç¿»æ‰¾æ—¶ç¢°å€’äº†ä¸€ç“¶å¢¨æ°´ï¼Œé»‘è‰²çš„æ¶²ä½“æ´’æ»¡äº†æ¡Œé¢ã€‚åœ¨å¢¨æ°´ä¸‹ï¼Œä½ ä¼¼ä¹çœ‹åˆ°äº†...ä¸€å¼ è„¸ï¼Ÿ', san: 10 },
                    fail: { text: 'ä¹¦æ¡Œä¸Šå¤§å¤šæ˜¯æ™®é€šçš„ç ”ç©¶èµ„æ–™ï¼Œæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ä¸œè¥¿ã€‚' },
                    success: { text: 'ä½ åœ¨æŠ½å±‰é‡Œå‘ç°äº†ä¸€å°æœªå¯„å‡ºçš„ä¿¡ï¼š"äº²çˆ±çš„è‰¾ç³å¨œï¼Œå¦‚æœæˆ‘å¤±è´¥äº†ï¼Œè¯·è®°ä½æˆ‘æ˜¯ä¸ºäº†æ•‘ä½ ã€‚æ— è®ºå‘ç”Ÿä»€ä¹ˆï¼Œæˆ‘éƒ½çˆ±ä½ ã€‚â€”â€”åŸƒå¾·è’™"', clue: 'åŸƒå¾·è’™çš„çˆ±' },
                    crit: { text: 'ä½ ä¸ä»…æ‰¾åˆ°äº†ä¿¡ï¼Œè¿˜åœ¨æš—æ ¼é‡Œå‘ç°äº†ä¸€ä»½å®éªŒè®°å½•â€”â€”åŸƒå¾·è’™æ­£åœ¨ç ”ç©¶å¦‚ä½•å®‰å…¨åœ°æ›¿æ¢å®ˆé—¨äººï¼Œè€Œä¸ä¼¤å®³è‰¾ç³å¨œçš„æ„è¯†ã€‚ä»–ä¸æ˜¯åœ¨ç–¯ï¼Œä»–æ˜¯åœ¨ç»æœ›åœ°å¯»æ‰¾æ•‘å¦»å­çš„æ–¹æ³•ã€‚', clue: 'æ‹¯æ•‘è®¡åˆ’' }
                }
            }
        ]
    },
    'exit_library': {
        id: 'exit_library',
        name: 'å‰å¾€ä»ªå¼å¤§å…',
        type: 'exit',
        icon: 'ğŸ”®',
        desc: 'è—ä¹¦å®¤çš„å¯†é“é€šå‘ä»ªå¼å¤§å…ï¼ŒåŸƒå¾·è’™å°±åœ¨é‚£é‡Œã€‚',
        visible: 'always',
        actions: [
            {
                id: 'go_ritual_upper',
                name: 'å‰å¾€æœ€ç»ˆå†³æˆ˜',
                desc: 'ä¸Šåˆ†æ”¯æ±‡åˆç‚¹',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ å¸¦ç€ä»è—ä¹¦å®¤è·å¾—çš„çŸ¥è¯†å’Œè¯æ®ï¼Œèµ°å‘æœ€ç»ˆå†³æˆ˜...', next: 11 }
                }
            }
        ]
    },

    // ========== 9. ç‰ºç‰²å‘é“ (pit) ==========
    'surgery_table': {
        id: 'surgery_table',
        name: 'æ‰‹æœ¯å°',
        type: 'info',
        icon: 'ğŸ¥',
        desc: 'ä¸€ä¸ªç®€é™‹çš„æ‰‹æœ¯å°ï¼Œä¸Šé¢æ®‹ç•™ç€æš—è¤è‰²çš„è¡€è¿¹ã€‚è¿™æ˜¯åŸƒå¾·è’™"ç­›é€‰"æ‘æ°‘çš„åœ°æ–¹ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'examine_table',
                name: 'æ£€æŸ¥æ‰‹æœ¯å°',
                desc: 'ä¾¦æŸ¥åˆ¤å®š',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 40 },
                results: {
                    fumble: { text: 'ä½ æ£€æŸ¥æ—¶å‘ç°æ‰‹æœ¯å°ä¸‹è—ç€ä¸€ä¸ªäººï¼ä»–çŒ›åœ°æ‰‘å‘ä½ ï¼Œç–¯ç‹‚åœ°å¤§å–Šï¼š"çº¯åº¦ï¼çº¯åº¦ä¸å¤Ÿï¼"', san: 15, hp: -10 },
                    fail: { text: 'è¡€è¿¹å·²ç»å¹²æ¶¸ï¼Œæ— æ³•åˆ¤æ–­è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆã€‚' },
                    success: { text: 'ä½ åœ¨æ‰‹æœ¯å°è¾¹ç¼˜å‘ç°äº†ä¸€äº›åˆ»ç—•â€”â€”é‚£æ˜¯å—å®³è€…ç•™ä¸‹çš„è®¡æ•°ã€‚è‡³å°‘æœ‰12ä¸ªäººåœ¨è¿™é‡Œè¢«...å¤„ç†ã€‚', san: 5, clue: 'å—å®³è€…æ•°é‡' },
                    crit: { text: 'ä½ ä¸ä»…å‘ç°äº†è®¡æ•°ï¼Œè¿˜åœ¨æ‰‹æœ¯å°ä¸‹æ–¹æ‰¾åˆ°äº†ä¸€ä¸ªéšè—çš„åŒ»ç–—æ—¥å¿—ã€‚åŸƒå¾·è’™åœ¨è®°å½•æ¯ä¸ªäººçš„"çº¯åº¦"â€”â€”åªæœ‰é«˜çº¯åº¦çš„äººæ‰èƒ½å‚ä¸ä»ªå¼ï¼Œå…¶ä»–äººè¢«...åºŸå¼ƒã€‚', clue: 'çº¯åº¦æµ‹è¯•' }
                }
            }
        ]
    },
    'mad_villager': {
        id: 'mad_villager',
        name: 'ç–¯ç‹‚çš„æ‘æ°‘',
        type: 'story',
        icon: 'ğŸ˜°',
        desc: 'ä¸€ä¸ªåŠç–¯çš„æ‘æ°‘èœ·ç¼©åœ¨è§’è½ï¼Œçœ‹åˆ°ä½ ä»¬ï¼Œä»–éœ²å‡ºè§£è„±çš„å¾®ç¬‘ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'talk_villager',
                name: 'ä¸ä»–å¯¹è¯',
                desc: 'è‡ªåŠ¨',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'æ‘æ°‘é¢¤æŠ–ç€è¯´ï¼š"åŸƒå¾·è’™è¯´æˆ‘ä»¬ä¸çº¯å‡€ï¼Œä¸èƒ½è¢«æ·±æ¸Šæ¥å—ï¼Œæ‰€ä»¥ä»–...ç ”ç©¶æˆ‘ä»¬...æƒ³çŸ¥é“ä¸ºä»€ä¹ˆ..."ä»–æŒ‡äº†æŒ‡è‡ªå·±çš„æ‰‹è‡‚ï¼Œä¸Šé¢å¸ƒæ»¡äº†é’ˆå­”ã€‚"é‚£äº›çº¯å‡€çš„äººè¢«å¸¦åˆ°ä¸Šé¢æ•™å¯¼å…ï¼Œä¸çº¯å‡€çš„å°±...ç•™åœ¨è¿™é‡Œã€‚"', san: 5, clue: 'ç­›é€‰è¿‡ç¨‹' }
                }
            },
            {
                id: 'help_villager',
                name: 'å°è¯•æ•‘æ²»',
                desc: 'æ¶ˆè€—åŒ»ç–—ç‰©èµ„',
                cost: 0,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ ç”¨æ€¥æ•‘åŒ…ä¸ºæ‘æ°‘å¤„ç†ä¼¤å£ã€‚ä»–æ„Ÿæ¿€åœ°æŠ“ä½ä½ çš„æ‰‹ï¼š"å»æ·±æ¸Šè¾¹ç¼˜...é©¬åº“æ–¯é˜Ÿé•¿è¿˜æ´»ç€...ä»–åœ¨åšæŒ..."è¯´å®Œï¼Œä»–é—­ä¸Šäº†çœ¼ç›ã€‚', san: 3, clue: 'é©¬åº“æ–¯å­˜æ´»' }
                }
            }
        ]
    },
    'blood_trail': {
        id: 'blood_trail',
        name: 'è¡€è¿¹',
        type: 'info',
        icon: 'ğŸ©¸',
        desc: 'åœ°é¢ä¸Šæœ‰ä¸€é“æ–°é²œçš„è¡€è¿¹ï¼Œå»¶ä¼¸å‘é€šé“æ·±å¤„ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'follow_blood',
                name: 'è¿½è¸ªè¡€è¿¹',
                desc: 'ä¾¦æŸ¥åˆ¤å®š',
                cost: 1,
                roll: { type: 'skill', skill: 'ä¾¦æŸ¥', base: 35 },
                results: {
                    fail: { text: 'è¡€è¿¹æ–­æ–­ç»­ç»­ï¼Œä½ æ— æ³•ç¡®å®šæ–¹å‘ã€‚' },
                    success: { text: 'ä½ è¿½è¸ªè¡€è¿¹ï¼Œå‘ç°å®ƒé€šå‘æ·±æ¸Šè¾¹ç¼˜ã€‚çœ‹èµ·æ¥æœ‰äººå—ä¼¤åé€ƒå‘äº†é‚£é‡Œã€‚', clue: 'è¡€è¿¹æ–¹å‘' },
                    crit: { text: 'ä½ ä¸ä»…è¿½è¸ªäº†è¡€è¿¹ï¼Œè¿˜è¾¨è®¤å‡ºè¿™æ˜¯DIAåˆ¶å¼å†›é´çš„è„šå°â€”â€”æ˜¯é©¬åº“æ–¯ï¼ä»–å—ä¼¤äº†ï¼Œä½†è¿˜æ´»ç€ï¼Œæ­£åœ¨å‘æ·±æ¸Šè¾¹ç¼˜ç§»åŠ¨ã€‚', clue: 'é©¬åº“æ–¯è¸ªè¿¹' }
                }
            }
        ]
    },
    'exit_pit': {
        id: 'exit_pit',
        name: 'å‰å¾€æ·±æ¸Šè¾¹ç¼˜',
        type: 'exit',
        icon: 'âš¡',
        desc: 'é€šé“ç»§ç»­å‘ä¸‹ï¼Œèƒ½é‡æ³¢åŠ¨è¶Šæ¥è¶Šå¼ºã€‚',
        visible: 'always',
        actions: [
            {
                id: 'go_abyss',
                name: 'ç»§ç»­å‰è¿›',
                desc: 'å‰å¾€æ·±æ¸Šè¾¹ç¼˜',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ æ²¿ç€è¡€è¿¹å’Œèƒ½é‡æ³¢åŠ¨å‰è¿›ï¼Œæ¸©åº¦è¶Šæ¥è¶Šä½ã€‚æ·±æ¸Šè¾¹ç¼˜å°±åœ¨å‰æ–¹...', next: 10 }
                }
            }
        ]
    },

    // ========== 10. æ·±æ¸Šè¾¹ç¼˜ (abyss) ==========
    'abyss_rift': {
        id: 'abyss_rift',
        name: 'æ·±æ¸Šè£‚éš™',
        type: 'info',
        icon: 'ğŸŒŒ',
        desc: 'ä¸€ä¸ªå·¨å¤§çš„é»‘è‰²è£‚éš™æ‚¬æµ®åœ¨çŸ¿å‘å°½å¤´ï¼Œåƒæ˜¯ç°å®è¢«æ’•å¼€äº†ä¸€é“ä¼¤å£ã€‚å®ƒä¸æ˜¯é»‘æš—ï¼Œè€Œæ˜¯"æ— "â€”â€”å…‰ã€å£°éŸ³ã€ç”šè‡³æ—¶é—´éƒ½åœ¨é‚£é‡Œæ¶ˆå¤±ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'observe_rift',
                name: 'è§‚å¯Ÿè£‚éš™',
                desc: 'ç¥ç§˜å­¦åˆ¤å®šï¼Œé«˜é£é™©',
                cost: 1,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 45 },
                results: {
                    fumble: { text: 'ä½ å‡è§†è£‚éš™å¤ªä¹…ï¼Œæ„Ÿåˆ°æ„è¯†è¢«æ‹‰æ‰¯ã€‚ä½ çœ‹åˆ°äº†æ·±æ¸Šå†…éƒ¨â€”â€”æ— æ•°æ˜Ÿè¾°åœ¨é»‘æš—ä¸­æ—‹è½¬ï¼Œä½†å®ƒä»¬æ˜¯åå™¬å…‰çš„å­˜åœ¨ã€‚å½“ä½ å›è¿‡ç¥æ¥ï¼Œå‘ç°è‡ªå·±è·ªå€’åœ¨åœ°ï¼Œé¼»è¡€ç›´æµã€‚', san: 20 },
                    fail: { text: 'è£‚éš™è®©ä½ æ„Ÿåˆ°å¼ºçƒˆçš„ææƒ§å’Œçœ©æ™•ï¼Œä½ æ— æ³•ç›´è§†å®ƒã€‚', san: 10 },
                    success: { text: 'ä½ å¼ºè¿«è‡ªå·±è§‚å¯Ÿï¼Œå‘ç°è£‚éš™è¾¹ç¼˜æœ‰æŸç§å±éšœåœ¨ç»´æŒâ€”â€”é‚£æ˜¯è‰¾ç³å¨œçš„æ„è¯†ï¼å¥¹æ­£åœ¨ç”¨è‡ªå·±çš„å­˜åœ¨é˜»æ­¢æ·±æ¸Šæ‰©å¼ ã€‚', clue: 'è‰¾ç³å¨œå±éšœ' },
                    crit: { text: 'ä½ ä¸ä»…çœ‹åˆ°äº†å±éšœï¼Œè¿˜æ„ŸçŸ¥åˆ°è‰¾ç³å¨œçš„æ„è¯†â€”â€”å¥¹æ¸…é†’ç€ï¼Œæ„Ÿå—ç€æ¯ä¸€æ¬¡æ·±æ¸Šçš„è„‰åŠ¨ã€‚å¥¹åœ¨ç—›è‹¦ä¸­åšæŒäº†2å¹´ï¼Œåªä¸ºä¿æŠ¤å¤–é¢çš„äººã€‚å¥¹çš„æ„å¿—æ¯”åŸƒå¾·è’™æƒ³è±¡çš„æ›´å¼ºå¤§ã€‚', clue: 'è‰¾ç³å¨œæ„å¿—' }
                }
            }
        ]
    },
    'dying_marcus': {
        id: 'dying_marcus',
        name: 'æ¿’æ­»çš„é©¬åº“æ–¯',
        type: 'story',
        icon: 'ğŸ¤•',
        desc: 'é©¬åº“æ–¯é˜Ÿé•¿æµ‘èº«æ˜¯è¡€ï¼Œé åœ¨å²©å£ä¸Šã€‚çœ‹åˆ°ä½ ä»¬ï¼Œä»–éœ²å‡ºè§£è„±çš„å¾®ç¬‘ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'talk_marcus',
                name: 'ä¸é©¬åº“æ–¯å¯¹è¯',
                desc: 'è‡ªåŠ¨',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'é©¬åº“æ–¯è™šå¼±åœ°è¯´ï¼š"å¬ç€...åŸƒå¾·è’™...ä»–ä¸æ˜¯åäºº...ä»–åªæ˜¯...æƒ³æ•‘ä»–çš„å¦»å­...è‰¾ç³å¨œè¢«å›°åœ¨æ·±æ¸Šè¾¹ç¼˜2å¹´äº†...å®ˆé—¨äººå¿…é¡»è‡ªæ„¿..."ä»–ç”¨æœ€åçš„åŠ›æ°”åœ¨ä½ æ‰‹å¿ƒç”»ä¸‹ä¸€ä¸ªç¬¦å·ï¼Œ"è¿™ä¸ªç¬¦å·èƒ½ä¿æŠ¤ä½ ...å»é˜»æ­¢ä»ªå¼...ä½†ä¸è¦æ€åŸƒå¾·è’™...ç»™ä»–...ä¸€ä¸ªé€‰æ‹©..."é©¬åº“æ–¯åœæ­¢äº†å‘¼å¸ã€‚', san: 10, clue: 'ä¿æŠ¤ç¬¦å·' }
                }
            }
        ]
    },
    'protective_symbol': {
        id: 'protective_symbol',
        name: 'ä¿æŠ¤ç¬¦å·',
        type: 'info',
        icon: 'âœ‹',
        desc: 'é©¬åº“æ–¯åœ¨ä½ æ‰‹å¿ƒç”»ä¸‹çš„ç¬¦å·ï¼Œä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ï¼Œä½†æ„Ÿè§‰...æ¸©æš–ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'examine_symbol',
                name: 'æ£€æŸ¥ç¬¦å·',
                desc: 'ç¥ç§˜å­¦åˆ¤å®š',
                cost: 0,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 30 },
                results: {
                    fail: { text: 'ä½ ä¸è®¤è¯†è¿™ä¸ªç¬¦å·ï¼Œä½†å®ƒè®©ä½ æ„Ÿåˆ°å®‰å¿ƒã€‚' },
                    success: { text: 'ä½ è®¤å‡ºè¿™æ˜¯å¤è€çš„å®ˆæŠ¤ç¬¦æ–‡ï¼Œèƒ½æŠµå¾¡æ·±æ¸Šèƒ½é‡çš„ä¾µèš€ã€‚é©¬åº“æ–¯ç”¨æœ€åçš„åŠ›é‡ä¿æŠ¤äº†ä½ ã€‚', clue: 'å®ˆæŠ¤ç¬¦æ–‡' }
                }
            }
        ]
    },
    'exit_abyss': {
        id: 'exit_abyss',
        name: 'å‰å¾€ä»ªå¼å¤§å…',
        type: 'exit',
        icon: 'âš”ï¸',
        desc: 'å¸¦ç€é©¬åº“æ–¯çš„é—æ„¿ï¼Œå‰å¾€ä»ªå¼å¤§å…é˜»æ­¢åŸƒå¾·è’™ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'go_ritual_lower',
                name: 'ä¸ºé©¬åº“æ–¯æŠ¥ä»‡',
                desc: 'ä¸‹åˆ†æ”¯æ±‡åˆç‚¹',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ æ¡ç´§é©¬åº“æ–¯ç”»ä¸‹çš„ç¬¦å·ï¼Œå¸¦ç€ä»–çš„é—æ„¿ï¼Œèµ°å‘æœ€ç»ˆçš„å†³æˆ˜...', next: 11 }
                }
            }
        ]
    },

    // ========== 12. ä»ªå¼å¤§å… (ritual) - å¤šç»“å±€ ==========
    'edmund_figure': {
        id: 'edmund_figure',
        name: 'åŸƒå¾·è’™Â·å¸ƒè±å…‹ä¼å¾·',
        type: 'obstacle',
        icon: 'ğŸ‘¤',
        desc: 'åŸƒå¾·è’™ç«™åœ¨èƒ½é‡æŸ±ä¸­å¤®ï¼Œä»–çš„èº«ä½“å·²ç»å¼€å§‹ä¸æ·±æ¸ŠåŒåŒ–ã€‚ä»–çš„åŠè¾¹è„¸ä»ç„¶æ˜¯é‚£ä¸ªç†æ€§çš„DIAé¦–å¸­ç ”ç©¶å‘˜ï¼Œä½†å¦å¤–åŠè¾¹å·²ç»å˜æˆäº†ç”±é»‘æš—å’Œæ˜Ÿå…‰æ„æˆçš„éäººå½¢æ€ã€‚ä»–çš„çœ¼ç¥ä¸­æ—¢æœ‰ç–¯ç‹‚ï¼Œä¹Ÿæœ‰æ·±æ·±çš„æ‚²å“€ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'talk_edmund',
                name: 'å°è¯•å¯¹è¯',
                desc: 'åˆ©ç”¨å·²æœ‰çº¿ç´¢è¯´æœåŸƒå¾·è’™ï¼ˆéœ€è¦ç‰¹å®šçº¿ç´¢ï¼‰',
                cost: 1,
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ å‘åŸƒå¾·è’™å–Šè¯ï¼Œè¯•å›¾å”¤é†’ä»–çš„ç†æ™ºã€‚ä»–çš„éäººé‚£è¾¹è„¸å¾®å¾®é¢¤åŠ¨ï¼Œä»¿ä½›åœ¨è†å¬ã€‚' }
                }
            },
            {
                id: 'fight_edmund',
                name: 'å¼ºè¡Œé˜»æ­¢',
                desc: 'åŠ›é‡åˆ¤å®šï¼Œä¸åŸƒå¾·è’™æˆ˜æ–—',
                cost: 1,
                roll: { type: 'skill', skill: 'åŠ›é‡', base: 45 },
                results: {
                    fumble: { text: 'ä½ å†²å‘åŸƒå¾·è’™ï¼Œå´è¢«èƒ½é‡æŸ±çš„åŠ›é‡å¼¹å¼€ã€‚ä½ çš„èº«ä½“åœ¨ç©ºä¸­ç¿»è½¬ï¼Œé‡é‡æ’åœ¨å²©å£ä¸Šã€‚åŸƒå¾·è’™ç”šè‡³æ²¡æœ‰è½¬èº«ï¼Œåªæ˜¯è½»è½»æŠ¬æ‰‹ï¼Œä½ å°±æ„Ÿåˆ°å†…è„åƒæ˜¯è¢«æ— å½¢çš„åŠ›é‡æŒ¤å‹ã€‚å½“ä½ çˆ¬èµ·æ¥æ—¶ï¼Œå‘ç°è‡ªå·±åå‡ºçš„è¡€ä¸­å¸¦é»‘è‰²çš„é¢—ç²’ã€‚', san: 15, hp: -20 },
                    fail: { text: 'ä½ è¯•å›¾æ”»å‡»åŸƒå¾·è’™ï¼Œä½†ä»–èº«è¾¹çš„èƒ½é‡åœºå½¢æˆäº†ä¸€å±‚æŠ¤ç›¾ã€‚ä½ çš„æ”»å‡»è¢«å¼¹å¼€ï¼Œå†²å‡»åŠ›è®©ä½ çš„æ‰‹è‡‚å‘éº»ã€‚åŸƒå¾·è’™å¹äº†å£æ°”ï¼š"æš´åŠ›è§£å†³ä¸äº†é—®é¢˜ï¼Œå¹´è½»äººã€‚"', san: 5, hp: -10 },
                    success: { text: 'ä½ æŠ“ä½æœºä¼šå†²å‘åŸƒå¾·è’™ï¼Œåœ¨ä»–æ–½æ³•çš„é—´éš™çªç ´äº†ä»–çš„é˜²å¾¡ã€‚ä½ çš„æ”»å‡»è®©ä»–è¸‰è·„äº†ä¸€ä¸‹ï¼Œèƒ½é‡æŸ±å‡ºç°äº†çŸ­æš‚çš„æ³¢åŠ¨ã€‚åŸƒå¾·è’™è½¬è¿‡èº«æ¥ï¼Œçœ¼ä¸­çš„ç–¯ç‹‚æ¶ˆé€€äº†ä¸€äº›ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¸€ç§è§£è„±èˆ¬çš„å¹³é™ï¼š"ç»ˆäº...æœ‰äººæ¥é˜»æ­¢æˆ‘äº†..."', clue: 'æˆ˜æ–—èƒœåˆ©' },
                    crit: { text: 'ä½ ä»¥é›·éœ†ä¹‹åŠ¿å†²å‘åŸƒå¾·è’™ï¼Œç²¾å‡†åœ°æ‰¾åˆ°äº†èƒ½é‡åœºçš„è–„å¼±ç‚¹ã€‚ä½ çš„æ”»å‡»ä¸ä»…çªç ´äº†é˜²å¾¡ï¼Œè¿˜æ‰“æ–­äº†ä»–çš„æ–½æ³•ä»ªå¼ã€‚èƒ½é‡æŸ±å‰§çƒˆéœ‡é¢¤ï¼ŒåŸƒå¾·è’™è·ªå€’åœ¨åœ°ã€‚å½“ä»–æŠ¬èµ·å¤´æ—¶ï¼Œçœ¼ä¸­å·²ç»æ¢å¤äº†äººç±»çš„æ¸…æ˜ï¼š"è°¢è°¢ä½ ...è®©æˆ‘ä»ç–¯ç‹‚ä¸­è§£è„±ã€‚ä½†è‰¾ç³å¨œ...å¥¹è¿˜è¢«å›°åœ¨é‡Œé¢...è¯·æ•‘æ•‘å¥¹..."', clue: 'åŸƒå¾·è’™æ¸…é†’' }
                }
            }
        ]
    },
    'energy_column': {
        id: 'energy_column',
        name: 'æ·±æ¸Šèƒ½é‡æŸ±',
        type: 'info',
        icon: 'âš¡',
        desc: 'é»‘è‰²çš„èƒ½é‡æŸ±ä»è£‚éš™ä¸­å‡èµ·ï¼Œè¿æ¥ç€æ·±æ¸Šå’Œç°å®ä¸–ç•Œã€‚èƒ½é‡æŸ±å†…éƒ¨æœ‰ä¸€ä¸ªäººå½¢è½®å»“ï¼Œè‹¥éšè‹¥ç°ã€‚èƒ½é‡æœ¬èº«ä¼¼ä¹æœ‰ç”Ÿå‘½ï¼Œä¸æ–­è •åŠ¨ã€è†¨èƒ€ï¼Œåƒæ˜¯åœ¨å‘¼å¸ã€‚é è¿‘èƒ½é‡æŸ±ä¼šè®©äººæ„Ÿåˆ°å¼ºçƒˆçš„å‹è¿«æ„Ÿï¼Œä»¿ä½›çµé­‚éƒ½è¦è¢«å¸èµ°ã€‚',
        visible: 'always',
        actions: [
            {
                id: 'analyze_energy',
                name: 'åˆ†æèƒ½é‡ç»“æ„',
                desc: 'ç¥ç§˜å­¦åˆ¤å®šç†è§£èƒ½é‡æœ¬è´¨ï¼ˆç¥ç§˜å­¦è€…ä¼˜åŠ¿ï¼‰',
                cost: 1,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 50 },
                results: {
                    fumble: { text: 'ä½ è¯•å›¾åˆ†æèƒ½é‡ç»“æ„ï¼Œå´æ„Ÿåˆ°æ„è¯†è¢«ä¸€è‚¡å¼ºå¤§çš„åŠ›é‡æ‹‰æ‰¯ã€‚ä½ çœ‹åˆ°äº†æ·±æ¸Šçš„å†…éƒ¨â€”â€”æ— æ•°æ˜Ÿè¾°åœ¨é»‘æš—ä¸­æ—‹è½¬ï¼Œä½†å®ƒä»¬ä¸æ˜¯å‘å…‰ä½“ï¼Œè€Œæ˜¯åå™¬å…‰çš„å­˜åœ¨ã€‚å½“ä½ å›è¿‡ç¥æ¥ï¼Œå‘ç°è‡ªå·±å·²ç»è·ªå€’åœ¨åœ°ï¼Œå£ä¸­å–ƒå–ƒç€æ— æ³•ç†è§£çš„è¯­è¨€ã€‚', san: 20 },
                    fail: { text: 'èƒ½é‡æŸ±çš„ç»“æ„è¶…å‡ºäº†ä½ çš„ç†è§£èŒƒå›´ã€‚ä½ èƒ½æ„Ÿå—åˆ°å…¶ä¸­è•´å«çš„å·¨å¤§åŠ›é‡ï¼Œä½†æ— æ³•åˆ†æå…¶è¿ä½œåŸç†ã€‚å”¯ä¸€ç¡®å®šçš„æ˜¯ï¼Œè¿™è‚¡èƒ½é‡æ­£åœ¨é€æ¸å¢å¼ºï¼Œæ—¶é—´ä¸å¤šäº†ã€‚', san: 8 },
                    success: { text: 'ä½ å¼ºè¿«è‡ªå·±å†·é™åˆ†æï¼Œå‘ç°èƒ½é‡æŸ±æ˜¯ä¸€ä¸ªåŒå‘é€šé“â€”â€”å®ƒåœ¨ç»´æŒæ·±æ¸Šå°å°çš„åŒæ—¶ï¼Œä¹Ÿåœ¨æŠ½å–è‰¾ç³å¨œçš„ç”Ÿå‘½åŠ›ä½œä¸ºèƒ½é‡æºã€‚è¿™å°±æ˜¯å®ˆé—¨äººä»ªå¼çš„çœŸç›¸ï¼šç”¨ä¸€ä¸ªäººçš„çµé­‚ä½œä¸ºç¥­å“ï¼Œæ¢å–å°å°çš„ç¨³å®šã€‚ä½ æ„è¯†åˆ°ï¼Œå¦‚æœèƒ½å¤Ÿæ‰¾åˆ°æ›¿ä»£è€…ï¼Œæˆ–è€…æ‰¾åˆ°å¦ä¸€ç§èƒ½é‡æºï¼Œè‰¾ç³å¨œå°±æœ‰å¯èƒ½è¢«é‡Šæ”¾ã€‚', clue: 'å®ˆé—¨äººçœŸç›¸' },
                    crit: { text: 'ä½ çš„ç¥ç§˜å­¦çŸ¥è¯†è®©ä½ çœ‹ç©¿äº†èƒ½é‡æŸ±çš„æœ¬è´¨ã€‚è¿™ä¸ä»…æ˜¯å°å°ï¼Œæ›´æ˜¯ä¸€ä¸ªç‰¢ç¬¼â€”â€”è‰¾ç³å¨œçš„æ„è¯†è¢«å›°åœ¨æ·±æ¸Šå’Œç°å®ä¹‹é—´ï¼Œä½œä¸ºä¸¤ä¸ªä¸–ç•Œä¹‹é—´çš„"ç¼“å†²å«"ã€‚ä½ æƒŠè®¶åœ°å‘ç°ï¼Œè¿™ä¸ªä»ªå¼æœ‰ä¸€ä¸ªå¤è€çš„æ¼æ´ï¼šå¦‚æœæ›¿ä»£è€…æ˜¯è‡ªæ„¿çš„ï¼Œä»ªå¼å¯ä»¥è¿›è¡Œè½¬ç§»ã€‚è€Œä¸”ï¼Œå¦‚æœåŒæ—¶æœ‰ä¸¤åå®ˆé—¨äººï¼Œå°å°çš„åŠ›é‡ä¼šå¢å¼ºï¼Œä½†æ¯ä¸ªäººæ‰¿å—çš„è´Ÿæ‹…ä¼šå‡è½»ã€‚è¿™ä¸ºæ‹¯æ•‘è‰¾ç³å¨œæä¾›äº†å¯èƒ½æ€§ï¼', clue: 'è‰¾ç³å¨œçœŸç›¸' }
                }
            }
        ]
    },
    'elenia_figure': {
        id: 'elenia_figure',
        name: 'è‰¾ç³å¨œÂ·å¸ƒè±å…‹ä¼å¾·',
        type: 'story',
        icon: 'ğŸ‘»',
        desc: 'è‰¾ç³å¨œæ¼‚æµ®åœ¨èƒ½é‡æŸ±ä¸­ï¼Œå¥¹çš„èº«ä½“åŠé€æ˜ï¼Œä»¿ä½›å¤„äºç°å®å’Œè™šå¹»ä¹‹é—´ã€‚å¥¹çš„é¢å®¹å®‰è¯¦ï¼Œåƒæ˜¯åœ¨æ²‰ç¡ï¼Œä½†å¶å°”çœ‰å¤´ä¼šå¾®å¾®çš±èµ·ï¼Œæ˜¾ç¤ºå‡ºå¥¹ä»åœ¨ä¸æ·±æ¸Šçš„åŠ›é‡æŠ—äº‰ã€‚å¥¹çš„å˜´å”‡å¶å°”ç¿•åŠ¨ï¼Œä¼¼ä¹åœ¨è¯´ä»€ä¹ˆï¼Œä½†å£°éŸ³æ— æ³•ç©¿é€èƒ½é‡å±éšœã€‚',
        visible: 'conditional',
        unlockConditions: [{ type: 'clue', target: 'è‰¾ç³å¨œçœŸç›¸' }],
        actions: [
            {
                id: 'listen_elenia',
                name: 'è†å¬ä½è¯­',
                desc: 'å°è¯•ç†è§£è‰¾ç³å¨œçš„ä¿¡æ¯',
                cost: 1,
                roll: { type: 'skill', skill: 'ç¥ç§˜å­¦', base: 40 },
                results: {
                    fumble: { text: 'ä½ è¯•å›¾è†å¬è‰¾ç³å¨œçš„å£°éŸ³ï¼Œå´å¬åˆ°äº†æ·±æ¸Šçš„å›åº”ã€‚æ— æ•°å£°éŸ³åœ¨ä½ è„‘æµ·ä¸­åŒæ—¶å“èµ·ï¼Œå®ƒä»¬åœ¨å°–å«ã€å“€åšã€ç‹‚ç¬‘ã€‚ä½ æ‚ä½è€³æœµï¼Œä½†é‚£äº›å£°éŸ³ç›´æ¥åœ¨ä½ çš„å¤§è„‘ä¸­å›è¡ã€‚å½“ä½ ç»ˆäºæ¢å¤æ¸…é†’æ—¶ï¼Œå‘ç°è‡ªå·±å·²ç»åœ¨åœ°ä¸Šèœ·ç¼©äº†ä¸çŸ¥å¤šä¹…ã€‚', san: 15 },
                    fail: { text: 'ä½ åŠªåŠ›è†å¬ï¼Œä½†åªèƒ½æ•æ‰åˆ°åªè¨€ç‰‡è¯­ã€‚è‰¾ç³å¨œçš„å£°éŸ³å¤ªå¾®å¼±äº†ï¼Œè¢«èƒ½é‡æŸ±çš„è½°é¸£å£°æ·¹æ²¡ã€‚ä½ éšçº¦å¬åˆ°"ä¸è¦..."å’Œ"æ•‘..."ï¼Œä½†æ— æ³•ç¡®å®šå®Œæ•´çš„æ„æ€ã€‚' },
                    success: { text: 'ä½ é™ä¸‹å¿ƒæ¥ï¼Œå±è”½äº†å‘¨å›´çš„å¹²æ‰°ï¼Œç»ˆäºå¬æ¸…äº†è‰¾ç³å¨œçš„è¯ï¼š"ä¸è¦...è´£æ€ªåŸƒå¾·è’™...ä»–åªæ˜¯æƒ³æ•‘æˆ‘...ä½†è¿™ä¸ªæ–¹æ³•é”™äº†...æ·±æ¸Š...ä¸èƒ½è¢«æ§åˆ¶...åªèƒ½è¢«...å¹³è¡¡..."å¥¹çš„å£°éŸ³æ–­æ–­ç»­ç»­ï¼Œä½†ä¼ é€’äº†ä¸€ä¸ªé‡è¦çš„ä¿¡æ¯ï¼šåŸƒå¾·è’™çš„åˆè¡·æ˜¯çˆ±ï¼Œè€Œä¸æ˜¯é‚ªæ¶ã€‚', clue: 'è‰¾ç³å¨œçš„é—è¨€' },
                    crit: { text: 'ä½ ä¸ä»…å¬æ¸…äº†è‰¾ç³å¨œçš„è¯ï¼Œè¿˜æ„Ÿå—åˆ°äº†å¥¹çš„æƒ…æ„Ÿâ€”â€”å¥¹å¯¹åŸƒå¾·è’™çš„çˆ±ï¼Œå¯¹æ·±æ¸Šçš„ææƒ§ï¼Œä»¥åŠä¸€ç§è¶…è¶Šä¸ªäººçš„è´£ä»»æ„Ÿã€‚å¥¹è¯´ï¼š"å‘Šè¯‰åŸƒå¾·è’™...æˆ‘çˆ±ä»–...ä½†è®©ä»–æ”¾æ‰‹...å®ˆé—¨äººå¿…é¡»è‡ªæ„¿ï¼Œä½†ä¸æ˜¯å¿…é¡»ç‰ºç‰²...æ‰¾åˆ°...ç¬¬ä¸‰ä¸ªé€‰æ‹©..."å¥¹çš„çœ¼ç›çªç„¶çå¼€ï¼Œç›´è§†ç€ä½ ï¼Œé‚£åŒçœ¼ç›é‡Œè•´å«ç€è¶…è¶Šäººç±»ç†è§£çš„æ™ºæ…§ã€‚', clue: 'è‰¾ç³å¨œçš„æ™ºæ…§' }
                }
            }
        ]
    },
    'exit_truth': {
        id: 'exit_truth',
        name: 'è¯´æœå‡ºå£',
        type: 'exit',
        icon: 'ğŸ’¬',
        desc: 'é€šè¿‡è¯´æœåŸƒå¾·è’™æ‰¾åˆ°ç¬¬ä¸‰æ¡è·¯ã€‚',
        visible: 'conditional',
        unlockConditions: [{ type: 'clue', target: 'è‰¾ç³å¨œçœŸç›¸' }, { type: 'clue', target: 'ç…§ç‰‡çº¿ç´¢' }],
        lockedText: 'ğŸ”’ éœ€è¦äº†è§£è‰¾ç³å¨œçš„çœŸç›¸å¹¶æŒæœ‰ç…§ç‰‡çº¿ç´¢',
        unlockedText: 'âœ“ å¯ä»¥æ­å¼€çœŸç›¸',
        actions: [
            {
                id: 'ending_truth',
                name: 'çœŸç›¸ç»“å±€ï¼šç¬¬ä¸‰æ¡è·¯',
                desc: 'åˆ©ç”¨æ‰€æœ‰çº¿ç´¢è¯´æœåŸƒå¾·è’™',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ å‘åŸƒå¾·è’™å±•ç¤ºäº†è‰¾ç³å¨œçš„ç…§ç‰‡ï¼Œè®²è¿°äº†ä½ åœ¨è—ä¹¦å®¤äº†è§£åˆ°çš„ä¸€åˆ‡â€”â€”ä»–æœ€åˆæ˜¯ä¸ºäº†æ‹¯æ•‘å¦»å­ï¼Œè€Œä¸æ˜¯è‡£æœäºæ·±æ¸Šã€‚ä½ å‘Šè¯‰ä»–è‰¾ç³å¨œçš„é—è¨€ï¼šå¥¹çˆ±ä»–ï¼Œä½†è¿™ä¸ªæ–¹æ³•é”™äº†ã€‚åŸƒå¾·è’™å´©æºƒäº†ï¼Œèƒ½é‡æŸ±å¼€å§‹ä¸ç¨³å®šã€‚ä½ æå‡ºäº†ç¬¬ä¸‰ç§æ–¹æ¡ˆï¼šä¸å®Œå…¨é‡Šæ”¾è‰¾ç³å¨œï¼Œä¹Ÿä¸ç»§ç»­ç‰ºç‰²å¥¹ï¼Œè€Œæ˜¯å»ºç«‹ä¸€ä¸ªå¾ªç¯å°å°ï¼Œè®©å¥¹å’ŒåŸƒå¾·è’™è½®æµæ‰¿æ‹…å®ˆé—¨äººçš„èŒè´£ï¼Œå‡è½»å„è‡ªçš„è´Ÿæ‹…ã€‚åŸƒå¾·è’™æœ€ç»ˆåŒæ„äº†ã€‚è‰¾ç³å¨œè¢«é‡Šæ”¾äº†ä¸€åŠï¼Œå¥¹ä»ç„¶ä¸æ·±æ¸Šæœ‰è”ç³»ï¼Œä½†ä¸å†è¢«å›šç¦ã€‚åŸƒå¾·è’™é€‰æ‹©ç•™åœ¨çŸ¿å‘ä¸­ï¼Œç»§ç»­ç ”ç©¶å¦‚ä½•å½»åº•è§£æ”¾å¦»å­ã€‚ä½ ç¦»å¼€æ—¶ï¼Œçœ‹åˆ°è‰¾ç³å¨œå’ŒåŸƒå¾·è’™ç›¸æ‹¥è€Œæ³£ï¼Œä»–ä»¬çš„èº«å½±åœ¨èƒ½é‡æŸ±çš„å¾®å…‰ä¸­é€æ¸æ¨¡ç³Šã€‚', ending: 'truth' }
                }
            }
        ]
    },
    'exit_hero': {
        id: 'exit_hero',
        name: 'æˆ˜æ–—å‡ºå£',
        type: 'exit',
        icon: 'âš”ï¸',
        desc: 'é€šè¿‡åŠ›é‡é˜»æ­¢ä»ªå¼ã€‚',
        visible: 'conditional',
        unlockConditions: [{ type: 'clue', target: 'æˆ˜æ–—èƒœåˆ©' }],
        lockedText: 'ğŸ”’ éœ€è¦å…ˆå‡»è´¥æˆ–è¯´æœåŸƒå¾·è’™',
        unlockedText: 'âœ“ å¯ä»¥é˜»æ­¢ä»ªå¼',
        actions: [
            {
                id: 'ending_hero',
                name: 'è‹±é›„ç»“å±€ï¼šç‰ºç‰²ä¸æ‹¯æ•‘',
                desc: 'å¼ºè¡Œé˜»æ­¢ä»ªå¼',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ ç”¨å°½å…¨åŠ›æ‰“æ–­äº†ä»ªå¼ï¼Œèƒ½é‡æŸ±å´©æºƒï¼Œè‰¾ç³å¨œçš„èº«å½±åœ¨å…‰èŠ’ä¸­æ¶ˆæ•£ã€‚åŸƒå¾·è’™åœ¨æœ€åä¸€åˆ»æ¢å¤äº†æ¸…é†’ï¼Œçœ‹ç€å¦»å­çš„æ¶ˆå¤±ï¼Œä»–çš„çœ¼ä¸­æµä¸‹äº†æ³ªæ°´ã€‚"ä½ åšäº†æ­£ç¡®çš„äº‹..."ä»–ä½å£°è¯´ï¼Œ"å¥¹è‡ªç”±äº†...ä»ç—›è‹¦ä¸­..."è¯´å®Œï¼Œä»–çš„èº«ä½“å¼€å§‹å´©è§£ï¼Œä¸æ·±æ¸ŠåŒåŒ–ã€‚ä½ é€ƒç¦»äº†å´©å¡Œçš„ä»ªå¼å¤§å…ï¼Œèº«åä¼ æ¥åŸƒå¾·è’™æœ€åçš„ç¬‘å£°â€”â€”é‚£ä¸æ˜¯ç–¯ç‹‚çš„ç¬‘ï¼Œè€Œæ˜¯é‡Šç„¶çš„ç¬‘ã€‚å½“ä½ å›åˆ°åœ°é¢ï¼Œç¬¬ä¸€ç¼•é˜³å…‰ç…§åœ¨è„¸ä¸Šï¼Œä½ çŸ¥é“è¿™ä¸€å¤œæ”¹å˜äº†ä½ çš„ä¸€ç”Ÿã€‚DIAä¼šé—®ä½ å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä½†ä½ æ°¸è¿œä¸ä¼šè¯´å‡ºå…¨éƒ¨çœŸç›¸ã€‚æœ‰äº›çŸ¥è¯†ï¼Œæœ€å¥½ç•™åœ¨æ·±æ¸Šä¹‹ä¸­ã€‚', ending: 'hero' }
                }
            }
        ]
    },
    'exit_sacrifice': {
        id: 'exit_sacrifice',
        name: 'ç‰ºç‰²å‡ºå£',
        type: 'exit',
        icon: 'âœ¨',
        desc: 'è‡ªæ„¿æ›¿ä»£è‰¾ç³å¨œæˆä¸ºå®ˆé—¨äººã€‚',
        visible: 'conditional',
        unlockConditions: [{ type: 'clue', target: 'å®ˆé—¨äººçœŸç›¸' }, { type: 'skill', skill: 'ç¥ç§˜å­¦', min: 50 }],
        lockedText: 'ğŸ”’ éœ€è¦äº†è§£å®ˆé—¨äººä»ªå¼ä¸”ç¥ç§˜å­¦â‰¥50',
        unlockedText: 'âœ“ å¯ä»¥è‡ªæ„¿ç‰ºç‰²',
        actions: [
            {
                id: 'ending_sacrifice',
                name: 'ç‰ºç‰²ç»“å±€ï¼šæ°¸æ’å®ˆæœ›',
                desc: 'æ›¿ä»£è‰¾ç³å¨œæˆä¸ºå®ˆé—¨äºº',
                roll: { type: 'auto' },
                results: {
                    success: { text: 'ä½ èµ°å‘èƒ½é‡æŸ±ï¼Œç†è§£äº†å®ˆé—¨äººä»ªå¼çš„å…¨éƒ¨å«ä¹‰ã€‚è¿™ä¸æ˜¯ç®€å•çš„ç‰ºç‰²ï¼Œè€Œæ˜¯ä¸€ç§æ°¸æ’çš„å®ˆæœ›â€”â€”ä½ å°†æˆä¸ºæ·±æ¸Šå’Œç°å®ä¹‹é—´çš„å±éšœï¼Œæ‰¿å—ä¸¤ä¸ªä¸–ç•Œçš„æŒ¤å‹ï¼Œä¿æŠ¤æ— çŸ¥çš„äººç±»å…å—æ·±æ¸Šçš„ä¾µèš€ã€‚è‰¾ç³å¨œè¢«é‡Šæ”¾æ—¶ï¼Œå¥¹çš„çœ¼ç¥ä¸­å……æ»¡äº†æ„Ÿæ¿€å’Œæ‚²ä¼¤ã€‚åŸƒå¾·è’™è·ªå€’åœ¨åœ°ï¼Œç—›å“­å¤±å£°ã€‚ä½ çš„é˜Ÿå‹æƒ³è¦é˜»æ­¢ä½ ï¼Œä½†ä½ çŸ¥é“è¿™æ˜¯å”¯ä¸€çš„é€‰æ‹©ã€‚å½“ä½ è¸å…¥èƒ½é‡æŸ±çš„é‚£ä¸€åˆ»ï¼Œç—›è‹¦å’Œç‹‚å–œåŒæ—¶å¸­å·è€Œæ¥ã€‚ä½ æ„Ÿå—åˆ°æ·±æ¸Šçš„çŸ¥è¯†æ¶Œå…¥è„‘æµ·ï¼ŒåŒæ—¶ä¹Ÿæ„Ÿå—åˆ°äº†è‰¾ç³å¨œæ‰¿å—çš„å­¤ç‹¬å’Œææƒ§ã€‚ä»ªå¼å®Œæˆåï¼Œä½ çš„é˜Ÿå‹ç¦»å¼€äº†çŸ¿å‘ï¼Œä½†ä½ ä»ç„¶"å­˜åœ¨"äºæ­¤ã€‚åœ¨æ°¸æ’çš„å­¤ç‹¬ä¸­ï¼Œä½ å®ˆæŠ¤ç€ä¸¤ä¸ªä¸–ç•Œçš„è¾¹ç•Œï¼Œç­‰å¾…ç€ä¸‹ä¸€ä¸ªå®ˆé—¨äººæ¥æ¥æ›¿ä½ çš„èŒè´£ã€‚', ending: 'sacrifice' }
                }
            }
        ]
    }
};

// å½“å‰é€‰ä¸­çš„å¯¹è±¡
var selectedObject = null;
var currentRoll = null;

// 13ä¸ªæˆ¿é—´å®Œæ•´æ•°æ® (v0.3 ç®€åŒ–ç‰ˆ)
var rooms = [
    {
        id: 'entrance',
        name: 'çŸ¿å‘å…¥å£',
        type: 'main',
        desc: 'å¯’é£è£¹æŒŸç€è…æœ½çš„æ°”æ¯ä»é»‘æš—ä¸­æ¶Œå‡ºã€‚\n\næ‰‹ç”µç­’çš„å…‰æŸåœ¨é”ˆè¿¹æ–‘æ–‘çš„é“è½¨ä¸Šæ‘‡æ™ƒï¼Œç…§äº®äº†å‰æ–¹åå¡Œçš„é€šé“ã€‚ä½ ä»¬ç«™åœ¨æ·±æ¸Šè£‚éš™çš„å…¥å£ï¼Œä½œä¸ºDIAç¬¬9å°é˜Ÿï¼Œä»»åŠ¡æ˜¯æ‰¾åˆ°å¤±è¸ªçš„ç¬¬7å°é˜Ÿå¹¶é˜»æ­¢æŸç§"ä»ªå¼"ã€‚\n\nèº«åçš„é€šè®¯è½¦é‡Œï¼ŒæŒ‡æŒ¥éƒ¨æœ€åçš„å£°éŸ³è¿˜åœ¨å›å“ï¼š"å¦‚æœ48å°æ—¶å†…æ²¡æœ‰å›åº”ï¼Œæˆ‘ä»¬å°†å°é”è¿™ä¸ªåŒºåŸŸã€‚ç¥ä½ ä»¬å¥½è¿ã€‚"',
        discoveries: [
            { id: 'mission', icon: 'ğŸ“‹', name: 'ä»»åŠ¡ç®€æŠ¥', text: 'DIAç¬¬7å°é˜Ÿ3å¤©å‰åœ¨æ­¤å¤±è”ã€‚æœ€åé€šè®¯æåˆ°"ä¸»æ•™"ã€"ä»ªå¼"ã€"æ·±æ¸Šä¹‹ä¸»"ã€‚' }
        ],
        choices: [
            { text: 'è¿›å…¥çŸ¿å‘', next: 1, desc: 'å¼€å§‹æ¢ç´¢æ·±æ¸Š' }
        ]
    },
    {
        id: 'collapse',
        name: 'æˆ¿é—´1ï¼šå¡Œé™·é€šé“ã€æ•™å­¦å…³ã€‘',
        type: 'main',
        objectSystem: true,
        desc: 'é€šé“è¢«ç¢çŸ³éƒ¨åˆ†å µå¡ï¼Œä½†è¿˜æœ‰ä¸€æ¡çª„ç¼å¯ä»¥é€šè¿‡ã€‚ç¢çŸ³å †ä¸Šè¦†ç›–ç€æ–°é²œçš„ç°å°˜å’ŒæŠ“ç—•ï¼Œçœ‹èµ·æ¥æ˜¯è¿‘æœŸå½¢æˆçš„åå¡Œã€‚\n\nä½ ä»¬æ³¨æ„åˆ°å¢™ä¸Šæœ‰æ–°é²œçš„åˆ’ç—•â€”â€”æœ‰äººç”¨åŒ•é¦–åˆ»ä¸‹äº†ç¬¦å·ã€‚åˆ»ç—•å¾ˆæ·±ï¼ŒåŠ›åº¦ä¸å‡ï¼Œæ˜¾ç¤ºå‡ºåˆ»å†™è€…å½“æ—¶æƒ…ç»ªæ¿€åŠ¨æˆ–æ—¶é—´ç´§è¿«ã€‚ç¬¦å·å‘¨å›´è¿˜æœ‰ä¸€äº›è¤è‰²çš„æ±¡æ¸ï¼Œå¯èƒ½æ˜¯è¡€è¿¹ã€‚\n\nè§’è½é‡Œè¿˜èººç€ä¸€æœ¬ç ´æ—§çš„æ—¥è®°ï¼Œè¢«éšæ„ä¸¢åœ¨é‚£é‡Œã€‚å°é¢å·²ç»è¢«è¡€æµ¸é€äº†ä¸€åŠï¼Œçº¸é¡µåœ¨æ½®æ¹¿çš„ç¯å¢ƒä¸­å¾®å¾®å·æ›²ã€‚',
        objects: ['debris', 'symbols', 'diary', 'exit_narrow'],
        choices: [
            { text: 'è¿›å…¥é—å¼ƒè£…å¤‡å®¤', next: 2, desc: 'ç»§ç»­å‰è¿›' }
        ]
    },
    {
        id: 'equipment',
        name: 'é—å¼ƒè£…å¤‡å®¤',
        type: 'side',
        objectSystem: true,
        desc: 'ä¸€ä¸ªä¾§å®¤ï¼Œæ˜¾ç„¶æ˜¯ç¬¬7å°é˜Ÿç•™ä¸‹çš„ä¸´æ—¶è¡¥ç»™ç‚¹ã€‚\n\nåºŠé“ºæ•´é½ï¼Œè£…å¤‡ç®±æœªæ‰“å¼€â€”â€”ä»–ä»¬ç¦»å¼€å¾—å¾ˆåŒ†å¿™ã€‚ä¸­å¤®çš„æ¡Œå­ä¸Šï¼Œä¸€ç›ç…¤æ²¹ç¯è¿˜åœ¨å¾®å¾®ç‡ƒçƒ§ï¼Œä»¿ä½›ä¸»äººåªæ˜¯æš‚æ—¶ç¦»å¼€...',
        objects: ['supply_box', 'oil_lamp', 'marcus_note', 'exit_equipment'],
        choices: [
            { text: 'å‰å¾€ç¬¬7å°é˜Ÿè¥åœ°', next: 4, desc: 'ç»§ç»­å‰è¿›' }
        ]
    },
    {
        id: 'mural',
        name: 'è¯¡å¼‚å£ç”»å…',
        type: 'side',
        objectSystem: true,
        desc: 'æ´ç©´å¢™å£ä¸Šå‡ºç°äº†å¤è€çš„å£ç”»ï¼Œæç»˜ç€æŸç§ä»ªå¼åœºæ™¯ã€‚\n\nç”»ä¸­äººä»¬å›´ç€ä¸€ä¸ªé»‘è‰²è£‚éš™ï¼Œä¼¼ä¹åœ¨...çŒ®ç¥­ï¼Ÿå£ç”»çš„é£æ ¼ä¸å±äºä»»ä½•å·²çŸ¥çš„å¤ä»£æ–‡æ˜ã€‚',
        objects: ['mural_left', 'mural_center', 'mural_right', 'exit_mural'],
        choices: [
            { text: 'å‰å¾€ç¬¬7å°é˜Ÿè¥åœ°', next: 4, desc: 'ç»§ç»­å‰è¿›' }
        ]
    },
    {
        id: 'camp',
        name: 'ç¬¬7å°é˜Ÿè¥åœ°ã€ä¸»è½´ã€‘',
        type: 'main',
        objectSystem: true,
        desc: 'ä¸€ä¸ªç›¸å¯¹å¼€é˜”çš„æ´å®¤ï¼Œæ˜¾ç„¶æ˜¯ç¬¬7å°é˜Ÿçš„ä¸´æ—¶è¥åœ°ã€‚\n\nåºŠé“ºæ•´é½ï¼Œè£…å¤‡ç®±æœªæ‰“å¼€â€”â€”ä»–ä»¬ç¦»å¼€å¾—å¾ˆåŒ†å¿™ã€‚ä¸­å¤®çš„æ¡Œå­ä¸Šï¼Œä¸€ç›ç…¤æ²¹ç¯è¿˜åœ¨å¾®å¾®ç‡ƒçƒ§...\n\né©¬åº“æ–¯é˜Ÿé•¿çš„æ—¥è®°å°±æ‘Šå¼€åœ¨æ¡Œä¸Šã€‚',
        objects: ['camp_bed', 'camp_case', 'marcus_diary', 'camp_lamp', 'exit_camp'],
        choices: [
            { text: 'å‰å¾€ä½è¯­å›å»Š', next: 5, desc: 'ç»§ç»­å‰è¿›' }
        ]
    },
    {
        id: 'whisper',
        name: 'ä½è¯­å›å»Š',
        type: 'main',
        objectSystem: true,
        desc: 'é€šé“å˜å¾—ç‹­çª„ï¼Œå¢™å£ä¸Šæ¸—å‡ºæ°´ç ã€‚\n\nä½ ä»¬å¬åˆ°äº†...ä½è¯­å£°ï¼Ÿåƒæ˜¯æœ‰äººåœ¨ä½ ä»¬è€³è¾¹è¯´è¯ï¼Œä½†å¬ä¸æ¸…å†…å®¹ã€‚å£°éŸ³ä¼¼ä¹åœ¨è¯±å¯¼ä½ ä»¬â€”â€”"æ¥å§...çœ‹çœ‹çœŸç›¸...""æ”¾å¼ƒå§...å¤ªè¿Ÿäº†..."',
        objects: ['wall_whisper', 'water_drops', 'shadow_corner', 'exit_whisper'],
        choices: [
            { text: 'å‰å¾€çŸ¿é“åˆ†å‰', next: 6, desc: 'ç»§ç»­å‰è¿›' }
        ]
    },
    {
        id: 'fork',
        name: 'æˆ¿é—´2ï¼šçŸ¿é“åˆ†å‰ã€æŠ‰æ‹©ã€‘',
        type: 'main',
        objectSystem: true,
        desc: 'é€šé“åœ¨è¿™é‡Œåˆ†æˆä¸¤æ¡è·¯ï¼Œè¿™æ˜¯ä¸€ä¸ªéœ€è¦æƒ…æŠ¥æ”¯æ’‘çš„æŠ‰æ‹©ç‚¹ã€‚\n\nå·¦è¾¹é€šå‘ä»ªå¼å‡†å¤‡åŒºï¼Œä½ ä»¬éšçº¦çœ‹åˆ°ç«å…‰å’Œäººå£°ã€‚ç«å…‰çš„é¢œè‰²ä¸å¤ªæ­£å¸¸ï¼Œå¸¦ç€æ·¡æ·¡çš„ç»¿è‰²è°ƒï¼Œç©ºæ°”ä¸­é£˜è¡ç€æŸç§ incense çš„æ°”å‘³ã€‚\n\nå³è¾¹é€šå‘æ·±æ¸Šè¾¹ç¼˜ï¼Œä¼ æ¥ä¸ç¥¥çš„èƒ½é‡æ³¢åŠ¨ã€‚è¶Šé è¿‘è¿™ä¸ªæ–¹å‘ï¼Œæ¸©åº¦å°±è¶Šä½ï¼Œå‘¼å‡ºçš„æ°”æ¯å‡ç»“æˆç™½è‰²çš„é›¾æ°”ã€‚\n\nå²”è·¯å£ä¸­å¤®çš„çŸ³æŸ±ä¸Šåˆ»ç€å¤è€çš„æ ‡è®°ï¼Œä¼¼ä¹æ˜¯æŸç§æŒ‡ç¤ºç‰Œã€‚åœ¨åšå‡ºé€‰æ‹©ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆè°ƒæŸ¥æ”¶é›†æƒ…æŠ¥ã€‚',
        objects: ['upper_path', 'lower_path', 'middle_sign', 'exit_upper', 'exit_lower'],
        choices: [
            { text: 'â¬†ï¸ å‰å¾€æ•™å¯¼å…ï¼ˆä¸Šåˆ†æ”¯ï¼‰', next: 7, desc: 'æ›´å¤šçŸ¥è¯†ï¼Œæ›´å¤šSANé£é™©' },
            { text: 'â¬‡ï¸ å‰å¾€æ·±æ¸Šè¾¹ç¼˜ï¼ˆä¸‹åˆ†æ”¯ï¼‰', next: 9, desc: 'æ›´å¤šæˆ˜æ–—ï¼Œæ›´å¤šHPé£é™©' }
        ]
    },
    // ä¸Šåˆ†æ”¯
    {
        id: 'teaching',
        name: 'æ•™å¯¼å…',
        type: 'side',
        objectSystem: true,
        desc: 'ä¸€ä¸ªæ˜æš—çš„å¤§å…ï¼Œå¢™ä¸Šåˆ»æ»¡äº†ä½ ä»¬ä¸è®¤è¯†çš„ç¬¦å·ã€‚\n\nå‡ ä¸ªæ‘æ°‘ååœ¨åœ°ä¸Šï¼Œçœ¼ç¥ç©ºæ´ï¼Œä¼¼ä¹åœ¨åå¤èƒŒè¯µç€ä»€ä¹ˆã€‚',
        objects: ['villagers', 'podium_notes', 'wall_symbols', 'exit_teaching'],
        choices: [
            { text: 'ç»§ç»­å‰å¾€è—ä¹¦å®¤', next: 8, desc: 'äº†è§£åŸƒå¾·è’™çš„è¿‡å»' }
        ]
    },
    {
        id: 'library',
        name: 'è—ä¹¦å®¤ã€ä¸»è½´ã€‘',
        type: 'main',
        objectSystem: true,
        desc: 'åŸƒå¾·è’™Â·å¸ƒè±å…‹ä¼å¾·çš„ç§äººç©ºé—´ï¼Œå¢™ä¸Šè´´æ»¡äº†ç ”ç©¶æŠ¥å‘Šå’Œ...ç…§ç‰‡ï¼Ÿ\n\næ˜¯DIAæˆç«‹åˆæœŸçš„åˆå½±ï¼Œå¹´è½»çš„åŸƒå¾·è’™ç«™åœ¨ä¸­å¤®ï¼Œç¬‘å®¹è‡ªä¿¡ã€‚å¦ä¸€å¼ ç…§ç‰‡ä¸Šï¼Œä»–å’Œä¸€ä¸ªå¹´è½»å¥³å­â€”â€”è‰¾ç³å¨œã€‚\n\nç…§ç‰‡èƒŒé¢å†™ç€ï¼š"è‰¾ç³å¨œï¼Œæ„¿æ·±æ¸Šæ°¸è¿œå°å°ã€‚"æ—¥æœŸæ˜¯...2å¹´å‰ï¼Ÿ',
        objects: ['research_papers', 'group_photo', 'elena_photo', 'edmund_desk', 'exit_library'],
        choices: [
            { text: 'å‰å¾€ä»ªå¼å¤§å…', next: 11, desc: 'æœ€ç»ˆå†³æˆ˜' }
        ]
    },
    // ä¸‹åˆ†æ”¯
    {
        id: 'pit',
        name: 'ç‰ºç‰²å‘é“',
        type: 'side',
        objectSystem: true,
        desc: 'å‘ä¸‹çš„æ–œå¡ï¼Œç©ºæ°”ä¸­å¼¥æ¼«ç€è¡€è…¥å‘³ã€‚\n\nä½ ä»¬çœ‹åˆ°äº†...æ‰‹æœ¯å°ï¼Ÿè¿™æ˜¯åŸƒå¾·è’™"å¤„ç†"é‚£äº›"ä¸é€‚åˆå‚ä¸ä»ªå¼"çš„äººçš„åœ°æ–¹ã€‚',
        objects: ['surgery_table', 'mad_villager', 'blood_trail', 'exit_pit'],
        choices: [
            { text: 'å‰å¾€æ·±æ¸Šè¾¹ç¼˜', next: 10, desc: 'ç»§ç»­å‰è¿›' }
        ]
    },
    {
        id: 'abyss',
        name: 'æ·±æ¸Šè¾¹ç¼˜ã€ä¸»è½´ã€‘',
        type: 'main',
        objectSystem: true,
        desc: 'ä½ ä»¬æ¥åˆ°äº†è£‚éš™è¾¹ç¼˜ã€‚é»‘è‰²çš„è™šæ— æ‚¬æµ®åœ¨çŸ¿å‘å°½å¤´ã€‚\n\nåœ¨è£‚éš™å‰ï¼Œä½ ä»¬å‘ç°äº†é©¬åº“æ–¯é˜Ÿé•¿ã€‚ä»–æµ‘èº«æ˜¯è¡€ï¼Œä½†è¿˜æ´»ç€ã€‚\n\n"å¬ç€...åŸƒå¾·è’™...ä»–ä¸æ˜¯åäºº...ä»–åªæ˜¯...æƒ³æ•‘ä»–çš„å¦»å­..."\n\n"è‰¾ç³å¨œ...è¢«å›°åœ¨æ·±æ¸Šè¾¹ç¼˜...2å¹´äº†...å®ˆé—¨äºº...å¿…é¡»è‡ªæ„¿..."',
        objects: ['abyss_rift', 'dying_marcus', 'protective_symbol', 'exit_abyss'],
        choices: [
            { text: 'å‰å¾€ä»ªå¼å¤§å…', next: 11, desc: 'ä¸ºé©¬åº“æ–¯æŠ¥ä»‡' }
        ]
    },
    // ç»ˆå±€
    {
        id: 'ritual',
        name: 'æˆ¿é—´3ï¼šä»ªå¼å¤§å…ã€ç»ˆå±€Â·å¤šç»“å±€ã€‘',
        type: 'main',
        objectSystem: true,
        desc: 'ç»ˆäºæ¥åˆ°äº†æ ¸å¿ƒåŒºåŸŸã€‚ä»ªå¼æ­£åœ¨è¿›è¡Œâ€”â€”\n\né»‘è‰²çš„èƒ½é‡æŸ±ä»è£‚éš™ä¸­å‡èµ·ï¼ŒåŸƒå¾·è’™Â·å¸ƒè±å…‹ä¼å¾·ç«™åœ¨å…‰æŸ±ä¸­å¤®ï¼Œä»–çš„èº«ä½“å·²ç»å¼€å§‹ä¸æ·±æ¸ŠåŒåŒ–ã€‚ä»–çš„åŠè¾¹è„¸ä»ç„¶æ˜¯é‚£ä¸ªç†æ€§çš„DIAé¦–å¸­ç ”ç©¶å‘˜ï¼Œä½†å¦å¤–åŠè¾¹å·²ç»å˜æˆäº†ç”±é»‘æš—å’Œæ˜Ÿå…‰æ„æˆçš„éäººå½¢æ€ã€‚\n\nåœ¨èƒ½é‡æŸ±ä¸­ï¼Œä½ ä»¬éšçº¦çœ‹åˆ°ä¸€ä¸ªäººå½±â€”â€”è‰¾ç³å¨œÂ·å¸ƒè±å…‹ä¼å¾·ï¼Œæ¼‚æµ®åœ¨è™šç©ºä¹‹ä¸­ã€‚å¥¹çš„èº«ä½“åŠé€æ˜ï¼Œä»¿ä½›å¤„äºç°å®å’Œè™šå¹»ä¹‹é—´...\n\nåŸƒå¾·è’™è½¬èº«ï¼Œä»–çš„çœ¼ç¥ä¸­æ—¢æœ‰ç–¯ç‹‚ï¼Œä¹Ÿæœ‰æ·±æ·±çš„æ‚²å“€ï¼š"ä½ ä»¬æ¥äº†...æˆ‘ç­‰å¾…ç€æœ‰äººèƒ½ç†è§£æˆ‘...æˆ–è€…ï¼Œè‡³å°‘...èƒ½é˜»æ­¢æˆ‘ã€‚"\n\nä¸‰ä¸ªé€‰æ‹©æ‘†åœ¨ä½ é¢å‰ï¼šç”¨ä»è—ä¹¦å®¤è·å¾—çš„ç…§ç‰‡çº¿ç´¢è¯´æœåŸƒå¾·è’™ï¼ˆçœŸç›¸ç»“å±€ï¼‰ã€ç”¨ä»æ·±æ¸Šè¾¹ç¼˜è·å¾—çš„åŠ›é‡å‡»è´¥ä»–ï¼ˆè‹±é›„ç»“å±€ï¼‰ã€æˆ–è€…å¦‚æœä½ æœ‰è¶³å¤Ÿçš„ç¥ç§˜å­¦çŸ¥è¯†ï¼Œå¯ä»¥è‡ªæ„¿æ›¿ä»£è‰¾ç³å¨œï¼ˆç‰ºç‰²ç»“å±€ï¼‰ã€‚',
        objects: ['edmund_figure', 'energy_column', 'elenia_figure', 'exit_truth', 'exit_hero', 'exit_sacrifice'],
        choices: [
            { text: 'ğŸ’¬ çœŸç›¸ç»“å±€', ending: 'truth', desc: 'å»è¿‡è—ä¹¦å®¤+è‰¾ç³å¨œçœŸç›¸' },
            { text: 'âš”ï¸ è‹±é›„ç»“å±€', ending: 'hero', desc: 'å»è¿‡æ·±æ¸Šè¾¹ç¼˜æˆ–å‡»è´¥åŸƒå¾·è’™' },
            { text: 'âœ¨ ç‰ºç‰²ç»“å±€', ending: 'sacrifice', desc: 'ç¥ç§˜å­¦â‰¥50+äº†è§£å®ˆé—¨äººä»ªå¼' }
        ]
    }
];

// ========== æ¸¸æˆå‡½æ•° ==========
function selectProf(key) {
    console.log('selectProf called:', key, 'current:', selectedProfs);
    
    if (selectedProfs.indexOf(key) >= 0) {
        console.log('Already selected');
        return;
    }
    if (selectedProfs.length >= 2) {
        console.log('Already have 2');
        return;
    }
    
    selectedProfs.push(key);
    console.log('Added:', key, 'total:', selectedProfs);
    
    var hintEl = document.getElementById('selectHint');
    if (hintEl) {
        hintEl.textContent = 'å·²é€‰æ‹©: ' + selectedProfs.length + '/2';
        hintEl.style.color = '#27ae60';
    }
    
    // é«˜äº®
    var ids = { archaeologist: 'card1', soldier: 'card2', occultist: 'card3' };
    var cardId = ids[key];
    console.log('Looking for card:', cardId);
    var card = document.getElementById(cardId);
    if (card) {
        card.style.borderColor = '#27ae60';
        card.style.backgroundColor = '#1a3a2e';
        console.log('Card highlighted');
    } else {
        console.log('Card not found!');
    }
    
    if (selectedProfs.length === 2) {
        console.log('Starting game...');
        setTimeout(startGame, 500);
    }
}

function startGame() {
    team = [
        { key: selectedProfs[0], ...professions[selectedProfs[0]] },
        { key: selectedProfs[1], ...professions[selectedProfs[1]] }
    ];
    
    document.getElementById('professionSelect').classList.add('hidden');
    document.getElementById('gameUI').classList.remove('hidden');
    
    updateStatus();
    enterRoom(0);
}

function enterRoom(idx) {
    currentRoomIdx = idx;
    var room = rooms[idx];
    selectedObject = null;
    
    // v0.3 åˆå§‹åŒ–æˆ¿é—´çŠ¶æ€ï¼ˆå¯¹è±¡è§£å†³çŠ¶æ€ï¼‰
    currentRoomState = { solvedObjects: [], unlockedExits: false };
    
    document.getElementById('roomTitle').textContent = room.name;
    document.getElementById('roomSub').textContent = 'æˆ¿é—´ ' + (idx + 1) + '/13 | å›åˆ ' + turnCount;
    
    var html = '<div class="room-container">';
    
    // æè¿°
    html += '<div class="room-desc">' + room.desc.replace(/\n/g, '<br>') + '</div>';
    
    // v0.3 ç®€åŒ–ç‰ˆæˆ¿é—´æ¸²æŸ“
    if (room.objectSystem) {
        // v0.3 å¯¹è±¡ç³»ç»Ÿæˆ¿é—´ - ç®€åŒ–ç‰ˆï¼ˆæ— è§£å†³åº¦/æ¶åŒ–åº¦/APï¼‰
        
        // å™äº‹æ–‡æœ¬åŒºåŸŸ
        html += '<div id="narrativeArea"></div>';
        
        // å¯¹è±¡åˆ—è¡¨
        html += '<div class="object-panel">';
        html += '<div class="object-title">ğŸ“¦ å¯äº¤äº’å¯¹è±¡ï¼ˆç‚¹å‡»é€‰æ‹©ï¼‰</div>';
        html += '<div class="object-list" id="objectList">';
        room.objects.forEach(function(objId, i) {
            var obj = objectTemplates[objId];
            if (!obj) return;
            var typeText = { 'obstacle': 'ã€éšœç¢ã€‘', 'info': 'ã€æƒ…æŠ¥ã€‘', 'story': 'ã€å‰§æƒ…ã€‘', 'exit': 'ã€å‡ºå£ã€‘' }[obj.type] || '';
            var isSolved = currentRoomState.solvedObjects.includes(objId);
            var isLockedExit = obj.type === 'exit' && !currentRoomState.unlockedExits;
            
            html += '<div class="object-item type-' + obj.type + (isSolved ? ' solved' : '') + '" id="obj_' + objId + '" onclick="selectObject(\'' + objId + '\')">';
            html += '<span class="object-icon">' + obj.icon + '</span>';
            html += '<span class="object-name">' + obj.name + (isSolved ? ' âœ“' : '') + '</span>';
            html += '<span class="object-type">' + typeText + '</span>';
            if (isLockedExit && obj.unlockConditions) {
                html += '<span style="font-size:10px;color:#e94560;margin-left:5px;">ğŸ”’</span>';
            }
            html += '</div>';
        });
        html += '</div>';
        
        // å¯¹è±¡æè¿°
        html += '<div id="objectDesc" style="display:none;font-size:12px;color:#888;margin-bottom:10px;padding:8px;background:#0f0f1a;border-radius:4px;"></div>';
        
        // è¡ŒåŠ¨åˆ—è¡¨
        html += '<div class="action-panel" id="actionPanel" style="display:none;">';
        html += '<div class="action-title">å¯ç”¨è¡ŒåŠ¨</div>';
        html += '<div class="action-list" id="actionList"></div>';
        html += '</div>';
        
        html += '</div>';
        
        // ç»“æœåé¦ˆåŒºåŸŸ
        html += '<div id="resultFeedback"></div>';
        
        // v0.3 ç§»é™¤é‡å¤å‡ºå£åŒºåŸŸ - å‡ºå£ç°åœ¨é€šè¿‡å¯¹è±¡ç³»ç»Ÿç®¡ç†
    } else {
        // æ™®é€šæˆ¿é—´ç›´æ¥æ˜¾ç¤ºé€‰æ‹©
        html += '<div class="room-choices">';
        room.choices.forEach(function(c) {
            var onclick = '';
            if (c.next !== undefined) onclick = 'onclick="enterRoom(' + c.next + ')"';
            else if (c.ending) onclick = 'onclick="showEnding(\'' + c.ending + '\')"';
            
            html += '<button class="choice-btn" ' + onclick + '>';
            html += '<span class="choice-title">' + c.text + '</span>';
            if (c.desc) html += '<span class="choice-desc">' + c.desc + '</span>';
            html += '</button>';
        });
        html += '</div>';
    }
    
    html += '</div>';
    
    document.getElementById('mainContent').innerHTML = html;
}

// v0.3 ç§»é™¤ playCard å’Œ readDiscovery å‡½æ•°

function addSanity(amount) {
    team.forEach(function(inv) {
        inv.san = Math.min(100, inv.san + amount);
    });
    updateStatus();
}

function updateStatus() {
    team.forEach(function(inv, idx) {
        var el = document.getElementById('name' + idx);
        if (el) el.textContent = inv.name;
        
        el = document.getElementById('hp' + idx);
        if (el) el.textContent = inv.hp + '/' + inv.maxHp;
        
        el = document.getElementById('hpBar' + idx);
        if (el) el.style.width = (inv.hp / inv.maxHp * 100) + '%';
        
        el = document.getElementById('sanBar' + idx);
        if (el) el.style.width = (inv.san / 100 * 100) + '%';
        
        el = document.getElementById('san' + idx);
        if (el) el.textContent = inv.san;
        
        // çŠ¶æ€æ ‡ç­¾
        el = document.getElementById('status' + idx);
        if (el) {
            var state = 'calm', text = 'å†·é™';
            if (inv.san > 30) { state = 'uneasy'; text = 'ä¸å®‰'; }
            if (inv.san > 50) { state = 'nervous'; text = 'ç´§å¼ '; }
            if (inv.san > 70) { state = 'fearful'; text = 'ææƒ§'; }
            if (inv.san > 85) { state = 'breaking'; text = 'å´©æºƒ'; }
            el.className = 'status-label ' + state;
            el.textContent = text;
        }
    });
    
    // v0.3 æ›´æ–°å›åˆæ˜¾ç¤º
    var turnDisplay = document.getElementById('turnDisplay');
    if (turnDisplay) {
        turnDisplay.textContent = 'å›åˆ: ' + turnCount;
    }
}

function showEnding(type) {
    var endings = {
        truth: { title: 'ğŸ“š çœŸç›¸ç»“å±€', text: 'ä½ è¯´æœäº†åŸƒå¾·è’™ï¼Œä¸€èµ·æ‰¾åˆ°äº†è®©æ·±æ¸Šæ²‰ç¡è€Œä¸éœ€è¦ç‰ºç‰²çš„æ–¹æ³•ã€‚è‰¾ç³å¨œè¢«é‡Šæ”¾ï¼Œè€ŒåŸƒå¾·è’™é€‰æ‹©ç»§ç»­ç ”ç©¶æ·±æ¸Šï¼Œå¯»æ‰¾æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚' },
        hero: { title: 'ğŸ† è‹±é›„ç»“å±€', text: 'ä½ å‡»è´¥äº†åŸƒå¾·è’™ï¼Œé˜»æ­¢äº†ä»ªå¼ã€‚ä½†è‰¾ç³å¨œæ°¸è¿œå›°åœ¨äº†æ·±æ¸Šè¾¹ç¼˜ï¼Œè€ŒåŸƒå¾·è’™åœ¨æœ€åæ—¶åˆ»é†’æ‚Ÿï¼Œç”¨è‡ªå·±çš„ç”Ÿå‘½å¼ºåŒ–äº†å°å°ã€‚' },
        sacrifice: { title: 'ğŸ˜¢ ç‰ºç‰²ç»“å±€', text: 'ä¸€åè°ƒæŸ¥å‘˜è‡ªæ„¿æ›¿ä»£è‰¾ç³å¨œæˆä¸ºå®ˆé—¨äººï¼Œæ°¸è¿œå›°åœ¨æ·±æ¸Šè¾¹ç¼˜ã€‚å…¶ä»–äººå›åˆ°åœ°é¢ï¼Œä½†æ°¸è¿œæ— æ³•å¿˜è®°é‚£ä¸ªèº«å½±ã€‚' }
    };
    
    var end = endings[type];
    document.getElementById('modalTitle').textContent = end.title;
    document.getElementById('modalText').innerHTML = end.text + '<br><br><button onclick="location.reload()" style="padding:10px 20px;background:#e94560;color:white;border:none;cursor:pointer;">å†ç©ä¸€æ¬¡</button>';
    document.getElementById('modal').classList.add('show');
}

function closeModal() {
    document.getElementById('modal').classList.remove('show');
}

// æ—¥å¿—
function log(text) {
    var panel = document.getElementById('logPanel');
    var entry = document.createElement('div');
    entry.className = 'log-entry system';
    entry.textContent = text;
    panel.appendChild(entry);
    panel.scrollTop = panel.scrollHeight;
}

// ========== å¯¹è±¡ç³»ç»Ÿå‡½æ•° ==========

// é€‰æ‹©å¯¹è±¡
function selectObject(objId) {
    selectedObject = objectTemplates[objId];
    
    // æ›´æ–°UIæ˜¾ç¤º
    document.querySelectorAll('.object-item').forEach(function(el) {
        el.classList.remove('selected');
    });
    document.getElementById('obj_' + objId).classList.add('selected');
    
    // æ˜¾ç¤ºå¯¹è±¡æè¿°
    var descEl = document.getElementById('objectDesc');
    descEl.textContent = selectedObject.desc;
    descEl.style.display = 'block';
    
    // æ˜¾ç¤ºè¡ŒåŠ¨é¢æ¿
    document.getElementById('actionPanel').style.display = 'block';
    
    // æ¸²æŸ“è¡ŒåŠ¨åˆ—è¡¨
    renderActions();
}

// è·å–è°ƒæŸ¥å‘˜çš„æŠ€èƒ½å€¼
function getSkillValue(skillName) {
    // è¿”å›é˜Ÿä¼ä¸­æœ€é«˜æŠ€èƒ½å€¼
    var maxVal = 0;
    team.forEach(function(inv) {
        if (inv.skills[skillName] && inv.skills[skillName] > maxVal) {
            maxVal = inv.skills[skillName];
        }
    });
    return maxVal;
}

// è®¡ç®—æˆåŠŸç‡
function calculateSuccessRate(roll) {
    if (roll.type === 'auto') return 100;
    if (roll.type === 'item') {
        // æ£€æŸ¥æ˜¯å¦æœ‰é“å…·
        return clues.indexOf(roll.item) >= 0 ? 100 : 0;
    }
    if (roll.type === 'skill') {
        var skillVal = getSkillValue(roll.skill);
        // æ£€æŸ¥èŒä¸šåŠ æˆ
        if (roll.skill === 'åŠ›é‡' && team.some(function(i) { return i.key === 'soldier'; })) {
            skillVal = Math.min(99, skillVal + 10);
        }
        if (roll.skill === 'ç¥ç§˜å­¦' && team.some(function(i) { return i.key === 'occultist'; })) {
            skillVal = Math.min(99, skillVal + 10);
        }
        if (roll.skill === 'ä¾¦æŸ¥' && team.some(function(i) { return i.key === 'archaeologist'; })) {
            skillVal = Math.min(99, skillVal + 10);
        }
        return skillVal;
    }
    return 50;
}

// æ¸²æŸ“è¡ŒåŠ¨åˆ—è¡¨
function renderActions() {
    if (!selectedObject) return;
    
    var html = '';
    var isSolved = currentRoomState.solvedObjects.includes(selectedObject.id);
    
    // v0.3 å¦‚æœå¯¹è±¡å·²è§£å†³ï¼Œæ˜¾ç¤ºå®ŒæˆçŠ¶æ€
    if (isSolved) {
        html += '<div style="text-align:center;padding:15px;color:#27ae60;">âœ“ è¯¥å¯¹è±¡å·²è§£å†³</div>';
        document.getElementById('actionList').innerHTML = html;
        return;
    }
    
    // v0.3 å¦‚æœæ˜¯é”å®šçš„å‡ºå£ï¼Œæ˜¾ç¤ºè§£é”æ¡ä»¶
    if (selectedObject.type === 'exit' && selectedObject.unlockConditions) {
        var isUnlocked = selectedObject.unlockConditions.every(function(condition) {
            return checkExitUnlockCondition(condition);
        });
        
        if (!isUnlocked) {
            var conditionText = selectedObject.lockedText || 'è§£é”æ¡ä»¶æœªæ»¡è¶³';
            html += '<div style="text-align:center;padding:15px;color:#e94560;">ğŸ”’ ' + conditionText + '</div>';
            document.getElementById('actionList').innerHTML = html;
            return;
        } else {
            // æ˜¾ç¤ºå·²è§£é”çŠ¶æ€
            html += '<div style="text-align:center;padding:10px;color:#27ae60;">' + (selectedObject.unlockedText || 'âœ“ å·²è§£é”') + '</div>';
        }
    }
    
    selectedObject.actions.forEach(function(action) {
        var rate = calculateSuccessRate(action.roll);
        var canDo = rate > 0;
        
        var rateText = rate === 100 ? 'å¿…æˆåŠŸ' : rate + '%æˆåŠŸç‡';
        if (rate === 0) rateText = 'ç¼ºå°‘é“å…·';
        
        html += '<button class="action-btn" onclick="executeAction(\'' + action.id + '\')" ' + (canDo ? '' : 'disabled') + '>';
        html += '<div class="action-info">';
        html += '<span class="action-name">' + action.name + '</span>';
        html += '<span class="action-desc">' + action.desc + '</span>';
        html += '</div>';
        html += '<div class="action-meta">';
        html += '<span class="action-rate">' + rateText + '</span>';
        html += '</div>';
        html += '</button>';
    });
    
    document.getElementById('actionList').innerHTML = html;
}

// æ‰§è¡Œè¡ŒåŠ¨
function executeAction(actionId) {
    if (!selectedObject) return;
    
    var action = selectedObject.actions.find(function(a) { return a.id === actionId; });
    if (!action) return;
    
    // v0.3 å¢åŠ å›åˆè®¡æ•°
    turnCount++;
    updateStatus();
    
    // æ‰§è¡Œåˆ¤å®š
    performRoll(action);
}

// æ‰§è¡Œåˆ¤å®š
function performRoll(action) {
    var roll = action.roll;
    var rate = calculateSuccessRate(roll);
    
    // å¦‚æœæ˜¯æ¡ä»¶è‡ªåŠ¨æˆåŠŸï¼ˆå¦‚è€ƒå¤å­¦å®¶æˆ–å†›äººï¼‰
    if (roll.type === 'auto' && roll.condition === 'archaeologist_or_soldier') {
        var hasSpecialist = team.some(function(i) { return i.key === 'archaeologist' || i.key === 'soldier'; });
        if (hasSpecialist) {
            rate = 100;
        } else {
            // æ²¡æœ‰ä¸“å®¶ï¼Œé‡å®šå‘åˆ°åŠ›é‡åˆ¤å®š
            rate = getSkillValue('åŠ›é‡');
        }
    }
    
    currentRoll = { action: action, rate: rate };
    
    // v0.3 å¿…æˆåŠŸé€‰é¡¹ç›´æ¥æ˜¾ç¤ºç»“æœï¼Œè·³è¿‡åˆ¤å®šåŠ¨ç”»
    if (rate === 100 && roll.type === 'auto') {
        // ç›´æ¥æ‰§è¡ŒæˆåŠŸç»“æœ
        var autoResult = action.results.success || action.results[0];
        if (autoResult) {
            currentRoll.resultType = 'success';
            currentRoll.resultData = autoResult;
            executeActionResult(currentRoll);
        }
        return;
    }
    
    // æ˜¾ç¤ºåˆ¤å®šåŠ¨ç”»
    var overlay = document.getElementById('rollOverlay');
    var display = document.getElementById('rollDisplay');
    var resultEl = document.getElementById('rollResult');
    var detailEl = document.getElementById('rollDetail');
    
    overlay.classList.add('show');
    resultEl.style.display = 'none';
    detailEl.style.display = 'none';
    document.getElementById('rollClose').style.display = 'none';
    
    // æ•°å­—è·³åŠ¨åŠ¨ç”»
    var finalRoll = Math.floor(Math.random() * 100) + 1;
    var iterations = 0;
    var maxIterations = 20;
    
    var interval = setInterval(function() {
        display.textContent = String(Math.floor(Math.random() * 100) + 1).padStart(2, '0');
        iterations++;
        
        if (iterations >= maxIterations) {
            clearInterval(interval);
            display.textContent = String(finalRoll).padStart(2, '0');
            showRollResult(finalRoll, rate, action);
        }
    }, 50);
}

// æ˜¾ç¤ºåˆ¤å®šç»“æœ
function showRollResult(roll, rate, action) {
    var resultType, resultText;
    
    // åˆ¤å®šç»“æœåˆ†çº§
    if (roll <= 5) {
        resultType = 'fumble';
        resultText = 'å¤§å¤±è´¥ï¼';
    } else if (roll <= rate) {
        if (roll >= 96) {
            resultType = 'crit';
            resultText = 'å¤§æˆåŠŸï¼';
        } else {
            resultType = 'success';
            resultText = 'æˆåŠŸ';
        }
    } else {
        resultType = 'fail';
        resultText = 'å¤±è´¥';
    }
    
    // å¦‚æœæ²¡æœ‰å¤§æˆåŠŸ/å¤§å¤±è´¥çš„å®šä¹‰ï¼Œä½¿ç”¨æ™®é€šæˆåŠŸ/å¤±è´¥
    var resultData = action.results[resultType] || action.results.success || action.results.fail;
    
    // å¦‚æœæ˜¯è‡ªåŠ¨æˆåŠŸä½†è¢«åˆ¤å®šä¸ºå¤±è´¥ï¼Œå¼ºåˆ¶æ”¹ä¸ºæˆåŠŸ
    if (rate === 100 && resultType === 'fail') {
        resultType = 'success';
        resultText = 'æˆåŠŸ';
        resultData = action.results.success;
    }
    
    currentRoll.resultType = resultType;
    currentRoll.resultData = resultData;
    
    var resultEl = document.getElementById('rollResult');
    var detailEl = document.getElementById('rollDetail');
    
    resultEl.className = 'roll-result ' + resultType;
    resultEl.textContent = resultText;
    resultEl.style.display = 'block';
    
    detailEl.textContent = 'åˆ¤å®š: d100=' + roll + ' / ç›®æ ‡=' + rate;
    detailEl.style.display = 'block';
    
    document.getElementById('rollClose').style.display = 'block';
}

// å…³é—­åˆ¤å®šåŠ¨ç”»å¹¶æ‰§è¡Œç»“æœ
function closeRoll() {
    document.getElementById('rollOverlay').classList.remove('show');
    
    if (currentRoll && currentRoll.resultData) {
        executeActionResult(currentRoll);
    }
}

// æ‰§è¡Œè¡ŒåŠ¨ç»“æœ
function executeActionResult(rollData) {
    var result = rollData.resultData;
    var action = rollData.action;
    
    // v0.3 åº”ç”¨æ•ˆæœ
    if (result.san) {
        addSanity(result.san);
    }
    if (result.hp) {
        team.forEach(function(inv) {
            inv.hp = Math.max(0, Math.min(inv.maxHp, inv.hp + result.hp));
        });
        updateStatus();
    }
    if (result.clue && clues.indexOf(result.clue) < 0) {
        clues.push(result.clue);
    }
    
    // v0.3 æ ‡è®°å¯¹è±¡ä¸ºå·²è§£å†³ï¼ˆä»…åœ¨æˆåŠŸæˆ–å¤§æˆåŠŸæ—¶ï¼‰
    var isSuccess = rollData.resultType === 'success' || rollData.resultType === 'crit';
    if (isSuccess) {
        if (result.solveObject) {
            if (!currentRoomState.solvedObjects.includes(result.solveObject)) {
                currentRoomState.solvedObjects.push(result.solveObject);
            }
        }
        // æ ‡è®°å½“å‰å¯¹è±¡ä¸ºå·²è§£å†³ï¼ˆæ‰€æœ‰ç±»å‹çš„å¯¹è±¡ï¼‰
        if (!currentRoomState.solvedObjects.includes(selectedObject.id)) {
            currentRoomState.solvedObjects.push(selectedObject.id);
        }
        
        // v0.3 æ£€æŸ¥å¹¶è§£é”å…³è”å‡ºå£
        checkAndUnlockExits();
        
        // v0.3 å¦‚æœæœ‰nextå±æ€§ï¼Œå»¶è¿Ÿåè·³è½¬åˆ°ä¸‹ä¸€æˆ¿é—´
        if (result.next !== undefined) {
            setTimeout(function() {
                enterRoom(result.next);
            }, 1500);
        }
        
        // v0.3 å¦‚æœæœ‰endingå±æ€§ï¼Œå»¶è¿Ÿåæ˜¾ç¤ºç»“å±€
        if (result.ending !== undefined) {
            setTimeout(function() {
                showEnding(result.ending);
            }, 2000);
        }
    }
    
    // ä¸‰å±‚å™äº‹åé¦ˆ
    var feedbackHtml = '<div class="result-feedback">';
    feedbackHtml += '<div class="result-layer layer-action">â–¶ ' + selectedObject.name + ' - ' + action.name + '</div>';
    feedbackHtml += '<div class="result-layer layer-roll">' + getRollResultText(rollData.resultType) + '</div>';
    feedbackHtml += '<div class="result-layer layer-narrative">' + result.text + '</div>';
    
    // æ˜¾ç¤ºæ•ˆæœ
    var effects = [];
    if (result.san) effects.push('ç†æ™º +' + result.san);
    if (result.hp) effects.push('ç”Ÿå‘½ ' + (result.hp > 0 ? '+' : '') + result.hp);
    if (result.clue) effects.push('è·å¾—çº¿ç´¢: ' + result.clue);
    if (result.item) effects.push('è·å¾—ç‰©å“: ' + result.item);
    if (result.bonus) effects.push('é¢å¤–: ' + result.bonus);
    if (effects.length > 0) {
        feedbackHtml += '<div style="margin-top:8px;font-size:11px;color:#27ae60;">' + effects.join(' | ') + '</div>';
    }
    
    feedbackHtml += '</div>';
    
    document.getElementById('resultFeedback').innerHTML = feedbackHtml;
    
    // åˆ·æ–°å¯¹è±¡åˆ—è¡¨æ˜¾ç¤º
    refreshObjectList();
    
    // æ›´æ–°è¡ŒåŠ¨åˆ—è¡¨
    renderActions();
}

// v0.3 æ–°å¢ï¼šæ£€æŸ¥å‡ºå£è§£é”æ¡ä»¶
function checkExitUnlockCondition(condition) {
    if (!condition) return true;
    
    // å¯¹è±¡å·²è§£å†³ç±»å‹
    if (condition.type === 'object_solved') {
        return currentRoomState.solvedObjects.includes(condition.target);
    }
    
    // çº¿ç´¢ç±»å‹
    if (condition.type === 'clue') {
        return clues.includes(condition.target);
    }
    
    // æŠ€èƒ½ç±»å‹
    if (condition.type === 'skill') {
        var skillVal = getSkillValue(condition.skill);
        return skillVal >= (condition.min || 0);
    }
    
    // é»˜è®¤å­—ç¬¦ä¸²ç±»å‹ï¼ˆå‘åå…¼å®¹ï¼‰
    if (typeof condition === 'string') {
        return currentRoomState.solvedObjects.includes(condition);
    }
    
    return false;
}

// v0.3 æ–°å¢ï¼šæ£€æŸ¥å¹¶è§£é”å‡ºå£
function checkAndUnlockExits() {
    var room = rooms[currentRoomIdx];
    if (!room || !room.objects) return;
    
    // æ£€æŸ¥æ‰€æœ‰å‡ºå£å¯¹è±¡
    var allConditionsMet = true;
    
    room.objects.forEach(function(objId) {
        var obj = objectTemplates[objId];
        if (!obj || obj.type !== 'exit' || !obj.unlockConditions) return;
        
        // æ£€æŸ¥è¯¥å‡ºå£çš„æ‰€æœ‰è§£é”æ¡ä»¶
        var conditionsMet = obj.unlockConditions.every(function(condition) {
            return checkExitUnlockCondition(condition);
        });
        
        if (conditionsMet) {
            // æ ‡è®°è¯¥å‡ºå£å·²è§£é”ï¼ˆå­˜å‚¨åœ¨å¯¹è±¡ä¸Šï¼‰
            obj.unlocked = true;
        }
    });
    
    // æ›´æ–°å…¨å±€è§£é”çŠ¶æ€ï¼ˆç”¨äºæ˜¾ç¤ºå‡ºå£åŒºåŸŸï¼‰
    currentRoomState.unlockedExits = room.objects.some(function(objId) {
        var obj = objectTemplates[objId];
        return obj && obj.type === 'exit' && obj.unlocked;
    });
}

// v0.3 æ–°å¢ï¼šåˆ·æ–°å¯¹è±¡åˆ—è¡¨æ˜¾ç¤º
function refreshObjectList() {
    var room = rooms[currentRoomIdx];
    if (!room || !room.objects) return;
    
    room.objects.forEach(function(objId) {
        var objEl = document.getElementById('obj_' + objId);
        if (!objEl) return;
        
        var obj = objectTemplates[objId];
        if (!obj) return;
        
        var isSolved = currentRoomState.solvedObjects.includes(objId);
        
        // æ£€æŸ¥å‡ºå£æ˜¯å¦å·²è§£é”
        var isUnlockedExit = false;
        if (obj.type === 'exit' && obj.unlockConditions) {
            isUnlockedExit = obj.unlockConditions.every(function(condition) {
                return checkExitUnlockCondition(condition);
            });
        }
        
        // æ›´æ–°è§£å†³çŠ¶æ€æ ‡è®°
        var nameEl = objEl.querySelector('.object-name');
        if (nameEl && isSolved) {
            if (!nameEl.textContent.includes('âœ“')) {
                nameEl.textContent += ' âœ“';
            }
            objEl.classList.add('solved');
        }
        
        // æ›´æ–°å‡ºå£é”å®šæ ‡è®°
        if (obj.type === 'exit' && obj.unlockConditions) {
            // ç§»é™¤æ—§çš„é”å®šæ ‡è®°
            var oldLock = objEl.querySelector('.lock-indicator');
            if (oldLock) oldLock.remove();
            
            // å¦‚æœæ²¡æœ‰è§£é”ï¼Œæ·»åŠ é”å®šæ ‡è®°
            if (!isUnlockedExit) {
                var lockSpan = document.createElement('span');
                lockSpan.className = 'lock-indicator';
                lockSpan.style.cssText = 'font-size:10px;color:#e94560;margin-left:5px;';
                lockSpan.textContent = 'ğŸ”’';
                objEl.appendChild(lockSpan);
            } else {
                // å·²è§£é”ï¼Œæ·»åŠ è§£é”æ ‡è®°
                var unlockSpan = document.createElement('span');
                unlockSpan.className = 'unlock-indicator';
                unlockSpan.style.cssText = 'font-size:10px;color:#27ae60;margin-left:5px;';
                unlockSpan.textContent = 'âœ“';
                objEl.appendChild(unlockSpan);
            }
        }
    });
}

// è·å–åˆ¤å®šç»“æœæ–‡æœ¬
function getRollResultText(type) {
    var texts = {
        'fumble': 'ğŸ’€ å¤§å¤±è´¥ (â‰¤5)',
        'fail': 'âŒ å¤±è´¥',
        'success': 'âœ“ æˆåŠŸ',
        'crit': 'â­ å¤§æˆåŠŸ (â‰¥96)'
    };
    return texts[type] || type;
}
</script>
</body>
</html>