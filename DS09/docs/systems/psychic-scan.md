# 精神扫描系统

> 集中精神，窥视真相——但真相可能也在窥视你。

---

## 设计意图

### 解决什么问题？
- **纯随机探索太无力**：玩家需要一个"反制手段"
- **风险需要可控**：需要一种方式降低不确定性
- **资源管理深度**：让玩家在"安全但消耗"和"冒险但节省"之间抉择

### 创造什么体验？
- **掌控感**：在混乱中，你有能力"看穿"一个格子
- **稀缺性**：精神力有限，必须用在关键时刻
- **代价意识**：每次扫描都是资源消耗，不能随便乱用

### 支撑什么情感？
- **调查员的能力**：你不是普通人，你有特殊感知
- **克苏鲁式的代价**：使用能力是有代价的（精神力消耗）
- **紧张决策**："这个格子值得我扫描吗？"

---

## 核心规则

### 精神力资源

```javascript
// 初始值
markers = 3; // 每层重置

// 上限（考虑中）
maxMarkers = 5; // 是否有上限？
```

### 使用方式

**操作：** 右键点击未揭示的格子

**消耗：** 1点精神力

**效果：**
- 安全揭示该格子
- 根据格子类型，不同结果

### 扫描结果

| 格子类型 | 结果 | 精神力 | 额外效果 |
|---------|------|--------|---------|
| 陷阱💀 | 规避 | 返还（不消耗） | 理智+5 |
| 剧情房📜 | 触发 | 消耗 | 剧情判定成功率+20% |
| 空地⬜ | 仅揭示 | 消耗 | 无 |

**为什么陷阱返还？**
- 创造"猜对了"的正反馈
- 鼓励玩家推理后使用扫描（而不是乱扫）
- 符合"安全扫描"的设定

**实现状态：** ✅ 已实现基础功能
**当前缺口（未实现）：**
- 剧情房扫描的+20%成功率显性化反馈 ❌
- 深度扫描（消耗更多精神力获得更多信息）❌
- 幻觉时扫描结果可能错误 ❌

---

## 精神力获取

### 当前方式

| 方式 | 数量 | 限制 |
|-----|------|------|
| 每层初始 | 3点 | 每层重置 |
| 灵能水晶道具 | +2点 | 消耗品 |
| （待添加）其他？ | - | - |

**缺口：**
- 获取方式单一，是否应该有更多途径？
- 某些剧情选择奖励精神力？
- 超额探索奖励精神力？

### 考虑的扩展

1. **剧情奖励**：某些剧情成功后奖励精神力
2. **发现奖励**：发现隐藏剧情房奖励精神力
3. **牺牲换取**：用理智换取精神力？
4. **保留到下一层**：当前精神力是否保留到下一层？

---

## 扫描动画与反馈

### 当前实现

**动画：**
- 格子闪烁紫色光芒（0.4秒）
- 扫描线划过效果

**结果弹窗：**
- 陷阱规避："精神扫描成功！你的精神力感知到了陷阱！"
- 剧情房："感知到剧情房！"
- 空地："精神扫描完成，这里没有异常"

### 期望增强（缺口）

#### 🔴 扫描的深度
**问题：** 目前扫描只是"揭示"，没有深度

**可能扩展：**
- **深度扫描**（消耗2点精神力）：不仅揭示，还显示周围8格的信息？
- **扫描陷阱**：显示该陷阱周围还有多少个陷阱？
- **扫描剧情**：预告该剧情房的类型（主线/支线）？

#### 🟡 扫描的风险
**问题：** 目前扫描是安全的

**可能扩展：**
- **扫描反噬**：极低概率扫描时受到精神冲击（理智-5）
- **幻觉干扰**：幻觉模式下，扫描结果可能错误
- **被注视**：扫描某些格子时，感觉有东西在回看你...

#### 🟢 扫描的组合
**探索性：**
- **连续扫描**：连续扫描相邻格子是否有加成？
- **扫描组合**：某些格子组合扫描触发隐藏效果？

---

## 精神扫描 vs 其他获取信息方式

| 方式 | 消耗 | 风险 | 信息量 | 可控性 |
|-----|------|------|--------|--------|
| 直接点击 | 无 | 高（可能踩陷阱） | 完整 | 低 |
| 精神扫描 | 精神力 | 低（安全揭示） | 完整 | 高 |
| 探测器 | 道具 | 中（随机揭示） | 完整 | 中 |
| 推理 | 无 | 中（可能猜错） | 部分（底色+👁️） | 中 |

**设计意图：**
- 直接点击 = 高风险高回报（免费但可能受伤）
- 精神扫描 = 低风险可控（消耗资源换取安全）
- 形成互补，让玩家有选择

---

## 关键数值

### 当前数值

| 参数 | 当前值 | 考虑调整 |
|-----|--------|---------|
| 每层初始精神力 | 3 | 是否需要根据层数调整？ |
| 陷阱规避奖励 | 理智+5 | 是否需要更多奖励？ |
| 剧情房加成 | 成功率+20% | 玩家是否感知得到？ |
| 动画时长 | 0.4秒 | 是否需要更长，更有仪式感？ |

### 平衡性问题

**当前观察：**
- 3点精神力在6×6地图中感觉刚好
- 但在14×14的大地图中可能不够用

**可能方案：**
- 地图大小与精神力数量挂钩？
- 或者固定精神力，但深层地图有更多获取途径？

---

## 与其他系统的关联

### × 理智系统
- 幻觉模式下，扫描结果可能错误（信息不再完全可信）
- 是否可以主动消耗理智换取精神力？

### × 威胁感知系统
- 扫描绕过威胁感知，直接知道真相
- 但👁️提示可以帮助玩家决定"哪个格子值得扫描"

### × 探测器
- 探测器是"随机揭示"，扫描是"主动选择"
- 形成互补：探测器碰运气，扫描用于关键决策

### × 叙事系统
- 扫描过程可以有叙事描述（"你集中精神，感知到了..."）
- 扫描某些特殊格子触发隐藏剧情？

---

## 迭代记录

| 日期 | 改动 | 原因 | 验证结果 | 关联决策 |
|------|------|------|----------|----------|
| 2026-02-13 | 标记器重命名为精神扫描 | 更符合克苏鲁氛围 | ✅ 有效，包装感更强 | 核心概念升级 |
| 2026-02-14 | 添加扫描动画和结果弹窗 | 增强反馈感 | ✅ 有效，玩家明确知道结果 | 体验优化 |

---

## 待办清单

### 🔴 高优先级
1. **扫描深度扩展**：深度扫描（消耗更多，获得更多信息）
2. **幻觉干扰**：幻觉模式下扫描结果可能错误
3. **扫描叙事**：扫描过程加入叙事描述，增强沉浸感

### 🟡 中优先级
4. **精神力获取多样化**：剧情奖励、发现奖励等
5. **扫描组合效果**：连续扫描、特殊格子组合
6. **扫描风险**：极低概率的反噬效果

### 🟢 低优先级
7. **扫描升级**：是否可以升级扫描能力？
8. **扫描记录**：记录玩家扫描偏好，用于动态调整？

---

## 设计原则总结

1. **可控的未知**：扫描让玩家有能力降低不确定性，但资源有限
2. **推理的奖励**：扫描陷阱返还，鼓励玩家先推理再扫描
3. **稀缺性管理**：精神力有限，必须用在关键时刻
4. **克苏鲁氛围**：扫描不是科技，是精神能力，有代价和限制

---

*最后更新：2026-02-14*  
*状态：核心机制完成，深度扫描和幻觉干扰待完善*