# DS11 开发准备文档 v1.0

**版本**: v1.0  
**日期**: 2026-02-21  
**状态**: 开发前最终确认

---

## 一、核心方案汇总

### 1.1 游戏定位
**起于扫雷的Roguelike原型**  
核心体验：在迷雾生长的网格中，管理火把资源，权衡风险与贪婪，在畸变前收集核心并撤退

### 1.2 双系统架构

```
【派遣系统】（形式层）
- 玩家点击迷雾格，派遣调查员揭示
- MVP：立即获得结果（无等待）
- 后续迭代：可加入等待和背叛机制

【火把系统】（成本层）
- 资源管理：初始5火把，上限10
- 与派遣耦合：不同格类型消耗不同火把
- 获取途径：安全格随机获得、F3意外获得
```

### 1.3 F3+F4生态系统（方案B确认）

**F3：强制揭示 + 污染扩散（代价）**
```
触发：派遣踩中雷格
效果：
1. 强制揭示周围3格
2. 获得1印记
3. 这3格被"污染"（随机1种效果）：
   - 数字模糊（±1误差，持续3回合）
   - 移动成本+1火把
   - 不能停留超过1回合
4. 可能意外获得火把（30%概率）

代价：获得信息，但信息质量下降/路径难走
```

**F4：印记累积 + 畸变选择**
```
累积：3个印记触发畸变
选择：3种畸变方向（正向/负向/彩蛋）
效果：改变角色玩法风格
后续：畸变是永久的，带入下局
```

---

## 二、格子类型设计（最终版）

### 2.1 格子类型表

| 类型 | 揭示前外观 | 揭示后外观 | 派遣消耗 | 特殊效果 |
|------|-----------|-----------|---------|---------|
| **迷雾格** | 灰色迷雾 | - | 不可直接踩 | 必须先派遣揭示 |
| **安全格** | - | 显示数字 | 2火把 | 30%概率有火把堆(+1~3) |
| **深渊裂隙** | 迷雾中微光 | 发光裂缝 | 5火把 | 打开3个新方向，唯一生长方式 |
| **雷格** | 与普通迷雾相同 | 💀+污染标记 | 2火把(踩中) | 触发F3，周围3格被污染 |

### 2.2 关键机制详解

**深渊裂隙（核心生长点）**
```
出现：每5个普通格后必出1个
效果：揭示后向3个方向同时打开新路径
消耗：5火把（昂贵）
枯萎：未选择的其他方向8回合后消失（可延缓）
策略：高成本但高回报，是深入的唯一途径
```

**污染格（F3后果）**
```
触发：雷格F3强制揭示的3格
效果（随机1种）：
- 模糊：数字显示±1误差，持续3回合
- 沉重：经过需额外+1火把
- 不稳定：不能停留，必须立即离开
视觉：格边缘有紫色光晕，表示被污染
策略：获得信息但有副作用，需要权衡使用
```

---

## 三、核心体验时刻

### 时刻1：面对深渊裂隙的贪婪抉择
```
情境：剩5火把，面前是深渊裂隙(5火把)和普通迷雾(2火把)
决策：
A. 花5火把揭示裂隙 → 可能打开捷径，但火把耗尽风险
B. 花2火把揭示普通格 → 保守，但可能错过深层资源
C. 不行动等待 → 其他分支在枯萎，时间在流逝

体验：高成本 vs 高回报的张力，贪婪与保守的博弈
```

### 时刻2：踩雷触发F3的代价-收益
```
情境：踩中雷格，触发F3
结果：
- 强制揭示周围3格（获得信息）
- 其中1格有火把堆(+2火把)
- 但这3格被污染（移动+1火把成本）
- 获得1印记（接近畸变）

决策：
A. 去拿火把 → 但污染格难走，可能触发更多连锁
B. 放弃火把撤退 → 安全但浪费资源
C. 先观察其他路径 → 但火把在消耗，时间在流逝

体验：F3不是纯奖励，是"带毒的礼物"，需要谨慎处理
```

### 时刻3：印记累积的畸变抉择
```
情境：已获得2印记，再踩1雷就触发畸变
决策：
A. 避免再踩雷，保守探索 → 安全但可能错过能力
B. 主动踩雷触发畸变 → 获得能力，但可能是负面的
C. 利用当前状态，快速完成任务 → 在畸变前撤退

畸变选项示例：
- 深渊之眼：可以看穿迷雾（强力）
- 沉重步伐：移动消耗+1火把（负面）
- 低语理解：听到格子的提示（彩蛋）

体验：畸变是不可逆的转化，改变后续玩法
```

### 时刻4：火把耗尽的绝境
```
情境：剩1火把，离出口还有3格
决策：
A. 用最后1火把揭示前方格，赌它是安全/出口
B. 放弃撤退，结束游戏（损失部分资源）
C. 寻找附近是否有火把堆（但可能没有）

体验：资源绝境下的最后赌博，每个决定都关乎生死
```

### 时刻5：成功撤退的遗憾与满足
```
情境：成功撤退，带回核心
但：
- 有2个分支枯萎了，永远不知道里面有什么
- 调查员有2印记，下次进来就是畸变状态
- 如果多1火把，可能可以探索更多

体验：成功的满足感 + 未探索的遗憾 = "再来一局"的动力
```

---

## 四、数值框架（初始设定）

### 4.1 资源数值
```
火把：
- 初始：5
- 上限：10
- 获取：安全格30%概率有火把堆（+1~3）
- F3意外：30%概率获得火把（+1~2）

印记：
- 上限：3（满触发畸变）
- 获取：踩雷+1
- 效果：累积影响后续游戏
```

### 4.2 派遣消耗
```
迷雾格（未揭示）：
- 普通安全格：2火把
- 深渊裂隙：5火把
- 雷格：2火把（踩中触发F3）

已揭示格：
- 经过安全格：0火把
- 经过污染格：+1火把（污染效果）
```

### 4.3 网格生成
```
初始：中心格已揭示，周围8格迷雾
生长：
- 每揭示1格，其相邻迷雾成为新边缘
- 每5个普通格后必出1个深渊裂隙
- 最大15格（第15格必为出口）

分支枯萎：
- 深渊裂隙打开3个方向
- 未选择的方向8回合后枯萎
- 可花1火把延缓1回合（递增成本）
```

### 4.4 F3污染效果（随机1种）
```
模糊污染（40%概率）：
- 该格数字显示±1误差
- 持续3回合后恢复

沉重污染（40%概率）：
- 经过该格额外+1火把
- 永久（本局内）

不稳定污染（20%概率）：
- 不能在该格停留超过1回合
- 必须立即移动到相邻格
- 永久（本局内）
```

### 4.5 畸变选项（3选1）
```
正向示例：
- 深渊之眼：可以看穿1格迷雾（每回合限1次）
- 资源嗅觉：发现火把堆概率+20%

负向示例：
- 沉重步伐：所有移动+1火把
- 强迫症：必须揭示完所有格才能撤退

彩蛋示例：
- 低语理解：偶尔听到格子的提示（"左边有危险"）
- 时间感知：知道距离分支枯萎还剩多少回合
```

---

## 五、MVP开发计划

### 5.1 开发阶段（5天）

**Day 1: 迷雾生长网格**
```
✅ 3×3初始网格渲染
✅ 揭示机制（点击派遣）
✅ 生长算法（新边缘生成）
✅ 深渊裂隙生成（每5格保底）
```

**Day 2: 火把系统**
```
✅ 火把UI显示
✅ 派遣消耗火把
✅ 不同格类型不同消耗
✅ 火把获取（安全格随机）
```

**Day 3: F3+F4系统**
```
✅ 踩雷检测
✅ F3强制揭示周围3格
✅ 污染效果应用（3种）
✅ 印记累积
✅ 畸变选择界面
```

**Day 4: 游戏循环**
```
✅ 核心隐藏（随机位置）
✅ 出口生成（第15格）
✅ 分支枯萎倒计时
✅ 撤退结算
```

**Day 5: 调优测试**
```
✅ 火把获取率平衡
✅ 难度曲线调整
✅ Bug修复
✅ 核心体验验证
```

### 5.2 验证标准

**核心问题**：玩家是否会主动踩雷触发F3？
```
成功标准：
- >30%玩家有主动踩雷行为
- 单局时长集中在3-5分钟
- 玩家愿意玩3局以上
- 玩家讨论"刚才我应该选另一条路"
```

---

## 六、技术实现要点

### 6.1 数据结构
```javascript
// 格子数据结构
Cell: {
  id: string,
  x: number,
  y: number,
  type: 'fog' | 'safe' | 'rift' | 'mine',
  revealed: boolean,
  number: number, // 周围雷数
  polluted: boolean,
  pollutionType: 'blur' | 'heavy' | 'unstable' | null,
  hasTorch: boolean,
  torchAmount: number
}

// 游戏状态
GameState: {
  torch: number,      // 当前火把
  maxTorch: number,   // 火把上限
  marks: number,      // 印记数
  mutation: string,   // 当前畸变
  cells: Cell[],      // 所有格子
  revealedCount: number,  // 已揭示数
  exitAvailable: boolean  // 出口是否可用
}
```

### 6.2 关键算法
```javascript
// 生长算法
function growGrid(selectedCell) {
  // 1. 将选中格从fog变为具体类型
  // 2. 其相邻fog格成为新edge
  // 3. 检查是否需要生成深渊裂隙（每5格）
  // 4. 返回新edge列表
}

// F3触发
function triggerF3(mineCell) {
  // 1. 获取周围3格
  // 2. 强制揭示这3格
  // 3. 随机应用污染效果
  // 4. 检查是否有火把堆（30%概率）
  // 5. 玩家印记+1
  // 6. 如果印记=3，触发畸变选择
}
```

---

## 七、后续迭代规划

### V1.1（MVP后2周）
```
- 派遣等待时间（1-2回合）
- 派遣背叛机制（高印记时信息可能错误）
- 迷雾流动（边缘格可能移位）
```

### V1.2（MVP后1月）
```
- 多角色切换（3种角色类型）
- 角色差异（不同印记经济学）
- 局外Meta（解锁新角色、新畸变）
```

### V1.3（MVP后2月）
```
- 不同网格类型（冰原、火山、虚空）
- Boss战（在深层遭遇深渊生物）
- 剧情模式（多局连成故事）
```

---

## 八、Rhy最终确认清单

### 核心机制
- [ ] F3污染效果（3种）认可
- [ ] 深渊裂隙5火把成本认可
- [ ] 分支枯萎8回合+可延缓认可

### 数值框架
- [ ] 火把初始5/上限10认可
- [ ] 印记上限3触发畸变认可
- [ ] 污染效果概率（模糊40/沉重40/不稳定20）认可

### 开发计划
- [ ] 5天MVP计划认可
- [ ] Day1-5任务分配认可

### 启动开发
- [ ] 确认无误，立即开始Day1
- [ ] 或需要最后调整

---

**等待Rhy最终确认！** 🚀